\doxysection{Magix\+Network\+Manager.\+h}
\hypertarget{_magix_network_manager_8h_source}{}\label{_magix_network_manager_8h_source}\index{D:/CurrGamesProjects/ImpressiveTitleRemakePOCData/Kito\_CopyrightFree/src/client/include/MagixNetworkManager.h@{D:/CurrGamesProjects/ImpressiveTitleRemakePOCData/Kito\_CopyrightFree/src/client/include/MagixNetworkManager.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#ifndef\ \_\_MagixNetworkManager\_h\_}}
\DoxyCodeLine{00002\ \textcolor{preprocessor}{\#define\ \_\_MagixNetworkManager\_h\_}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00004\ \textcolor{keyword}{enum}\ NETWORKMESSAGE}
\DoxyCodeLine{00005\ \{}
\DoxyCodeLine{00006\ \ \ \ \ NETWORK\_NOTHING,}
\DoxyCodeLine{00007\ \ \ \ \ NETWORK\_CONNECTED,}
\DoxyCodeLine{00008\ \ \ \ \ NETWORK\_CONNECTIONFAILED,}
\DoxyCodeLine{00009\ \ \ \ \ NETWORK\_LOSTCONNECTION,}
\DoxyCodeLine{00010\ \ \ \ \ NETWORK\_LOGONSUCCESS,}
\DoxyCodeLine{00011\ \ \ \ \ NETWORK\_LOGONFAIL,}
\DoxyCodeLine{00012\ \ \ \ \ NETWORK\_CREATEACCOUNTSUCCESS,}
\DoxyCodeLine{00013\ \ \ \ \ NETWORK\_CREATEACCOUNTFAIL,}
\DoxyCodeLine{00014\ \ \ \ \ NETWORK\_EDITACCOUNTSUCCESS,}
\DoxyCodeLine{00015\ \ \ \ \ NETWORK\_EDITACCOUNTFAIL,}
\DoxyCodeLine{00016\ \ \ \ \ NETWORK\_LOADCHARSUCCESS,}
\DoxyCodeLine{00017\ \ \ \ \ NETWORK\_LOADCHARFAIL,}
\DoxyCodeLine{00018\ \ \ \ \ NETWORK\_CREATECHARSUCCESS,}
\DoxyCodeLine{00019\ \ \ \ \ NETWORK\_CREATECHARFAIL,}
\DoxyCodeLine{00020\ \ \ \ \ NETWORK\_EDITCHARSUCCESS,}
\DoxyCodeLine{00021\ \ \ \ \ NETWORK\_EDITCHARFAIL,}
\DoxyCodeLine{00022\ \ \ \ \ NETWORK\_LOGONINUSE,}
\DoxyCodeLine{00023\ \ \ \ \ NETWORK\_PARTYREQUEST,}
\DoxyCodeLine{00024\ \ \ \ \ NETWORK\_BLOCKNAME}
\DoxyCodeLine{00025\ \};}
\DoxyCodeLine{00026\ \textcolor{keyword}{struct\ }NetworkMessage}
\DoxyCodeLine{00027\ \{}
\DoxyCodeLine{00028\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ message;}
\DoxyCodeLine{00029\ \ \ \ \ String\ param;}
\DoxyCodeLine{00030\ \ \ \ \ NetworkMessage(\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ \&m=NETWORK\_NOTHING,\ \textcolor{keyword}{const}\ String\ \&p=\textcolor{stringliteral}{"{}"{}})}
\DoxyCodeLine{00031\ \ \ \ \ \{}
\DoxyCodeLine{00032\ \ \ \ \ \ \ \ \ message\ =\ m;}
\DoxyCodeLine{00033\ \ \ \ \ \ \ \ \ param\ =\ p;}
\DoxyCodeLine{00034\ \ \ \ \ \}}
\DoxyCodeLine{00035\ \};}
\DoxyCodeLine{00036\ }
\DoxyCodeLine{00037\ \textcolor{preprocessor}{\#include\ "{}RakNetworkFactory.h"{}}}
\DoxyCodeLine{00038\ \textcolor{preprocessor}{\#include\ "{}RakPeerInterface.h"{}}}
\DoxyCodeLine{00039\ \textcolor{preprocessor}{\#include\ "{}MessageIdentifiers.h"{}}}
\DoxyCodeLine{00040\ \textcolor{preprocessor}{\#include\ "{}BitStream.h"{}}}
\DoxyCodeLine{00041\ \textcolor{preprocessor}{\#include\ "{}StringCompressor.h"{}}}
\DoxyCodeLine{00042\ \textcolor{preprocessor}{\#include\ "{}GameConfig.h"{}}}
\DoxyCodeLine{00043\ \textcolor{preprocessor}{\#include\ "{}MagixNetworkDefines.h"{}}}
\DoxyCodeLine{00044\ \textcolor{preprocessor}{\#include\ "{}MagixChatManager.h"{}}}
\DoxyCodeLine{00045\ \textcolor{preprocessor}{\#include\ "{}MagixAlertBox.h"{}}}
\DoxyCodeLine{00046\ \textcolor{preprocessor}{\#include\ "{}MagixCharScreenManager.h"{}}}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \textcolor{keyword}{struct\ }PlayerData}
\DoxyCodeLine{00049\ \{}
\DoxyCodeLine{00050\ \ \ \ \ String\ name;}
\DoxyCodeLine{00051\ \ \ \ \ String\ mapName;}
\DoxyCodeLine{00052\ }
\DoxyCodeLine{00053\ \ \ \ \ PlayerData(\textcolor{keyword}{const}\ String\ \&n=\textcolor{stringliteral}{"{}"{}},\ \textcolor{keyword}{const}\ String\ \&m=\textcolor{stringliteral}{"{}"{}})}
\DoxyCodeLine{00054\ \ \ \ \ \{}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ name\ =\ n;}
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ mapName\ =\ m;}
\DoxyCodeLine{00057\ \ \ \ \ \}}
\DoxyCodeLine{00058\ \};}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00060\ \textcolor{keyword}{struct\ }PositionInfo}
\DoxyCodeLine{00061\ \{}
\DoxyCodeLine{00062\ \ \ \ \ Vector3\ position;}
\DoxyCodeLine{00063\ \ \ \ \ \textcolor{keywordtype}{bool}\ hasOwnGroundHeight;}
\DoxyCodeLine{00064\ \ \ \ \ Real\ groundHeight;}
\DoxyCodeLine{00065\ \ \ \ \ PositionInfo(\textcolor{keyword}{const}\ Vector3\ \&p,\textcolor{keywordtype}{bool}\ hOGH=\textcolor{keyword}{false},\textcolor{keyword}{const}\ Real\ \&gH=0)}
\DoxyCodeLine{00066\ \ \ \ \ \{}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ position\ =\ p;}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ hasOwnGroundHeight\ =\ hOGH;}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ groundHeight\ =\ gH;}
\DoxyCodeLine{00070\ \ \ \ \ \}}
\DoxyCodeLine{00071\ \};}
\DoxyCodeLine{00072\ }
\DoxyCodeLine{00073\ \textcolor{keyword}{class\ }MagixNetworkManager}
\DoxyCodeLine{00074\ \{}
\DoxyCodeLine{00075\ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00076\ \ \ \ \ \mbox{\hyperlink{class_magix_external_definitions}{MagixExternalDefinitions}}\ *mDef;}
\DoxyCodeLine{00077\ \ \ \ \ \mbox{\hyperlink{class_magix_game_state_manager}{MagixGameStateManager}}\ *mGameStateManager;}
\DoxyCodeLine{00078\ \ \ \ \ \mbox{\hyperlink{class_magix_item_manager}{MagixItemManager}}\ *mItemManager;}
\DoxyCodeLine{00079\ \ \ \ \ \mbox{\hyperlink{class_magix_critter_manager}{MagixCritterManager}}\ *mCritterManager;}
\DoxyCodeLine{00080\ \ \ \ \ \mbox{\hyperlink{class_magix_unit_manager}{MagixUnitManager}}\ *mUnitManager;}
\DoxyCodeLine{00081\ \ \ \ \ \mbox{\hyperlink{class_magix_world}{MagixWorld}}\ *mWorld;}
\DoxyCodeLine{00082\ \ \ \ \ \mbox{\hyperlink{class_magix_sky_manager}{MagixSkyManager}}\ *mSkyManager;}
\DoxyCodeLine{00083\ \ \ \ \ \mbox{\hyperlink{class_magix_chat_manager}{MagixChatManager}}\ *mChatManager;}
\DoxyCodeLine{00084\ \ \ \ \ \mbox{\hyperlink{class_magix_alert_box}{MagixAlertBox}}\ *mAlertBox;}
\DoxyCodeLine{00085\ \ \ \ \ \mbox{\hyperlink{class_magix_char_screen_manager}{MagixCharScreenManager}}\ *mCharScreenManager;}
\DoxyCodeLine{00086\ \ \ \ \ RakPeerInterface\ *mPeer;}
\DoxyCodeLine{00087\ \ \ \ \ \textcolor{keywordtype}{bool}\ acceptedFlag;}
\DoxyCodeLine{00088\ \ \ \ \ Real\ updateCount;}
\DoxyCodeLine{00089\ \ \ \ \ Real\ moveUpdateCount;}
\DoxyCodeLine{00090\ \ \ \ \ vector<PlayerData>::type\ playerList;}
\DoxyCodeLine{00091\ \ \ \ \ \textcolor{keywordtype}{bool}\ playerListUpdated;}
\DoxyCodeLine{00092\ \ \ \ \ String\ targetBioUpdated;}
\DoxyCodeLine{00093\ \ \ \ \ \mbox{\hyperlink{struct_network_message}{NetworkMessage}}\ networkMessage;}
\DoxyCodeLine{00094\ \ \ \ \ \textcolor{keywordtype}{bool}\ isMainServerConnection;}
\DoxyCodeLine{00095\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ countsIntoGame;}
\DoxyCodeLine{00096\ \ \ \ \ vector<std::pair<unsigned\ char,SystemAddress>>::type\ serverAdd;}
\DoxyCodeLine{00097\ \ \ \ \ \textcolor{keywordtype}{bool}\ sentPlayerUpdate;}
\DoxyCodeLine{00098\ \ \ \ \ vector<std::pair<OwnerToken,PositionInfo>>::type\ playerPositionQueue;}
\DoxyCodeLine{00099\ \ \ \ \ std::pair<Vector3,Real>\ lastMovePosition;}
\DoxyCodeLine{00100\ \ \ \ \ Degree\ lastFaceDirection;}
\DoxyCodeLine{00101\ \ \ \ \ std::pair<bool,Quaternion>\ lastLookQuaternion;}
\DoxyCodeLine{00102\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ lastFlags;}
\DoxyCodeLine{00103\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ lastPrimaryFlags;}
\DoxyCodeLine{00104\ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ lastSecondaryFlags;}
\DoxyCodeLine{00105\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00106\ \ \ \ \ MagixNetworkManager()}
\DoxyCodeLine{00107\ \ \ \ \ \{}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ mDef\ =\ 0;}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ mGameStateManager\ =\ 0;}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ mItemManager\ =\ 0;}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ mCritterManager\ =\ 0;}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ mUnitManager\ =\ 0;}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ mWorld\ =\ 0;}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ mSkyManager\ =\ 0;}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ mChatManager\ =\ 0;}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ mAlertBox\ =\ 0;}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ mCharScreenManager\ =\ 0;}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ mPeer\ =\ 0;}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ acceptedFlag\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ updateCount\ =\ 0;}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ moveUpdateCount\ =\ 0;}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ playerList.clear();}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ playerListUpdated\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ targetBioUpdated\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ networkMessage\ =\ \mbox{\hyperlink{struct_network_message}{NetworkMessage}}();}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ isMainServerConnection\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ countsIntoGame\ =\ 0;}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ serverAdd.clear();}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ sentPlayerUpdate\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ playerPositionQueue.clear();}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ lastMovePosition\ =\ std::pair<Vector3,Real>(Vector3::ZERO,0);}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ lastFaceDirection\ =\ Degree(0);}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ lastLookQuaternion\ =\ std::pair<bool,Quaternion>(\textcolor{keyword}{false},Quaternion::IDENTITY);}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ lastFlags\ =\ 0;}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ lastPrimaryFlags\ =\ 0;}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ lastSecondaryFlags\ =\ 0;}
\DoxyCodeLine{00137\ \ \ \ \ \}}
\DoxyCodeLine{00138\ \ \ \ \ \string~MagixNetworkManager()}
\DoxyCodeLine{00139\ \ \ \ \ \{}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(mPeer)}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(mPeer-\/>IsActive())}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ disconnect();}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00146\ }
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \ \ \ \ RakNetworkFactory::DestroyRakPeerInterface(mPeer);}
\DoxyCodeLine{00148\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00149\ \ \ \ \ \}}
\DoxyCodeLine{00150\ }
\DoxyCodeLine{00151\ \ \ \ \ \textcolor{comment}{//\ are\ we\ following\ an\ initialize\ function\ template\ ?\ how\ are\ we\ called\ and\ from\ where\ ?\ we\ might\ want\ to\ not\ init\ ?}}
\DoxyCodeLine{00152\ \ \ \ \ \textcolor{keywordtype}{void}\ initialize(\mbox{\hyperlink{class_magix_external_definitions}{MagixExternalDefinitions}}\ *def,\ \mbox{\hyperlink{class_magix_game_state_manager}{MagixGameStateManager}}\ *gamestateMgr,\ \mbox{\hyperlink{class_magix_item_manager}{MagixItemManager}}\ *itemMgr,\ \mbox{\hyperlink{class_magix_critter_manager}{MagixCritterManager}}\ *critterMgr,\ \mbox{\hyperlink{class_magix_unit_manager}{MagixUnitManager}}\ *unitMgr,\ \mbox{\hyperlink{class_magix_world}{MagixWorld}}\ *world,\ \mbox{\hyperlink{class_magix_sky_manager}{MagixSkyManager}}\ *skyMgr,\ \mbox{\hyperlink{class_magix_chat_manager}{MagixChatManager}}\ *chatMgr,\ \mbox{\hyperlink{class_magix_alert_box}{MagixAlertBox}}\ *alertBox,\ \mbox{\hyperlink{class_magix_char_screen_manager}{MagixCharScreenManager}}\ *charscreenMgr)}
\DoxyCodeLine{00153\ \ \ \ \ \{}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ mDef\ =\ def;}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ mGameStateManager\ =\ gamestateMgr;}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ mItemManager\ =\ itemMgr;}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ mCritterManager\ =\ critterMgr;}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ mUnitManager\ =\ unitMgr;}
\DoxyCodeLine{00159\ \ \ \ \ \ \ \ \ mWorld\ =\ world;}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ mSkyManager\ =\ skyMgr;}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ mChatManager\ =\ chatMgr;}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ mAlertBox\ =\ alertBox;}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ mCharScreenManager\ =\ charscreenMgr;}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ mPeer\ =\ RakNetworkFactory::GetRakPeerInterface();}
\DoxyCodeLine{00165\ \ \ \ \ \}}
\DoxyCodeLine{00166\ \ \ \ \ \textcolor{keywordtype}{bool}\ connect()}
\DoxyCodeLine{00167\ \ \ \ \ \{}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(serverAdd.size()==0)}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ \ \ \ \ mAlertBox-\/>showAlert(\textcolor{stringliteral}{"{}No\ servers\ to\ connect\ to\ :U"{}},0.5,0.5,10);}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ \ \ \ \ mGameStateManager-\/>setGameState(GAMESTATE\_RETURNSTARTSCREEN);}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \ \ \ \ disconnect();}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ mPeer-\/>Startup(1,30,\&SocketDescriptor(),\ 1);}
\DoxyCodeLine{00177\ }
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ String\ tLocalIP\ =\ mDef-\/>loadLocalIP(\textcolor{stringliteral}{"{}localIP.txt"{}});}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tLocalIP!=\textcolor{stringliteral}{"{}"{}})}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \ \ \ \ mPeer-\/>Connect(tLocalIP.c\_str(),\ SERVER\_PORT,\ SERVER\_PASSWORD,\ (\textcolor{keywordtype}{int})strlen(SERVER\_PASSWORD));}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \ \ \ \ mChatManager-\/>message(\textcolor{stringliteral}{"{}Connecting\ to\ Server\ "{}}+tLocalIP);}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ tServerID\ =\ Math::RangeRandom(0,(\textcolor{keywordtype}{int})serverAdd.size());}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tServerID>=(\textcolor{keywordtype}{int})serverAdd.size())tServerID\ =\ (int)serverAdd.size()-\/1;}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \ \ \ \ mPeer-\/>Connect(serverAdd[tServerID].second.ToString(\textcolor{keyword}{false}),\ serverAdd[tServerID].second.port,\ SERVER\_PASSWORD,\ (\textcolor{keywordtype}{int})strlen(SERVER\_PASSWORD));}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ \ \ \ \ mChatManager-\/>message(\textcolor{stringliteral}{"{}Connecting\ to\ Server\ "{}}+StringConverter::toString(serverAdd[tServerID].first+1));}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ mPeer-\/>SetUnreliableTimeout(30);}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ isMainServerConnection\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00194\ \ \ \ \ \}}
\DoxyCodeLine{00195\ \ \ \ \ \textcolor{keywordtype}{void}\ connectMainServer()}
\DoxyCodeLine{00196\ \ \ \ \ \{}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ tNumDays\ =\ 0;}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(mDef-\/>loadBanFile(tNumDays))}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \ \ \ \ \ \ String\ tMessage\ =\ \textcolor{stringliteral}{"{}You\ have\ been\ banned"{}};}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tNumDays>0)}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00203\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tMessage\ +=\ \textcolor{stringliteral}{"{}\ ("{}}\ +\ StringConverter::toString(tNumDays);}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tMessage\ +=\ tNumDays>1?\textcolor{stringliteral}{"{}\ days\ left)"{}}:\textcolor{stringliteral}{"{}\ day\ left)"{}};}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \ \ \ \ \ \ mAlertBox-\/>showAlert(tMessage,0.5,0.5,10);}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \ \ serverAdd.clear();}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ mPeer-\/>Startup(1,30,\&SocketDescriptor(),\ 1);}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ String\ tLocalIP\ =\ mDef-\/>loadLocalIP(\textcolor{stringliteral}{"{}localIP.txt"{}});}
\DoxyCodeLine{00212\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tLocalIP!=\textcolor{stringliteral}{"{}"{}})}
\DoxyCodeLine{00213\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \ \ \ \ \ \ mPeer-\/>Connect(tLocalIP.c\_str(),\ MAIN\_SERVER\_PORT,\ SERVER\_PASSWORD,\ (\textcolor{keywordtype}{int})strlen(SERVER\_PASSWORD));}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00216\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00218\ \ \ \ \ \ \ \ \ \ \ \ \ mPeer-\/>Connect(MAIN\_SERVER\_IP,\ MAIN\_SERVER\_PORT,\ SERVER\_PASSWORD,\ (\textcolor{keywordtype}{int})strlen(SERVER\_PASSWORD));}
\DoxyCodeLine{00219\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00220\ \ \ \ \ \ \ \ \ isMainServerConnection\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00221\ \ \ \ \ \}}
\DoxyCodeLine{00222\ \ \ \ \ \textcolor{keywordtype}{void}\ disconnect()}
\DoxyCodeLine{00223\ \ \ \ \ \{}
\DoxyCodeLine{00224\ \ \ \ \ \ \ \ \ mPeer-\/>Shutdown(300);}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \ \ isMainServerConnection\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00226\ \ \ \ \ \ \ \ \ acceptedFlag\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00227\ \ \ \ \ \ \ \ \ playerList.clear();}
\DoxyCodeLine{00228\ \ \ \ \ \ \ \ \ playerListUpdated\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00229\ \ \ \ \ \ \ \ \ sentPlayerUpdate\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \ \ reset();}
\DoxyCodeLine{00231\ \ \ \ \ \}}
\DoxyCodeLine{00232\ \ \ \ \ \textcolor{keywordtype}{void}\ reset()}
\DoxyCodeLine{00233\ \ \ \ \ \{}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ playerPositionQueue.clear();}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ lastMovePosition\ =\ std::pair<Vector3,Real>(Vector3::ZERO,0);}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ lastFaceDirection\ =\ Degree(0);}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ lastLookQuaternion\ =\ std::pair<bool,Quaternion>(\textcolor{keyword}{false},Quaternion::IDENTITY);}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ lastFlags\ =\ 0;}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ lastPrimaryFlags\ =\ 0;}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ lastSecondaryFlags\ =\ 0;}
\DoxyCodeLine{00241\ \ \ \ \ \}}
\DoxyCodeLine{00242\ \ \ \ \ \textcolor{keywordtype}{void}\ update(\textcolor{keyword}{const}\ FrameEvent\ evt)}
\DoxyCodeLine{00243\ \ \ \ \ \{}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(acceptedFlag)}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ \ \ \ \ updateCount\ -\/=\ evt.timeSinceLastFrame;}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \ \ \ \ \ \ moveUpdateCount\ -\/=\ evt.timeSinceLastFrame;}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(moveUpdateCount<=0)}
\DoxyCodeLine{00249\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ moveUpdateCount\ +=\ (mUnitManager-\/>getPlayer()-\/>getIsCrouching()\ ?\ (Real)0.75\ :\ (mUnitManager-\/>getPlayer()-\/>getIsWalking()\ ?\ (Real)0.5\ :\ (Real)0.25));}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sendMovePosition();}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sendFaceDirection();}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(updateCount<=0)}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ updateCount\ +=\ 1;}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sendLookQuaternion();}
\DoxyCodeLine{00258\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sendActionFlags();}
\DoxyCodeLine{00259\ }
\DoxyCodeLine{00260\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*if(countsIntoGame<5)countsIntoGame++;}}
\DoxyCodeLine{00261\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ if(countsIntoGame==5)}}
\DoxyCodeLine{00262\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}}
\DoxyCodeLine{00263\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ countsIntoGame\ =\ 31;}}
\DoxyCodeLine{00264\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ if(mGameStateManager-\/>getDimension()==0\ \&\&}}
\DoxyCodeLine{00265\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (mWorld-\/>getWorldName()=="{}Default"{}\ ||\ mWorld-\/>getWorldName()=="{}First\ Cave"{}\ ||\ mWorld-\/>getWorldName()=="{}Ice\ Cave"{}\ ||\ mWorld-\/>getWorldName()=="{}Lava\ Cave"{}\ ||\ mWorld-\/>getWorldName()=="{}Waterfall\ Cave"{})\&\&}}
\DoxyCodeLine{00266\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Math::RangeRandom(0,50)>0\ \&\&\ mItemManager-\/>getNumItems()<(unsigned\ short)playerList.size())}}
\DoxyCodeLine{00267\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}}
\DoxyCodeLine{00268\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ String\ tItems[]\ =\ \{"{}Egg"{},"{}Egg"{},"{}Egg"{},"{}Egg"{},"{}Egg2"{},"{}Egg2"{},"{}Egg2"{},"{}Egg2"{},"{}Egg3"{},"{}Egg3"{},"{}Egg3"{},"{}Egg3"{},"{}Egg4"{},"{}Egg5"{},"{}Egg4"{}\};}}
\DoxyCodeLine{00269\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ short\ tRand\ =\ (short)Math::RangeRandom(-\/1,15);}}
\DoxyCodeLine{00270\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ if(tRand<0)tRand\ =\ 0;}}
\DoxyCodeLine{00271\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ if(tRand>14)tRand\ =\ 14;}}
\DoxyCodeLine{00272\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ const\ Vector2\ tSize\ =\ mWorld-\/>getWorldSize();}}
\DoxyCodeLine{00273\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sendItemDrop(tItems[tRand],Math::RangeRandom(110,tSize.x-\/110),Math::RangeRandom(110,tSize.y-\/110));}}
\DoxyCodeLine{00274\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{00275\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}*/}}
\DoxyCodeLine{00276\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00277\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00278\ }
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \ Packet\ *packet\ =\ mPeer-\/>Receive();}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tCont\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00281\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}(packet\ \&\&\ tCont)}
\DoxyCodeLine{00282\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}\ (getPacketIdentifier(packet))}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_CONNECTION\_REQUEST\_ACCEPTED:}
\DoxyCodeLine{00286\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(isMainServerConnection)}
\DoxyCodeLine{00287\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ networkMessage\ =\ NETWORK\_CONNECTED;}
\DoxyCodeLine{00288\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mChatManager-\/>message(\textcolor{stringliteral}{"{}Connected."{}});}
\DoxyCodeLine{00291\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sendPlayerTokenRequest();}
\DoxyCodeLine{00292\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00293\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00294\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_TOKENCONNECTED:}
\DoxyCodeLine{00295\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ processPlayerToken(packet);}
\DoxyCodeLine{00296\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sendValidateName();}
\DoxyCodeLine{00297\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//sendHPUpdate(true);}}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//sendSkillInitialize();}}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//sendPetUpdate();}}
\DoxyCodeLine{00300\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00301\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_WORLDINFO:}
\DoxyCodeLine{00302\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Game\ starts\ here\ if\ this\ is\ first\ connection}}
\DoxyCodeLine{00303\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ processWorldInfo(packet);}
\DoxyCodeLine{00304\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00305\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_CONNECTION\_ATTEMPT\_FAILED:}
\DoxyCodeLine{00306\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mAlertBox-\/>showAlert(\textcolor{stringliteral}{"{}Our\ connection\ request\ has\ failed\ :c"{}},0.5,0.5,10);}
\DoxyCodeLine{00307\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(isMainServerConnection)}
\DoxyCodeLine{00308\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ networkMessage\ =\ NETWORK\_CONNECTIONFAILED;}
\DoxyCodeLine{00309\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00310\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mGameStateManager-\/>setGameState(GAMESTATE\_RETURNSTARTSCREEN);}
\DoxyCodeLine{00311\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ disconnect();}
\DoxyCodeLine{00312\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tCont\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00313\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00314\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_INVALID\_PASSWORD:}
\DoxyCodeLine{00315\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mAlertBox-\/>showAlert(\textcolor{stringliteral}{"{}Please\ download\ the\ latest\ version\ c:"{}},0.5,0.5,10);}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(isMainServerConnection)}
\DoxyCodeLine{00317\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ networkMessage\ =\ NETWORK\_CONNECTIONFAILED;}
\DoxyCodeLine{00318\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00319\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mGameStateManager-\/>setGameState(GAMESTATE\_RETURNSTARTSCREEN);}
\DoxyCodeLine{00320\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ disconnect();}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tCont\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00322\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00323\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_NO\_FREE\_INCOMING\_CONNECTIONS:}
\DoxyCodeLine{00324\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mAlertBox-\/>showAlert(\textcolor{stringliteral}{"{}This\ server\ is\ temporarily\ unavailable\ :B"{}},0.5,0.5,10);}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(isMainServerConnection)}
\DoxyCodeLine{00326\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ networkMessage\ =\ NETWORK\_CONNECTIONFAILED;}
\DoxyCodeLine{00327\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00328\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mGameStateManager-\/>setGameState(GAMESTATE\_RETURNSTARTSCREEN);}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ disconnect();}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tCont\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00331\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00332\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_CONNECTION\_BANNED:}
\DoxyCodeLine{00333\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mAlertBox-\/>showAlert(\textcolor{stringliteral}{"{}You\ have\ been\ banned"{}},0.5,0.5,10);}
\DoxyCodeLine{00334\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ disconnect();}
\DoxyCodeLine{00335\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tCont\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_DISCONNECTION\_NOTIFICATION:}
\DoxyCodeLine{00338\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(isMainServerConnection)}
\DoxyCodeLine{00339\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00340\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mAlertBox-\/>showAlert(\textcolor{stringliteral}{"{}We\ have\ been\ disconnected\ :c"{}},0.5,0.5,10);}
\DoxyCodeLine{00341\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ networkMessage\ =\ NETWORK\_LOSTCONNECTION;}
\DoxyCodeLine{00342\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00343\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00344\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00345\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Remove\ disconnected\ server\ from\ server\ list}}
\DoxyCodeLine{00346\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ tServerID\ =\ MAX\_SERVERS;}
\DoxyCodeLine{00347\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(vector<std::pair<unsigned\ char,SystemAddress>>::type::iterator\ it=serverAdd.begin();it!=serverAdd.end();it++)}
\DoxyCodeLine{00348\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00349\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::pair<unsigned\ char,SystemAddress>\ tServer\ =\ *it;}
\DoxyCodeLine{00350\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tServer.second==packet-\/>systemAddress)}
\DoxyCodeLine{00351\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tServerID\ =\ tServer.first;}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(serverAdd.size()>1)serverAdd.erase(it);}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00356\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00357\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mAlertBox-\/>showAlert(\textcolor{stringliteral}{"{}Disconnected,\ reconnecting..."{}},0.5,0.5,2.5);}
\DoxyCodeLine{00358\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mChatManager-\/>message(\textcolor{stringliteral}{"{}Disconnected\ from\ Server\ "{}}+StringConverter::toString(tServerID+1)+\textcolor{stringliteral}{"{}."{}});}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ disconnect();}
\DoxyCodeLine{00360\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mItemManager-\/>reset();}
\DoxyCodeLine{00361\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mCritterManager-\/>reset();}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mUnitManager-\/>reset(\textcolor{keyword}{false},\textcolor{keyword}{false});}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mUnitManager-\/>clearPartyMembers();}
\DoxyCodeLine{00364\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mUnitManager-\/>getPlayer()-\/>setIndex(0);}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ connect();}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tCont\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00367\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00369\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_CONNECTION\_LOST:}
\DoxyCodeLine{00370\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(isMainServerConnection)}
\DoxyCodeLine{00371\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00372\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mAlertBox-\/>showAlert(\textcolor{stringliteral}{"{}Connection\ lost\ :c"{}},0.5,0.5,10);}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ networkMessage\ =\ NETWORK\_LOSTCONNECTION;}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00376\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00377\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Remove\ disconnected\ server\ from\ server\ list}}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ tServerID\ =\ MAX\_SERVERS;}
\DoxyCodeLine{00379\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(vector<std::pair<unsigned\ char,SystemAddress>>::type::iterator\ it=serverAdd.begin();it!=serverAdd.end();it++)}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::pair<unsigned\ char,SystemAddress>\ tServer\ =\ *it;}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tServer.second==packet-\/>systemAddress)}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tServerID\ =\ tServer.first;}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(serverAdd.size()>1)serverAdd.erase(it);}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00387\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00388\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00389\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mAlertBox-\/>showAlert(\textcolor{stringliteral}{"{}Connection\ lost,\ reconnecting..."{}},0.5,0.5,2.5);}
\DoxyCodeLine{00390\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mChatManager-\/>message(\textcolor{stringliteral}{"{}Connection\ lost\ from\ Server\ "{}}+StringConverter::toString(tServerID+1)+\textcolor{stringliteral}{"{},\ reconnecting..."{}});}
\DoxyCodeLine{00391\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ disconnect();}
\DoxyCodeLine{00392\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mItemManager-\/>reset();}
\DoxyCodeLine{00393\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mCritterManager-\/>reset();}
\DoxyCodeLine{00394\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mUnitManager-\/>reset(\textcolor{keyword}{false},\textcolor{keyword}{false});}
\DoxyCodeLine{00395\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mUnitManager-\/>clearPartyMembers();}
\DoxyCodeLine{00396\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mUnitManager-\/>getPlayer()-\/>setIndex(0);}
\DoxyCodeLine{00397\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ connect();}
\DoxyCodeLine{00398\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tCont\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00399\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00400\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00401\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_CHAT:\ processChat(packet);\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00402\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_NEWPLAYER:\ processNewPlayer(packet);\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00403\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//case\ ID\_NEWPLAYERCOLOURS:\ processNewPlayerColours(packet);\ break;}}
\DoxyCodeLine{00404\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_POSITION:\ processPosition(packet);\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00405\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_NEWPLAYERUPDATE:\ processAndSendNewPlayerUpdate(packet);\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00406\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_REQUESTMAPINFO:\ processAndSendMapInfo(packet);\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00407\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_PLAYERDISCONNECTED:\ processPlayerDisconnected(packet);\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00408\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_MOVEPOSITION:\ processMovePosition(packet);\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00409\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_LOOKQUATERNION:\ processLookQuaternion(packet);\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00410\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_FACEDIRECTION:\ processFaceDirection(packet);\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00411\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_ACTIONFLAGS:\ processActionFlags(packet);\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00412\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_EMOTE:\ processEmote(packet);\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00413\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_ATTACK:\ processAttack(packet);\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00414\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_PLAYERMAPCHANGE:\ processMapChange(packet);\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00415\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//case\ ID\_VALIDATENAME:\ processValidateName(packet);\ break;}}
\DoxyCodeLine{00416\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_PLAYERDATA:\ processPlayerData(packet);\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00417\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_BIO:\ processBio(packet);\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00418\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_LOGON:\ processLogon(packet);\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00419\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_CREATEACCOUNT:\ processCreateAccount(packet);\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00420\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_LOADCHAR:\ processLoadChar(packet);\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00421\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_CREATECHAR:\ processCreateChar(packet);\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00422\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_EDITCHAR:\ processEditChar(packet);\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00423\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_EDITACCOUNT:\ processEditAccount(packet);\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00424\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_KICK:\ tCont\ =\ processKick(packet);\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00425\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_ITEMDROP:\ processItemDrop(packet);\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00426\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_ITEMPICKUP:\ processItemPickup(packet);\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00427\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_ITEMEQUIP:\ processItemEquip(packet);\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00428\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_ITEMUNEQUIP:\ processItemUnequip(packet);\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00429\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_GODSPEAK:\ processGodSpeak(packet);\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00430\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_FORCELOGOUT:\ tCont\ =\ processForceLogout(packet);\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00431\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_EVENT:\ processEvent(packet);\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00432\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_INFO:\ processInfo(packet);\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00433\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//case\ ID\_DENIED:\ processDenied(packet);\ break;}}
\DoxyCodeLine{00434\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_CRITTEROWNAGE:\ processCritterOwnage(packet);\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00435\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_CRITTERINFO:}
\DoxyCodeLine{00436\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_CRITTERINFOONEWAY:}
\DoxyCodeLine{00437\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ processCritterInfo(packet);}
\DoxyCodeLine{00438\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00439\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_CRITTERTARGETEDINFO:\ processCritterTargetedInfo(packet);\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00440\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//case\ ID\_OBJECTOWNAGE:\ processObjectOwnage(packet);\ break;}}
\DoxyCodeLine{00441\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//case\ ID\_OBJECTINFO:\ processObjectInfo(packet);\ break;}}
\DoxyCodeLine{00442\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//case\ ID\_OBJECTTARGETEDINFO:\ processObjectTargetedInfo(packet);\ break;}}
\DoxyCodeLine{00443\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//case\ ID\_UNITOWNAGE:\ processUnitOwnage(packet);\ break;}}
\DoxyCodeLine{00444\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//case\ ID\_UNITINFO:\ processUnitInfo(packet);\ break;}}
\DoxyCodeLine{00445\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//case\ ID\_UNITTARGETEDINFO:\ processUnitTargetedInfo(packet);\ break;}}
\DoxyCodeLine{00446\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_PLAYERINFO:}
\DoxyCodeLine{00447\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_PLAYERTARGETEDINFO:}
\DoxyCodeLine{00448\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ processPlayerInfo(packet);}
\DoxyCodeLine{00449\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00450\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_ITEMSTASH:\ processItemStash(packet);\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00451\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_FINDPLAYER:\ processFindPlayer(packet);\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00452\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_SERVERLIST:\ processServerList(packet);\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00453\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_SERVERCONNECTED:\ processServerConnected(packet);\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00454\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ ID\_MAINTENANCE:\ processMaintenance(packet);\ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00455\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{default}:}
\DoxyCodeLine{00456\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//mDebugText\ =\ "{}Message\ with\ identifier\ "{}\ +\ StringConverter::toString(int(getPacketIdentifier(packet)))\ +\ "{}\ has\ arrived."{};}}
\DoxyCodeLine{00457\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00458\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00459\ }
\DoxyCodeLine{00460\ \ \ \ \ \ \ \ \ \ \ \ \ mPeer-\/>DeallocatePacket(packet);}
\DoxyCodeLine{00461\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tCont)packet\ =\ mPeer-\/>Receive();}
\DoxyCodeLine{00462\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00463\ \ \ \ \ \}}
\DoxyCodeLine{00464\ \ \ \ \ \textcolor{keyword}{const}\ MessageID\ getPacketIdentifier(Packet\ *p)}
\DoxyCodeLine{00465\ \ \ \ \ \{}
\DoxyCodeLine{00466\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(p==0)}
\DoxyCodeLine{00467\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ 255;}
\DoxyCodeLine{00468\ }
\DoxyCodeLine{00469\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char})p-\/>data[0]\ ==\ ID\_TIMESTAMP)}
\DoxyCodeLine{00470\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00471\ \ \ \ \ \ \ \ \ \ \ \ \ assert(p-\/>length\ >\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char})\ +\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long}));}
\DoxyCodeLine{00472\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char})\ p-\/>data[\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{unsigned}\ char)\ +\ \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{long})];}
\DoxyCodeLine{00473\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00474\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00475\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ (\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char})\ p-\/>data[0];}
\DoxyCodeLine{00476\ \ \ \ \ \}}
\DoxyCodeLine{00477\ \ \ \ \ \textcolor{keyword}{const}\ vector<String>::type\ getPlayersOnline()}
\DoxyCodeLine{00478\ \ \ \ \ \{}
\DoxyCodeLine{00479\ \ \ \ \ \ \ \ \ vector<String>::type\ tList;}
\DoxyCodeLine{00480\ \ \ \ \ \ \ \ \ vector<String>::type\ tMapList;}
\DoxyCodeLine{00481\ \ \ \ \ \ \ \ \ vector<unsigned\ short>::type\ tCountList;}
\DoxyCodeLine{00482\ \ \ \ \ \ \ \ \ tList.clear();}
\DoxyCodeLine{00483\ \ \ \ \ \ \ \ \ tMapList.clear();}
\DoxyCodeLine{00484\ \ \ \ \ \ \ \ \ tCountList.clear();}
\DoxyCodeLine{00485\ }
\DoxyCodeLine{00486\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Count\ players\ in\ each\ map}}
\DoxyCodeLine{00487\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(vector<PlayerData>::type::iterator\ it=playerList.begin();\ it!=playerList.end();\ it++)}
\DoxyCodeLine{00488\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00489\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_player_data}{PlayerData}}\ *tData\ =\ \&*it;}
\DoxyCodeLine{00490\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tHasMap\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00491\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ String\ tMapName\ =\ mDef-\/>getMapName(tData-\/>mapName);}
\DoxyCodeLine{00492\ }
\DoxyCodeLine{00493\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i=0;i<(int)tMapList.size();i++)}
\DoxyCodeLine{00494\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00495\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Map\ exists\ in\ list,\ increment\ player\ count}}
\DoxyCodeLine{00496\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tMapName\ ==\ tMapList[i])}
\DoxyCodeLine{00497\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00498\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tHasMap\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00499\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tCountList[i]\ +=\ 1;}
\DoxyCodeLine{00500\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00501\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00502\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00503\ }
\DoxyCodeLine{00504\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//New\ map,\ add\ to\ list}}
\DoxyCodeLine{00505\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tHasMap)}
\DoxyCodeLine{00506\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00507\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tMapList.push\_back(tMapName);}
\DoxyCodeLine{00508\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tCountList.push\_back(1);}
\DoxyCodeLine{00509\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00510\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00511\ }
\DoxyCodeLine{00512\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Write\ to\ output\ string}}
\DoxyCodeLine{00513\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i=0;i<(int)tMapList.size();i++)}
\DoxyCodeLine{00514\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00515\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ String\ tLine\ =\ tMapList[i]\ +\ \textcolor{stringliteral}{"{}:\ "{}}\ +\ StringConverter::toString(tCountList[i]);}
\DoxyCodeLine{00516\ \ \ \ \ \ \ \ \ \ \ \ \ tList.push\_back(tLine);}
\DoxyCodeLine{00517\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00518\ }
\DoxyCodeLine{00519\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ tList;}
\DoxyCodeLine{00520\ \ \ \ \ \}}
\DoxyCodeLine{00521\ \ \ \ \ \textcolor{keywordtype}{bool}\ isPlayerOnline(String\ name)}
\DoxyCodeLine{00522\ \ \ \ \ \{}
\DoxyCodeLine{00523\ \ \ \ \ \ \ \ \ StringUtil::toLowerCase(name);}
\DoxyCodeLine{00524\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(vector<PlayerData>::type::iterator\ it=playerList.begin();\ it!=playerList.end();\ it++)}
\DoxyCodeLine{00525\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00526\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_player_data}{PlayerData}}\ *tData\ =\ \&*it;}
\DoxyCodeLine{00527\ \ \ \ \ \ \ \ \ \ \ \ \ String\ tName\ =\ tData-\/>name;}
\DoxyCodeLine{00528\ \ \ \ \ \ \ \ \ \ \ \ \ StringUtil::toLowerCase(tName);}
\DoxyCodeLine{00529\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tName\ ==\ name)\textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00530\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00531\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00532\ \ \ \ \ \}}
\DoxyCodeLine{00533\ \ \ \ \ \textcolor{keyword}{const}\ String\ getPlayerMap(String\ name)}
\DoxyCodeLine{00534\ \ \ \ \ \{}
\DoxyCodeLine{00535\ \ \ \ \ \ \ \ \ StringUtil::toLowerCase(name);}
\DoxyCodeLine{00536\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(vector<PlayerData>::type::iterator\ it=playerList.begin();\ it!=playerList.end();\ it++)}
\DoxyCodeLine{00537\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00538\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_player_data}{PlayerData}}\ *tData\ =\ \&*it;}
\DoxyCodeLine{00539\ \ \ \ \ \ \ \ \ \ \ \ \ String\ tName\ =\ tData-\/>name;}
\DoxyCodeLine{00540\ \ \ \ \ \ \ \ \ \ \ \ \ StringUtil::toLowerCase(tName);}
\DoxyCodeLine{00541\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tName\ ==\ name)\textcolor{keywordflow}{return}\ mDef-\/>getMapName(tData-\/>mapName);}
\DoxyCodeLine{00542\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00543\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{00544\ \ \ \ \ \}}
\DoxyCodeLine{00545\ \ \ \ \ \textcolor{keywordtype}{void}\ processPlayerToken(Packet\ *p)}
\DoxyCodeLine{00546\ \ \ \ \ \{}
\DoxyCodeLine{00547\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream(p-\/>data,\ p-\/>length,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00548\ \ \ \ \ \ \ \ \ MessageID\ tID;}
\DoxyCodeLine{00549\ \ \ \ \ \ \ \ \ OwnerToken\ tToken;}
\DoxyCodeLine{00550\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ tDayTime\ =\ (\textcolor{keywordtype}{unsigned}\ short)mSkyManager-\/>getDayTime();}
\DoxyCodeLine{00551\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ tWeatherTime\ =\ (\textcolor{keywordtype}{unsigned}\ short)mSkyManager-\/>getWeatherTime();}
\DoxyCodeLine{00552\ }
\DoxyCodeLine{00553\ \ \ \ \ \ \ \ \ tBitStream.Read(tID);}
\DoxyCodeLine{00554\ \ \ \ \ \ \ \ \ tBitStream.Read(tToken);}
\DoxyCodeLine{00555\ \ \ \ \ \ \ \ \ tBitStream.Read(tDayTime);}
\DoxyCodeLine{00556\ \ \ \ \ \ \ \ \ tBitStream.Read(tWeatherTime);}
\DoxyCodeLine{00557\ }
\DoxyCodeLine{00558\ \ \ \ \ \ \ \ \ mUnitManager-\/>getPlayer()-\/>setIndex(tToken);}
\DoxyCodeLine{00559\ \ \ \ \ \ \ \ \ mSkyManager-\/>setDayTime(tDayTime);}
\DoxyCodeLine{00560\ \ \ \ \ \ \ \ \ mSkyManager-\/>setWeatherTime(tWeatherTime);}
\DoxyCodeLine{00561\ \ \ \ \ \}}
\DoxyCodeLine{00562\ \ \ \ \ \textcolor{keywordtype}{void}\ sendPlayerTokenRequest()}
\DoxyCodeLine{00563\ \ \ \ \ \{}
\DoxyCodeLine{00564\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{00565\ }
\DoxyCodeLine{00566\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_TOKENCONNECTED));}
\DoxyCodeLine{00567\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(mUnitManager-\/>getPlayer()-\/>getUser().c\_str(),16,\&tBitStream);}
\DoxyCodeLine{00568\ \ \ \ \ \ \ \ \ tBitStream.Write((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short})mCharScreenManager-\/>getCharID());}
\DoxyCodeLine{00569\ }
\DoxyCodeLine{00570\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ HIGH\_PRIORITY,\ RELIABLE,\ 0,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00571\ \ \ \ \ \}}
\DoxyCodeLine{00572\ \ \ \ \ \textcolor{keywordtype}{void}\ processChat(Packet\ *p)}
\DoxyCodeLine{00573\ \ \ \ \ \{}
\DoxyCodeLine{00574\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream(p-\/>data,\ p-\/>length,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00575\ \ \ \ \ \ \ \ \ MessageID\ tID;}
\DoxyCodeLine{00576\ \ \ \ \ \ \ \ \ OwnerToken\ tToken;}
\DoxyCodeLine{00577\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ tCaption[256];}
\DoxyCodeLine{00578\ }
\DoxyCodeLine{00579\ \ \ \ \ \ \ \ \ tBitStream.Read(tID);}
\DoxyCodeLine{00580\ \ \ \ \ \ \ \ \ tBitStream.Read(tToken);}
\DoxyCodeLine{00581\ \ \ \ \ \ \ \ \ stringCompressor-\/>DecodeString(tCaption,256,\&tBitStream);}
\DoxyCodeLine{00582\ }
\DoxyCodeLine{00583\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tToken==SERVER\_ID)}
\DoxyCodeLine{00584\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00585\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tIsPM\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00586\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tIsParty\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00587\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tIsPM);}
\DoxyCodeLine{00588\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tIsPM)}
\DoxyCodeLine{00589\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00590\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ tName[16]=\textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{00591\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stringCompressor-\/>DecodeString(tName,16,\&tBitStream);}
\DoxyCodeLine{00592\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(String(tName)!=\textcolor{stringliteral}{"{}"{}})}
\DoxyCodeLine{00593\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00594\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(mDef-\/>isInBlockedList(tName))\textcolor{keywordflow}{return};}
\DoxyCodeLine{00595\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00596\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00597\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ tBitStream.Read(tIsParty);}
\DoxyCodeLine{00598\ \ \ \ \ \ \ \ \ \ \ \ \ mChatManager-\/>message(String(tCaption),tIsParty?CHAT\_PARTY:0);}
\DoxyCodeLine{00599\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00600\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00601\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00602\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_magix_indexed_unit}{MagixIndexedUnit}}\ *tUnit\ =\ mUnitManager-\/>getUnitByIndex(tToken);}
\DoxyCodeLine{00603\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tUnit)\textcolor{keywordflow}{return};}
\DoxyCodeLine{00604\ }
\DoxyCodeLine{00605\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ tType=CHAT\_GENERAL;}
\DoxyCodeLine{00606\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tLipSync=\textcolor{keyword}{false};}
\DoxyCodeLine{00607\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tType);}
\DoxyCodeLine{00608\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tLipSync);}
\DoxyCodeLine{00609\ }
\DoxyCodeLine{00610\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Return\ if\ sayer\ is\ blocked}}
\DoxyCodeLine{00611\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tUnit-\/>isBlocked)\textcolor{keywordflow}{return};}
\DoxyCodeLine{00612\ }
\DoxyCodeLine{00613\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tLipSync||tType==CHAT\_LIPSYNC)tUnit-\/>doLipSync(tCaption);}
\DoxyCodeLine{00614\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tType!=CHAT\_LIPSYNC)mChatManager-\/>say(mUnitManager,tUnit,String(tCaption),tType);}
\DoxyCodeLine{00615\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00616\ \ \ \ \ \}}
\DoxyCodeLine{00617\ \ \ \ \ \textcolor{keywordtype}{void}\ sendChat(\textcolor{keyword}{const}\ String\ \&caption,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ \&type,\ \textcolor{keyword}{const}\ String\ \&pmTarget=\textcolor{stringliteral}{"{}"{}},\ \textcolor{keywordtype}{bool}\ autoLipSync=\textcolor{keyword}{false})}
\DoxyCodeLine{00618\ \ \ \ \ \{}
\DoxyCodeLine{00619\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{00620\ }
\DoxyCodeLine{00621\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_CHAT));}
\DoxyCodeLine{00622\ \ \ \ \ \ \ \ \ tBitStream.Write(OwnerToken(TOKEN\_NULL));}
\DoxyCodeLine{00623\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00624\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Private\ message}}
\DoxyCodeLine{00625\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(type==CHAT\_PRIVATE\ \&\&pmTarget.length()>0)}
\DoxyCodeLine{00626\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00627\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(pmTarget==mUnitManager-\/>getPlayer()-\/>getUser())}
\DoxyCodeLine{00628\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00629\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mChatManager-\/>message(\textcolor{stringliteral}{"{}Cannot\ send\ Private\ Message\ to\ yourself."{}});}
\DoxyCodeLine{00630\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00631\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00632\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00633\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00634\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{true});}
\DoxyCodeLine{00635\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(pmTarget.c\_str(),16,\&tBitStream);}
\DoxyCodeLine{00636\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mChatManager-\/>message(\textcolor{stringliteral}{"{}Sent\ Private\ Message\ to\ "{}}\ +\ pmTarget\ +\ \textcolor{stringliteral}{"{}."{}});}
\DoxyCodeLine{00637\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00638\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00639\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ tBitStream.Write(\textcolor{keyword}{false});}
\DoxyCodeLine{00640\ }
\DoxyCodeLine{00641\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(caption.c\_str(),256,\&tBitStream);}
\DoxyCodeLine{00642\ \ \ \ \ \ \ \ \ tBitStream.Write(type);}
\DoxyCodeLine{00643\ \ \ \ \ \ \ \ \ tBitStream.Write(autoLipSync);}
\DoxyCodeLine{00644\ }
\DoxyCodeLine{00645\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ MEDIUM\_PRIORITY,\ RELIABLE,\ 0,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00646\ \ \ \ \ \}}
\DoxyCodeLine{00647\ \ \ \ \ \textcolor{keywordtype}{void}\ sendPartyChat(\textcolor{keyword}{const}\ OwnerToken\ \&target,\ \textcolor{keyword}{const}\ String\ \&caption,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ \&type,\ \textcolor{keywordtype}{bool}\ autoLipSync=\textcolor{keyword}{false})}
\DoxyCodeLine{00648\ \ \ \ \ \{}
\DoxyCodeLine{00649\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{00650\ }
\DoxyCodeLine{00651\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_CHAT));}
\DoxyCodeLine{00652\ \ \ \ \ \ \ \ \ tBitStream.Write(target);}
\DoxyCodeLine{00653\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00654\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_magix_indexed_unit}{MagixIndexedUnit}}\ *tUnit\ =\ mUnitManager-\/>getUnitByIndex(target);}
\DoxyCodeLine{00655\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Is\ on\ different\ map,\ server\ will\ process\ and\ redirect\ chat}}
\DoxyCodeLine{00656\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tUnit)tBitStream.Write(\textcolor{keyword}{true});}
\DoxyCodeLine{00657\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Normal\ chat\ send}}
\DoxyCodeLine{00658\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ tBitStream.Write(\textcolor{keyword}{false});}
\DoxyCodeLine{00659\ }
\DoxyCodeLine{00660\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(caption.c\_str(),256,\&tBitStream);}
\DoxyCodeLine{00661\ \ \ \ \ \ \ \ \ tBitStream.Write(type);}
\DoxyCodeLine{00662\ \ \ \ \ \ \ \ \ tBitStream.Write(autoLipSync);}
\DoxyCodeLine{00663\ }
\DoxyCodeLine{00664\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ MEDIUM\_PRIORITY,\ RELIABLE,\ 0,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00665\ \ \ \ \ \}}
\DoxyCodeLine{00666\ \ \ \ \ \textcolor{keywordtype}{void}\ processNewPlayer(Packet\ *p)}
\DoxyCodeLine{00667\ \ \ \ \ \{}
\DoxyCodeLine{00668\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream(p-\/>data,\ p-\/>length,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00669\ \ \ \ \ \ \ \ \ MessageID\ tID;}
\DoxyCodeLine{00670\ \ \ \ \ \ \ \ \ OwnerToken\ tToken;}
\DoxyCodeLine{00671\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ tUser[16];}
\DoxyCodeLine{00672\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ tName[32];}
\DoxyCodeLine{00673\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ tMeshString[128];}
\DoxyCodeLine{00674\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ tMatName[32];}
\DoxyCodeLine{00675\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ tMeshString2[32];}
\DoxyCodeLine{00676\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tDefaultScale;}
\DoxyCodeLine{00677\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tBadData\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00678\ }
\DoxyCodeLine{00679\ \ \ \ \ \ \ \ \ tBitStream.Read(tID);}
\DoxyCodeLine{00680\ \ \ \ \ \ \ \ \ tBitStream.Read(tToken);}
\DoxyCodeLine{00681\ \ \ \ \ \ \ \ \ stringCompressor-\/>DecodeString(tUser,16,\&tBitStream);}
\DoxyCodeLine{00682\ \ \ \ \ \ \ \ \ stringCompressor-\/>DecodeString(tName,32,\&tBitStream);}
\DoxyCodeLine{00683\ \ \ \ \ \ \ \ \ stringCompressor-\/>DecodeString(tMeshString,128,\&tBitStream);}
\DoxyCodeLine{00684\ \ \ \ \ \ \ \ \ stringCompressor-\/>DecodeString(tMatName,32,\&tBitStream);}
\DoxyCodeLine{00685\ \ \ \ \ \ \ \ \ stringCompressor-\/>DecodeString(tMeshString2,32,\&tBitStream);}
\DoxyCodeLine{00686\ \ \ \ \ \ \ \ \ tBitStream.Read(tDefaultScale);}
\DoxyCodeLine{00687\ }
\DoxyCodeLine{00688\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ vector<String>::type\ tParam\ =\ StringUtil::split(String(tMeshString),\textcolor{stringliteral}{"{};"{}},5);}
\DoxyCodeLine{00689\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tParam.size()!=5)tBadData\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00690\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ vector<String>::type\ tParam2\ =\ StringUtil::split(String(tMeshString2),\textcolor{stringliteral}{"{};"{}},1);}
\DoxyCodeLine{00691\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tParam2.size()!=1)tBadData\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00692\ }
\DoxyCodeLine{00693\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Unit\ already\ exists,\ don't\ create}}
\DoxyCodeLine{00694\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(mUnitManager-\/>getUnitByIndex(tToken))\textcolor{keywordflow}{return};}
\DoxyCodeLine{00695\ }
\DoxyCodeLine{00696\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_magix_indexed_unit}{MagixIndexedUnit}}\ *tUnit\ =\ }
\DoxyCodeLine{00697\ \ \ \ \ \ \ \ \ \ \ \ \ tBadData?mUnitManager-\/>createUnit(tToken,\textcolor{stringliteral}{"{}Body"{}},\textcolor{stringliteral}{"{}Head1"{}},\textcolor{stringliteral}{"{}Maneless"{}},\textcolor{stringliteral}{"{}Tail1"{}},\textcolor{stringliteral}{"{}Wingless"{}},tMatName,\textcolor{stringliteral}{"{}Tuftless"{}})}
\DoxyCodeLine{00698\ \ \ \ \ \ \ \ \ \ \ \ \ :mUnitManager-\/>createUnit(tToken,tParam[0],tParam[1],mDef-\/>hasManeMesh(tParam[2])?tParam[2]:\textcolor{stringliteral}{"{}Maneless"{}},(mDef-\/>hasTailMesh(tParam[3])?tParam[3]:\textcolor{stringliteral}{"{}Tail1"{}}),(mDef-\/>hasWingMesh(tParam[4])?tParam[4]:\textcolor{stringliteral}{"{}Wingless"{}}),tMatName,(mDef-\/>hasTuftMesh(tParam2[0])?tParam2[0]:\textcolor{stringliteral}{"{}Tuftless"{}}));}
\DoxyCodeLine{00699\ \ \ \ \ \ \ \ \ tUnit-\/>setHP(500);}
\DoxyCodeLine{00700\ \ \ \ \ \ \ \ \ mUnitManager-\/>createNameTag(tUnit,tName);}
\DoxyCodeLine{00701\ \ \ \ \ \ \ \ \ mUnitManager-\/>createUserTag(tUnit,tUser);}
\DoxyCodeLine{00702\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tDefaultScale)}
\DoxyCodeLine{00703\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00704\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{float}\ tScale;}
\DoxyCodeLine{00705\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tScale);}
\DoxyCodeLine{00706\ \ \ \ \ \ \ \ \ \ \ \ \ tUnit-\/>getObjectNode()-\/>setScale(tScale,tScale,tScale);}
\DoxyCodeLine{00707\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00708\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(String(tMatName)==\textcolor{stringliteral}{"{}CustomMat"{}})}
\DoxyCodeLine{00709\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00710\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{short}\ tBodyMark,\ tHeadMark,\ tTailMark;}
\DoxyCodeLine{00711\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ tColours[256];}
\DoxyCodeLine{00712\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tBodyMark);}
\DoxyCodeLine{00713\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tHeadMark);}
\DoxyCodeLine{00714\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tTailMark);}
\DoxyCodeLine{00715\ \ \ \ \ \ \ \ \ \ \ \ \ tUnit-\/>setMarkings((mDef-\/>hasBodyMark(tBodyMark)?tBodyMark:0),(mDef-\/>hasHeadMark(tHeadMark)?tHeadMark:0),(mDef-\/>hasTailMark(tTailMark)?tTailMark:0));}
\DoxyCodeLine{00716\ \ \ \ \ \ \ \ \ \ \ \ \ stringCompressor-\/>DecodeString(tColours,256,\&tBitStream);}
\DoxyCodeLine{00717\ \ \ \ \ \ \ \ \ \ \ \ \ tUnit-\/>setColours(String(tColours));}
\DoxyCodeLine{00718\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00719\ }
\DoxyCodeLine{00720\ \ \ \ \ \ \ \ \ tUnit-\/>setAlliance(ALLIANCE\_FRIEND);}
\DoxyCodeLine{00721\ \ \ \ \ \ \ \ \ tUnit-\/>isFriend\ =\ mDef-\/>isInFriendList(tUser);}
\DoxyCodeLine{00722\ \ \ \ \ \ \ \ \ tUnit-\/>isBlocked\ =\ mDef-\/>isInBlockedList(tUser);}
\DoxyCodeLine{00723\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00724\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ tAdminToken[8]\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{00725\ \ \ \ \ \ \ \ \ stringCompressor-\/>DecodeString(tAdminToken,8,\&tBitStream);}
\DoxyCodeLine{00726\ \ \ \ \ \ \ \ \ tUnit-\/>isAdmin\ =\ (String(tAdminToken)==\textcolor{stringliteral}{"{}ok."{}});}
\DoxyCodeLine{00727\ \ \ \ \ \ \ \ \ tUnit-\/>isMod\ =\ (String(tAdminToken)==\textcolor{stringliteral}{"{}mod"{}});}
\DoxyCodeLine{00728\ }
\DoxyCodeLine{00729\ \ \ \ \ \ \ \ \ String\ tAddMessage\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{00730\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tUnit-\/>isFriend)tAddMessage\ =\ \textcolor{stringliteral}{"{}\ (Friend)"{}};}
\DoxyCodeLine{00731\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tUnit-\/>isBlocked)}
\DoxyCodeLine{00732\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00733\ \ \ \ \ \ \ \ \ \ \ \ \ tAddMessage\ =\ \textcolor{stringliteral}{"{}\ (Blocked)"{}};}
\DoxyCodeLine{00734\ \ \ \ \ \ \ \ \ \ \ \ \ tUnit-\/>isHidden\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00735\ \ \ \ \ \ \ \ \ \ \ \ \ sendInfo(INFO\_YOURBLOCKED,tToken);}
\DoxyCodeLine{00736\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00737\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tUnit-\/>isAdmin)}
\DoxyCodeLine{00738\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00739\ \ \ \ \ \ \ \ \ \ \ \ \ tAddMessage\ =\ \textcolor{stringliteral}{"{}\ ("{}}\ USER\_ADMIN\_TEXT\ \textcolor{stringliteral}{"{})"{}};}
\DoxyCodeLine{00740\ \ \ \ \ \ \ \ \ \ \ \ \ tUnit-\/>isHidden\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00741\ \ \ \ \ \ \ \ \ \ \ \ \ tUnit-\/>isBlocked\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00742\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ tAdminColour[16];}
\DoxyCodeLine{00743\ \ \ \ \ \ \ \ \ \ \ \ \ stringCompressor-\/>DecodeString(tAdminColour,16,\&tBitStream);}
\DoxyCodeLine{00744\ \ \ \ \ \ \ \ \ \ \ \ \ mUnitManager-\/>createAdminAura(tUnit,StringConverter::parseColourValue(String(tAdminColour)));}
\DoxyCodeLine{00745\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00746\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tUnit-\/>isMod)}
\DoxyCodeLine{00747\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00748\ \ \ \ \ \ \ \ \ \ \ \ \ tUnit-\/>isHidden\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00749\ \ \ \ \ \ \ \ \ \ \ \ \ tUnit-\/>isBlocked\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00750\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{/*bool\ tIsModOn\ =\ false;}}
\DoxyCodeLine{00751\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tIsModOn);}}
\DoxyCodeLine{00752\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ if(tIsModOn)mUnitManager-\/>createParticleOnUnit(tUnit,"{}RisingShards"{},-\/1,true);*/}}
\DoxyCodeLine{00753\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00754\ }
\DoxyCodeLine{00755\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ String\ tAddName\ =\ (tUnit-\/>getUser()==\textcolor{stringliteral}{"{}"{}}?tUnit-\/>getName():tUnit-\/>getUser());}
\DoxyCodeLine{00756\ \ \ \ \ \ \ \ \ mChatManager-\/>message(tAddName\ +\ tAddMessage\ +\ \textcolor{stringliteral}{"{}\ has\ arrived."{}},(mUnitManager-\/>isPartyMember(tUnit)?0:(mChatManager-\/>getChannel()==0?CHAT\_LOCAL:CHAT\_GENERAL)));}
\DoxyCodeLine{00757\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tBadData)mChatManager-\/>message(\textcolor{stringliteral}{"{}Error\ notice:"{}}\ +\ tAddName\ +\ \textcolor{stringliteral}{"{}has\ sent\ erroneous\ data."{}});}
\DoxyCodeLine{00758\ }
\DoxyCodeLine{00759\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Process\ early\ position\ packets}}
\DoxyCodeLine{00760\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(vector<std::pair<OwnerToken,PositionInfo>>::type::iterator\ it=playerPositionQueue.begin();it!=playerPositionQueue.end();it++)}
\DoxyCodeLine{00761\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00762\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::pair<OwnerToken,PositionInfo>\ tPos\ =\ *it;}
\DoxyCodeLine{00763\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tPos.first==tToken)}
\DoxyCodeLine{00764\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00765\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tUnit-\/>setPosition(tPos.second.position);}
\DoxyCodeLine{00766\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tUnit-\/>resetTarget();}
\DoxyCodeLine{00767\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tUnit-\/>allocFlags.hasOwnGroundHeight\ =\ tPos.second.hasOwnGroundHeight;}
\DoxyCodeLine{00768\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tPos.second.hasOwnGroundHeight)tUnit-\/>setGroundHeight(tPos.second.groundHeight);}
\DoxyCodeLine{00769\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ mUnitManager-\/>clampUnitToTerrain(tUnit,\textcolor{keyword}{false});}
\DoxyCodeLine{00770\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ playerPositionQueue.erase(it);}
\DoxyCodeLine{00771\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00772\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00773\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00774\ \ \ \ \ \}}
\DoxyCodeLine{00775\ \ \ \ \ \textcolor{keywordtype}{void}\ sendNewPlayer(\textcolor{keyword}{const}\ OwnerToken\ \&target=OwnerToken(TOKEN\_NULL))}
\DoxyCodeLine{00776\ \ \ \ \ \{}
\DoxyCodeLine{00777\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{00778\ }
\DoxyCodeLine{00779\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_NEWPLAYER));}
\DoxyCodeLine{00780\ \ \ \ \ \ \ \ \ tBitStream.Write(target);}
\DoxyCodeLine{00781\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(mUnitManager-\/>getPlayer()-\/>getUser().c\_str(),16,\&tBitStream);}
\DoxyCodeLine{00782\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(mUnitManager-\/>getPlayer()-\/>getName().c\_str(),32,\&tBitStream);}
\DoxyCodeLine{00783\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(mUnitManager-\/>getPlayer()-\/>getMeshString().c\_str(),128,\&tBitStream);}
\DoxyCodeLine{00784\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(mUnitManager-\/>getPlayer()-\/>getMatGroupName().c\_str(),32,\&tBitStream);}
\DoxyCodeLine{00785\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(mUnitManager-\/>getPlayer()-\/>getMeshString2().c\_str(),32,\&tBitStream);}
\DoxyCodeLine{00786\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ tDefaultScale\ =\ (mUnitManager-\/>getPlayer()-\/>getObjectNode()-\/>getScale().x\ ==\ 1);}
\DoxyCodeLine{00787\ \ \ \ \ \ \ \ \ tBitStream.Write(tDefaultScale);}
\DoxyCodeLine{00788\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tDefaultScale)tBitStream.Write(mUnitManager-\/>getPlayer()-\/>getObjectNode()-\/>getScale().x);}
\DoxyCodeLine{00789\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>getMatGroupName()==\textcolor{stringliteral}{"{}CustomMat"{}})}
\DoxyCodeLine{00790\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00791\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{short}\ tBodyMark=0,\ tHeadMark=0,\ tTailMark=0;}
\DoxyCodeLine{00792\ \ \ \ \ \ \ \ \ \ \ \ \ mUnitManager-\/>getPlayer()-\/>getMarkings(tBodyMark,tHeadMark,tTailMark);}
\DoxyCodeLine{00793\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Write(tBodyMark);}
\DoxyCodeLine{00794\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Write(tHeadMark);}
\DoxyCodeLine{00795\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Write(tTailMark);}
\DoxyCodeLine{00796\ \ \ \ \ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(mUnitManager-\/>getPlayer()-\/>getColourString().c\_str(),256,\&tBitStream);}
\DoxyCodeLine{00797\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00798\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(mDef-\/>isAdmin?\textcolor{stringliteral}{"{}ok."{}}:(mDef-\/>isMod?\textcolor{stringliteral}{"{}mod"{}}:\textcolor{stringliteral}{"{}nil"{}}),8,\&tBitStream);}
\DoxyCodeLine{00799\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(mDef-\/>isAdmin)stringCompressor-\/>EncodeString(StringConverter::toString(mDef-\/>adminAuraColour).c\_str(),16,\&tBitStream);}
\DoxyCodeLine{00800\ \ \ \ \ \ \ \ \ \textcolor{comment}{//if(mDef-\/>isMod)tBitStream.Write(mDef-\/>isModOn);}}
\DoxyCodeLine{00801\ }
\DoxyCodeLine{00802\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ HIGH\_PRIORITY,\ RELIABLE,\ 0,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00803\ \ \ \ \ \}}
\DoxyCodeLine{00804\ \ \ \ \ \textcolor{keywordtype}{void}\ processPosition(Packet\ *p)}
\DoxyCodeLine{00805\ \ \ \ \ \{}
\DoxyCodeLine{00806\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream(p-\/>data,\ p-\/>length,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00807\ \ \ \ \ \ \ \ \ MessageID\ tID;}
\DoxyCodeLine{00808\ \ \ \ \ \ \ \ \ OwnerToken\ tToken;}
\DoxyCodeLine{00809\ \ \ \ \ \ \ \ \ Vector3\ tPosition;}
\DoxyCodeLine{00810\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tHasGroundHeight\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00811\ \ \ \ \ \ \ \ \ Real\ tGroundHeight\ =\ 0;}
\DoxyCodeLine{00812\ }
\DoxyCodeLine{00813\ \ \ \ \ \ \ \ \ tBitStream.Read(tID);}
\DoxyCodeLine{00814\ \ \ \ \ \ \ \ \ tBitStream.Read(tToken);}
\DoxyCodeLine{00815\ \ \ \ \ \ \ \ \ tBitStream.Read(tPosition);}
\DoxyCodeLine{00816\ \ \ \ \ \ \ \ \ tBitStream.Read(tHasGroundHeight);}
\DoxyCodeLine{00817\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tHasGroundHeight)tBitStream.Read(tGroundHeight);}
\DoxyCodeLine{00818\ }
\DoxyCodeLine{00819\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_magix_indexed_unit}{MagixIndexedUnit}}\ *tUnit\ =\ mUnitManager-\/>getUnitByIndex(tToken);}
\DoxyCodeLine{00820\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tUnit)}
\DoxyCodeLine{00821\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00822\ \ \ \ \ \ \ \ \ \ \ \ \ playerPositionQueue.push\_back(std::pair<OwnerToken,PositionInfo>(tToken,\mbox{\hyperlink{struct_position_info}{PositionInfo}}(tPosition,tHasGroundHeight,tGroundHeight)));}
\DoxyCodeLine{00823\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00824\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00825\ \ \ \ \ \ \ \ \ tUnit-\/>setPosition(tPosition);}
\DoxyCodeLine{00826\ \ \ \ \ \ \ \ \ tUnit-\/>resetTarget();}
\DoxyCodeLine{00827\ \ \ \ \ \ \ \ \ tUnit-\/>allocFlags.hasOwnGroundHeight\ =\ tHasGroundHeight;}
\DoxyCodeLine{00828\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tHasGroundHeight)tUnit-\/>setGroundHeight(tGroundHeight);}
\DoxyCodeLine{00829\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ mUnitManager-\/>clampUnitToTerrain(tUnit,\textcolor{keyword}{false});}
\DoxyCodeLine{00830\ \ \ \ \ \}}
\DoxyCodeLine{00831\ \ \ \ \ \textcolor{keywordtype}{void}\ sendPosition(\textcolor{keyword}{const}\ OwnerToken\ \&target=OwnerToken(TOKEN\_NULL))}
\DoxyCodeLine{00832\ \ \ \ \ \{}
\DoxyCodeLine{00833\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{00834\ }
\DoxyCodeLine{00835\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_POSITION));}
\DoxyCodeLine{00836\ \ \ \ \ \ \ \ \ tBitStream.Write(target);}
\DoxyCodeLine{00837\ \ \ \ \ \ \ \ \ tBitStream.Write(mUnitManager-\/>getPlayer()-\/>getPosition());}
\DoxyCodeLine{00838\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tOwnGroundHeight\ =\ mUnitManager-\/>getPlayer()-\/>allocFlags.hasOwnGroundHeight;}
\DoxyCodeLine{00839\ \ \ \ \ \ \ \ \ tBitStream.Write(tOwnGroundHeight);}
\DoxyCodeLine{00840\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tOwnGroundHeight)tBitStream.Write(mUnitManager-\/>getPlayer()-\/>getGroundHeight());}
\DoxyCodeLine{00841\ }
\DoxyCodeLine{00842\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ HIGH\_PRIORITY,\ RELIABLE,\ 0,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00843\ \ \ \ \ \}}
\DoxyCodeLine{00844\ \ \ \ \ \textcolor{keywordtype}{void}\ processMovePosition(Packet\ *p)}
\DoxyCodeLine{00845\ \ \ \ \ \{}
\DoxyCodeLine{00846\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream(p-\/>data,\ p-\/>length,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00847\ \ \ \ \ \ \ \ \ MessageID\ tID;}
\DoxyCodeLine{00848\ \ \ \ \ \ \ \ \ OwnerToken\ tToken;}
\DoxyCodeLine{00849\ }
\DoxyCodeLine{00850\ \ \ \ \ \ \ \ \ tBitStream.Read(tID);}
\DoxyCodeLine{00851\ \ \ \ \ \ \ \ \ tBitStream.Read(tToken);}
\DoxyCodeLine{00852\ }
\DoxyCodeLine{00853\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_magix_indexed_unit}{MagixIndexedUnit}}\ *tUnit\ =\ mUnitManager-\/>getUnitByIndex(tToken);}
\DoxyCodeLine{00854\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tUnit)\textcolor{keywordflow}{return};}
\DoxyCodeLine{00855\ }
\DoxyCodeLine{00856\ \ \ \ \ \ \ \ \ Vector3\ tPosition;}
\DoxyCodeLine{00857\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tOwnGroundHeight;}
\DoxyCodeLine{00858\ \ \ \ \ \ \ \ \ tBitStream.Read(tPosition);}
\DoxyCodeLine{00859\ \ \ \ \ \ \ \ \ tBitStream.Read(tOwnGroundHeight);}
\DoxyCodeLine{00860\ }
\DoxyCodeLine{00861\ \ \ \ \ \ \ \ \ tUnit-\/>allocFlags.hasOwnGroundHeight\ =\ tOwnGroundHeight;}
\DoxyCodeLine{00862\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tOwnGroundHeight)}
\DoxyCodeLine{00863\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00864\ \ \ \ \ \ \ \ \ \ \ \ \ Real\ tGroundHeight;}
\DoxyCodeLine{00865\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tGroundHeight);}
\DoxyCodeLine{00866\ \ \ \ \ \ \ \ \ \ \ \ \ tUnit-\/>setGroundHeight(tGroundHeight);}
\DoxyCodeLine{00867\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00868\ }
\DoxyCodeLine{00869\ \ \ \ \ \ \ \ \ tUnit-\/>setTarget(tPosition);}
\DoxyCodeLine{00870\ \ \ \ \ \}}
\DoxyCodeLine{00871\ \ \ \ \ \textcolor{keywordtype}{void}\ sendMovePosition()}
\DoxyCodeLine{00872\ \ \ \ \ \{}
\DoxyCodeLine{00873\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Vector3\ tPos\ =\ mUnitManager-\/>getPlayer()-\/>getPosition();}
\DoxyCodeLine{00874\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Real\ tHeight\ =\ mUnitManager-\/>getPlayer()-\/>getGroundHeight();}
\DoxyCodeLine{00875\ }
\DoxyCodeLine{00876\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(lastMovePosition.first==tPos\ \&\&\ lastMovePosition.second==tHeight)\textcolor{keywordflow}{return};}
\DoxyCodeLine{00877\ \ \ \ \ \ \ \ \ lastMovePosition.first\ =\ tPos;}
\DoxyCodeLine{00878\ \ \ \ \ \ \ \ \ lastMovePosition.second\ =\ tHeight;}
\DoxyCodeLine{00879\ }
\DoxyCodeLine{00880\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{00881\ }
\DoxyCodeLine{00882\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_MOVEPOSITION));}
\DoxyCodeLine{00883\ \ \ \ \ \ \ \ \ tBitStream.Write(OwnerToken(TOKEN\_NULL));}
\DoxyCodeLine{00884\ \ \ \ \ \ \ \ \ tBitStream.Write(tPos);}
\DoxyCodeLine{00885\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tOwnGroundHeight\ =\ mUnitManager-\/>getPlayer()-\/>allocFlags.hasOwnGroundHeight;}
\DoxyCodeLine{00886\ \ \ \ \ \ \ \ \ tBitStream.Write(tOwnGroundHeight);}
\DoxyCodeLine{00887\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tOwnGroundHeight)tBitStream.Write(tHeight);}
\DoxyCodeLine{00888\ }
\DoxyCodeLine{00889\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ LOW\_PRIORITY,\ UNRELIABLE\_SEQUENCED,\ 5,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00890\ \ \ \ \ \}}
\DoxyCodeLine{00891\ \ \ \ \ \textcolor{keywordtype}{void}\ processLookQuaternion(Packet\ *p)}
\DoxyCodeLine{00892\ \ \ \ \ \{}
\DoxyCodeLine{00893\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream(p-\/>data,\ p-\/>length,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00894\ \ \ \ \ \ \ \ \ MessageID\ tID;}
\DoxyCodeLine{00895\ \ \ \ \ \ \ \ \ OwnerToken\ tToken;}
\DoxyCodeLine{00896\ }
\DoxyCodeLine{00897\ \ \ \ \ \ \ \ \ tBitStream.Read(tID);}
\DoxyCodeLine{00898\ \ \ \ \ \ \ \ \ tBitStream.Read(tToken);}
\DoxyCodeLine{00899\ }
\DoxyCodeLine{00900\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_magix_indexed_unit}{MagixIndexedUnit}}\ *tUnit\ =\ mUnitManager-\/>getUnitByIndex(tToken);}
\DoxyCodeLine{00901\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tUnit)\textcolor{keywordflow}{return};}
\DoxyCodeLine{00902\ }
\DoxyCodeLine{00903\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tFreeLook;}
\DoxyCodeLine{00904\ \ \ \ \ \ \ \ \ tBitStream.Read(tFreeLook);}
\DoxyCodeLine{00905\ \ \ \ \ \ \ \ \ tUnit-\/>setFreeLook(tFreeLook);}
\DoxyCodeLine{00906\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tFreeLook)\textcolor{keywordflow}{return};}
\DoxyCodeLine{00907\ }
\DoxyCodeLine{00908\ \ \ \ \ \ \ \ \ Quaternion\ tDirection;}
\DoxyCodeLine{00909\ \ \ \ \ \ \ \ \ tBitStream.Read(tDirection);}
\DoxyCodeLine{00910\ }
\DoxyCodeLine{00911\ \ \ \ \ \ \ \ \ tUnit-\/>setLookDirection(tDirection);}
\DoxyCodeLine{00912\ \ \ \ \ \}}
\DoxyCodeLine{00913\ \ \ \ \ \textcolor{keywordtype}{void}\ sendLookQuaternion(\textcolor{keyword}{const}\ OwnerToken\ \&target=OwnerToken(TOKEN\_NULL))}
\DoxyCodeLine{00914\ \ \ \ \ \{}
\DoxyCodeLine{00915\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ tFreeLook\ =\ mUnitManager-\/>getPlayer()-\/>getFreeLook();}
\DoxyCodeLine{00916\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(target==TOKEN\_NULL)}
\DoxyCodeLine{00917\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00918\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tFreeLook\ \&\&\ !lastLookQuaternion.first)\textcolor{keywordflow}{return};}
\DoxyCodeLine{00919\ \ \ \ \ \ \ \ \ \ \ \ \ lastLookQuaternion.first\ =\ tFreeLook;}
\DoxyCodeLine{00920\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00921\ }
\DoxyCodeLine{00922\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Quaternion\ tDir\ =\ mUnitManager-\/>getPlayer()-\/>getLookDirection();}
\DoxyCodeLine{00923\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(lastLookQuaternion.second==tDir)\textcolor{keywordflow}{return};}
\DoxyCodeLine{00924\ \ \ \ \ \ \ \ \ lastLookQuaternion.second\ =\ tDir;}
\DoxyCodeLine{00925\ }
\DoxyCodeLine{00926\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{00927\ }
\DoxyCodeLine{00928\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_LOOKQUATERNION));}
\DoxyCodeLine{00929\ \ \ \ \ \ \ \ \ tBitStream.Write(target);}
\DoxyCodeLine{00930\ \ \ \ \ \ \ \ \ tBitStream.Write(tFreeLook);}
\DoxyCodeLine{00931\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tFreeLook)tBitStream.Write(tDir);}
\DoxyCodeLine{00932\ }
\DoxyCodeLine{00933\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ LOW\_PRIORITY,\ UNRELIABLE\_SEQUENCED,\ 5,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00934\ \ \ \ \ \}}
\DoxyCodeLine{00935\ \ \ \ \ \textcolor{keywordtype}{void}\ processFaceDirection(Packet\ *p)}
\DoxyCodeLine{00936\ \ \ \ \ \{}
\DoxyCodeLine{00937\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream(p-\/>data,\ p-\/>length,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00938\ \ \ \ \ \ \ \ \ MessageID\ tID;}
\DoxyCodeLine{00939\ \ \ \ \ \ \ \ \ OwnerToken\ tToken;}
\DoxyCodeLine{00940\ }
\DoxyCodeLine{00941\ \ \ \ \ \ \ \ \ tBitStream.Read(tID);}
\DoxyCodeLine{00942\ \ \ \ \ \ \ \ \ tBitStream.Read(tToken);}
\DoxyCodeLine{00943\ }
\DoxyCodeLine{00944\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_magix_indexed_unit}{MagixIndexedUnit}}\ *tUnit\ =\ mUnitManager-\/>getUnitByIndex(tToken);}
\DoxyCodeLine{00945\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tUnit)\textcolor{keywordflow}{return};}
\DoxyCodeLine{00946\ \ \ \ \ \ \ \ \ \textcolor{comment}{//So\ that\ fainted\ units\ don't\ rotate\ on\ the\ floor}}
\DoxyCodeLine{00947\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tUnit-\/>isDisabled()\ \&\&\ tUnit-\/>getHP()<=0)\textcolor{keywordflow}{return};}
\DoxyCodeLine{00948\ }
\DoxyCodeLine{00949\ \ \ \ \ \ \ \ \ Degree\ tYaw;}
\DoxyCodeLine{00950\ \ \ \ \ \ \ \ \ tBitStream.Read(tYaw);}
\DoxyCodeLine{00951\ }
\DoxyCodeLine{00952\ \ \ \ \ \ \ \ \ tUnit-\/>setYaw(tYaw);}
\DoxyCodeLine{00953\ \ \ \ \ \}}
\DoxyCodeLine{00954\ \ \ \ \ \textcolor{keywordtype}{void}\ sendFaceDirection(\textcolor{keyword}{const}\ OwnerToken\ \&target=OwnerToken(TOKEN\_NULL))}
\DoxyCodeLine{00955\ \ \ \ \ \{}
\DoxyCodeLine{00956\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Degree\ tYaw\ =\ mUnitManager-\/>getPlayer()-\/>getYaw();}
\DoxyCodeLine{00957\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(target==TOKEN\_NULL)}
\DoxyCodeLine{00958\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00959\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(lastFaceDirection==tYaw)\textcolor{keywordflow}{return};}
\DoxyCodeLine{00960\ \ \ \ \ \ \ \ \ \ \ \ \ lastFaceDirection\ =\ tYaw;}
\DoxyCodeLine{00961\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00962\ }
\DoxyCodeLine{00963\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{00964\ }
\DoxyCodeLine{00965\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_FACEDIRECTION));}
\DoxyCodeLine{00966\ \ \ \ \ \ \ \ \ tBitStream.Write(target);}
\DoxyCodeLine{00967\ \ \ \ \ \ \ \ \ tBitStream.Write(tYaw);}
\DoxyCodeLine{00968\ }
\DoxyCodeLine{00969\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ LOW\_PRIORITY,\ UNRELIABLE\_SEQUENCED,\ 5,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{00970\ \ \ \ \ \}}
\DoxyCodeLine{00971\ \ \ \ \ \textcolor{keywordtype}{void}\ processActionFlags(Packet\ *p)}
\DoxyCodeLine{00972\ \ \ \ \ \{}
\DoxyCodeLine{00973\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream(p-\/>data,\ p-\/>length,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00974\ \ \ \ \ \ \ \ \ MessageID\ tID;}
\DoxyCodeLine{00975\ \ \ \ \ \ \ \ \ OwnerToken\ tToken;}
\DoxyCodeLine{00976\ }
\DoxyCodeLine{00977\ \ \ \ \ \ \ \ \ tBitStream.Read(tID);}
\DoxyCodeLine{00978\ \ \ \ \ \ \ \ \ tBitStream.Read(tToken);}
\DoxyCodeLine{00979\ }
\DoxyCodeLine{00980\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_magix_indexed_unit}{MagixIndexedUnit}}\ *tUnit\ =\ mUnitManager-\/>getUnitByIndex(tToken);}
\DoxyCodeLine{00981\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tUnit)\textcolor{keywordflow}{return};}
\DoxyCodeLine{00982\ }
\DoxyCodeLine{00983\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tHasFlags;}
\DoxyCodeLine{00984\ \ \ \ \ \ \ \ \ tBitStream.Read(tHasFlags);}
\DoxyCodeLine{00985\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tHasFlags)}
\DoxyCodeLine{00986\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00987\ \ \ \ \ \ \ \ \ \ \ \ \ std::bitset<3>\ tData;}
\DoxyCodeLine{00988\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i=0;i<(int)tData.size();i++)}
\DoxyCodeLine{00989\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00990\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tBool;}
\DoxyCodeLine{00991\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tBool);}
\DoxyCodeLine{00992\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tData[i]\ =\ tBool;}
\DoxyCodeLine{00993\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00994\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ tFlags\ =\ tData.to\_ulong();}
\DoxyCodeLine{00995\ }
\DoxyCodeLine{00996\ \ \ \ \ \ \ \ \ \ \ \ \ tUnit-\/>setAntiGravity(tFlags==1);}
\DoxyCodeLine{00997\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tFlags==2)tUnit-\/>doDoubleJump();}
\DoxyCodeLine{00998\ \ \ \ \ \ \ \ \ \ \ \ \ tUnit-\/>setJump(tFlags==3);}
\DoxyCodeLine{00999\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}((tFlags==4)!=tUnit-\/>getIsCrouching())tUnit-\/>doCrouch(tFlags==4);}
\DoxyCodeLine{01000\ \ \ \ \ \ \ \ \ \ \ \ \ tUnit-\/>setIsWalking(tFlags==5);}
\DoxyCodeLine{01001\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}((tFlags==6)!=tUnit-\/>getIsStance())tUnit-\/>toggleStance(mDef);}
\DoxyCodeLine{01002\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01003\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01004\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01005\ \ \ \ \ \ \ \ \ \ \ \ \ tUnit-\/>setAntiGravity(\textcolor{keyword}{false});}
\DoxyCodeLine{01006\ \ \ \ \ \ \ \ \ \ \ \ \ tUnit-\/>setJump(\textcolor{keyword}{false});}
\DoxyCodeLine{01007\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tUnit-\/>getIsCrouching())tUnit-\/>doCrouch(\textcolor{keyword}{false});}
\DoxyCodeLine{01008\ \ \ \ \ \ \ \ \ \ \ \ \ tUnit-\/>setIsWalking(\textcolor{keyword}{false});}
\DoxyCodeLine{01009\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tUnit-\/>getIsStance())tUnit-\/>toggleStance(mDef);}
\DoxyCodeLine{01010\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01011\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tHasPrimary;}
\DoxyCodeLine{01012\ \ \ \ \ \ \ \ \ tBitStream.Read(tHasPrimary);}
\DoxyCodeLine{01013\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tHasPrimary)}
\DoxyCodeLine{01014\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01015\ \ \ \ \ \ \ \ \ \ \ \ \ std::bitset<5>\ tData;}
\DoxyCodeLine{01016\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i=0;i<(int)tData.size();i++)}
\DoxyCodeLine{01017\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01018\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tBool;}
\DoxyCodeLine{01019\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tBool);}
\DoxyCodeLine{01020\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tData[i]\ =\ tBool;}
\DoxyCodeLine{01021\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01022\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ tPrimary\ =\ tData.to\_ulong();}
\DoxyCodeLine{01023\ }
\DoxyCodeLine{01024\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tPrimary==1)}
\DoxyCodeLine{01025\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01026\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tUnit-\/>isSitting())tUnit-\/>doSit();}
\DoxyCodeLine{01027\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01028\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(tPrimary==2)}
\DoxyCodeLine{01029\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01030\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tUnit-\/>isLaying())}
\DoxyCodeLine{01031\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01032\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tUnit-\/>isSitting())tUnit-\/>doSit(\textcolor{keyword}{true});}
\DoxyCodeLine{01033\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tUnit-\/>doSit();}
\DoxyCodeLine{01034\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01035\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01036\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(tPrimary==3)}
\DoxyCodeLine{01037\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01038\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tUnit-\/>isPlopped())}
\DoxyCodeLine{01039\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01040\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tUnit-\/>isLaying())}
\DoxyCodeLine{01041\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01042\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tUnit-\/>isSitting())tUnit-\/>doSit(\textcolor{keyword}{true});}
\DoxyCodeLine{01043\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tUnit-\/>doSit(\textcolor{keyword}{true});}
\DoxyCodeLine{01044\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01045\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tUnit-\/>doSit();}
\DoxyCodeLine{01046\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01047\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01048\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(tPrimary==4)}
\DoxyCodeLine{01049\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01050\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tUnit-\/>isSideLaying())}
\DoxyCodeLine{01051\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01052\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tUnit-\/>isSitting())tUnit-\/>doSit(\textcolor{keyword}{true});}
\DoxyCodeLine{01053\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tUnit-\/>doSideLay();}
\DoxyCodeLine{01054\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01055\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01056\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(tPrimary==5)}
\DoxyCodeLine{01057\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01058\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tUnit-\/>isLeaning())}
\DoxyCodeLine{01059\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01060\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tUnit-\/>isSideLaying())}
\DoxyCodeLine{01061\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01062\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tUnit-\/>isSitting())tUnit-\/>doSit(\textcolor{keyword}{true});}
\DoxyCodeLine{01063\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tUnit-\/>doSideLay(\textcolor{keyword}{true});}
\DoxyCodeLine{01064\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01065\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tUnit-\/>doSideLay();}
\DoxyCodeLine{01066\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01067\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01068\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(tPrimary==6)}
\DoxyCodeLine{01069\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01070\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tUnit-\/>isRolledOver())}
\DoxyCodeLine{01071\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01072\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tUnit-\/>isLeaning())}
\DoxyCodeLine{01073\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01074\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tUnit-\/>isSideLaying())}
\DoxyCodeLine{01075\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01076\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tUnit-\/>isSitting())tUnit-\/>doSit(\textcolor{keyword}{true});}
\DoxyCodeLine{01077\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tUnit-\/>doSideLay(\textcolor{keyword}{true});}
\DoxyCodeLine{01078\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01079\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tUnit-\/>doSideLay(\textcolor{keyword}{true});}
\DoxyCodeLine{01080\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01081\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tUnit-\/>doSideLay();}
\DoxyCodeLine{01082\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01083\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01084\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(tPrimary==7)tUnit-\/>doHeadswing();}
\DoxyCodeLine{01085\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(tPrimary==8)tUnit-\/>doHeadbang();}
\DoxyCodeLine{01086\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(tPrimary==9)tUnit-\/>doButtswing();}
\DoxyCodeLine{01087\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(tPrimary==10)tUnit-\/>doWingwave();}
\DoxyCodeLine{01088\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(tPrimary==11)tUnit-\/>doMoonwalk();}
\DoxyCodeLine{01089\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(tPrimary==12)tUnit-\/>doThriller();}
\DoxyCodeLine{01090\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(tPrimary==13)tUnit-\/>doPoint();}
\DoxyCodeLine{01091\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(tPrimary==14)tUnit-\/>doStretch();}
\DoxyCodeLine{01092\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(tPrimary==15)tUnit-\/>doRoar();}
\DoxyCodeLine{01093\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(tPrimary==16)tUnit-\/>doRofl();}
\DoxyCodeLine{01094\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(tPrimary==17)tUnit-\/>doCurl();}
\DoxyCodeLine{01095\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(tPrimary==18)tUnit-\/>doFaint();}
\DoxyCodeLine{01096\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01097\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tHasSecondary;}
\DoxyCodeLine{01098\ \ \ \ \ \ \ \ \ tBitStream.Read(tHasSecondary);}
\DoxyCodeLine{01099\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tHasSecondary)}
\DoxyCodeLine{01100\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01101\ \ \ \ \ \ \ \ \ \ \ \ \ std::bitset<4>\ tData;}
\DoxyCodeLine{01102\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i=0;i<(int)tData.size();i++)}
\DoxyCodeLine{01103\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01104\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tBool;}
\DoxyCodeLine{01105\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tBool);}
\DoxyCodeLine{01106\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tData[i]\ =\ tBool;}
\DoxyCodeLine{01107\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01108\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ tSecondary\ =\ tData.to\_ulong();}
\DoxyCodeLine{01109\ }
\DoxyCodeLine{01110\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tSecondary==1)tUnit-\/>doNodHead();}
\DoxyCodeLine{01111\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(tSecondary==2)tUnit-\/>doShakeHead();}
\DoxyCodeLine{01112\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(tSecondary==3)tUnit-\/>doNodHeadSlow();}
\DoxyCodeLine{01113\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(tSecondary==4)tUnit-\/>doShakeHeadSlow();}
\DoxyCodeLine{01114\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(tSecondary==5)tUnit-\/>doHeadTilt();}
\DoxyCodeLine{01115\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(tSecondary==8)tUnit-\/>doSniff();}
\DoxyCodeLine{01116\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(tSecondary==9)tUnit-\/>doTailFlick();}
\DoxyCodeLine{01117\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(tSecondary==10)tUnit-\/>doLaugh();}
\DoxyCodeLine{01118\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(tSecondary==11)tUnit-\/>doChuckle();}
\DoxyCodeLine{01119\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}((tSecondary==6)!=tUnit-\/>isLick())tUnit-\/>toggleLick();}
\DoxyCodeLine{01120\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}((tSecondary==7)!=tUnit-\/>isNuzzle())tUnit-\/>toggleNuzzle();}
\DoxyCodeLine{01121\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01122\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01123\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01124\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tUnit-\/>isLick())tUnit-\/>toggleLick();}
\DoxyCodeLine{01125\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tUnit-\/>isNuzzle())tUnit-\/>toggleNuzzle();}
\DoxyCodeLine{01126\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01127\ \ \ \ \ \}}
\DoxyCodeLine{01128\ \ \ \ \ \textcolor{keywordtype}{void}\ sendActionFlags(\textcolor{keyword}{const}\ OwnerToken\ \&target=OwnerToken(TOKEN\_NULL))}
\DoxyCodeLine{01129\ \ \ \ \ \{}
\DoxyCodeLine{01130\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Flags\ =\ 6}}
\DoxyCodeLine{01131\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ tFlags\ =\ 0;}
\DoxyCodeLine{01132\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>isAntiGravity())tFlags\ =\ 1;}
\DoxyCodeLine{01133\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>getHasDoubleJumped())tFlags\ =\ 2;}
\DoxyCodeLine{01134\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>getJump())tFlags\ =\ 3;}
\DoxyCodeLine{01135\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>getIsCrouching())tFlags\ =\ 4;}
\DoxyCodeLine{01136\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>getIsWalking())tFlags\ =\ 5;}
\DoxyCodeLine{01137\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>getIsStance())tFlags\ =\ 6;}
\DoxyCodeLine{01138\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Primary\ actions\ =\ 18}}
\DoxyCodeLine{01139\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ tPrimary\ =\ 0;}
\DoxyCodeLine{01140\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>isSitting())tPrimary\ =\ 1;}
\DoxyCodeLine{01141\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>isLaying())tPrimary\ =\ 2;}
\DoxyCodeLine{01142\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>isPlopped())tPrimary\ =\ 3;}
\DoxyCodeLine{01143\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>isSideLaying())tPrimary\ =\ 4;}
\DoxyCodeLine{01144\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>isLeaning())tPrimary\ =\ 5;}
\DoxyCodeLine{01145\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>isRolledOver())tPrimary\ =\ 6;}
\DoxyCodeLine{01146\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>isHeadswinging())tPrimary\ =\ 7;}
\DoxyCodeLine{01147\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>isHeadbanging())tPrimary\ =\ 8;}
\DoxyCodeLine{01148\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>isButtswinging())tPrimary\ =\ 9;}
\DoxyCodeLine{01149\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>isWingwaving())tPrimary\ =\ 10;}
\DoxyCodeLine{01150\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>isMoonwalking())tPrimary\ =\ 11;}
\DoxyCodeLine{01151\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>isThrillering())tPrimary\ =\ 12;}
\DoxyCodeLine{01152\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>isPoint())tPrimary\ =\ 13;}
\DoxyCodeLine{01153\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>isStretch())tPrimary\ =\ 14;}
\DoxyCodeLine{01154\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>isRoaring())tPrimary\ =\ 15;}
\DoxyCodeLine{01155\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>isRofling())tPrimary\ =\ 16;}
\DoxyCodeLine{01156\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>isCurled())tPrimary\ =\ 17;}
\DoxyCodeLine{01157\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>isFainting())tPrimary\ =\ 18;}
\DoxyCodeLine{01158\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Secondary\ actions\ =\ 11}}
\DoxyCodeLine{01159\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ tSecondary\ =\ 0;}
\DoxyCodeLine{01160\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>isNodHead())tSecondary\ =\ 1;}
\DoxyCodeLine{01161\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>isShakeHead())tSecondary\ =\ 2;}
\DoxyCodeLine{01162\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>isNodHeadSlow())tSecondary\ =\ 3;}
\DoxyCodeLine{01163\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>isShakeHeadSlow())tSecondary\ =\ 4;}
\DoxyCodeLine{01164\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>isHeadTilt())tSecondary\ =\ 5;}
\DoxyCodeLine{01165\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>isLick())tSecondary\ =\ 6;}
\DoxyCodeLine{01166\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>isNuzzle())tSecondary\ =\ 7;}
\DoxyCodeLine{01167\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>isSniff())tSecondary\ =\ 8;}
\DoxyCodeLine{01168\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>isTailFlick())tSecondary\ =\ 9;}
\DoxyCodeLine{01169\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>isLaugh())tSecondary\ =\ 10;}
\DoxyCodeLine{01170\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>isChuckle())tSecondary\ =\ 11;}
\DoxyCodeLine{01171\ }
\DoxyCodeLine{01172\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(target==TOKEN\_NULL)}
\DoxyCodeLine{01173\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01174\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tFlags==lastFlags\ \&\&\ tPrimary==lastPrimaryFlags\ \&\&\ tSecondary==lastSecondaryFlags)\textcolor{keywordflow}{return};}
\DoxyCodeLine{01175\ \ \ \ \ \ \ \ \ \ \ \ \ lastFlags\ =\ tFlags;}
\DoxyCodeLine{01176\ \ \ \ \ \ \ \ \ \ \ \ \ lastPrimaryFlags\ =\ tPrimary;}
\DoxyCodeLine{01177\ \ \ \ \ \ \ \ \ \ \ \ \ lastSecondaryFlags\ =\ tSecondary;}
\DoxyCodeLine{01178\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01179\ }
\DoxyCodeLine{01180\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{01181\ }
\DoxyCodeLine{01182\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_ACTIONFLAGS));}
\DoxyCodeLine{01183\ \ \ \ \ \ \ \ \ tBitStream.Write(target);}
\DoxyCodeLine{01184\ }
\DoxyCodeLine{01185\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Flags}}
\DoxyCodeLine{01186\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ tHasFlags\ =\ (tFlags>0);}
\DoxyCodeLine{01187\ \ \ \ \ \ \ \ \ tBitStream.Write(tHasFlags);}
\DoxyCodeLine{01188\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tHasFlags)}
\DoxyCodeLine{01189\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01190\ \ \ \ \ \ \ \ \ \ \ \ \ std::bitset<3>\ tData(tFlags);}
\DoxyCodeLine{01191\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i=0;i<(int)tData.size();i++)tBitStream.Write((\textcolor{keywordtype}{bool})tData[i]);}
\DoxyCodeLine{01192\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01193\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Primary\ actions}}
\DoxyCodeLine{01194\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ tHasPrimary\ =\ (tPrimary>0);}
\DoxyCodeLine{01195\ \ \ \ \ \ \ \ \ tBitStream.Write(tHasPrimary);}
\DoxyCodeLine{01196\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tHasPrimary)}
\DoxyCodeLine{01197\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01198\ \ \ \ \ \ \ \ \ \ \ \ \ std::bitset<5>\ tData(tPrimary);}
\DoxyCodeLine{01199\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i=0;i<(int)tData.size();i++)tBitStream.Write((\textcolor{keywordtype}{bool})tData[i]);}
\DoxyCodeLine{01200\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01201\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Secondary\ actions}}
\DoxyCodeLine{01202\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ tHasSecondary\ =\ (tSecondary>0);}
\DoxyCodeLine{01203\ \ \ \ \ \ \ \ \ tBitStream.Write(tHasSecondary);}
\DoxyCodeLine{01204\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tHasSecondary)}
\DoxyCodeLine{01205\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01206\ \ \ \ \ \ \ \ \ \ \ \ \ std::bitset<4>\ tData(tSecondary);}
\DoxyCodeLine{01207\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i=0;i<(int)tData.size();i++)tBitStream.Write((\textcolor{keywordtype}{bool})tData[i]);}
\DoxyCodeLine{01208\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01209\ }
\DoxyCodeLine{01210\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ LOW\_PRIORITY,\ UNRELIABLE\_SEQUENCED,\ 5,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{01211\ \ \ \ \ \}}
\DoxyCodeLine{01212\ \ \ \ \ \textcolor{keywordtype}{void}\ processEmote(Packet\ *p)}
\DoxyCodeLine{01213\ \ \ \ \ \{}
\DoxyCodeLine{01214\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream(p-\/>data,\ p-\/>length,\ \textcolor{keyword}{false});}
\DoxyCodeLine{01215\ \ \ \ \ \ \ \ \ MessageID\ tID;}
\DoxyCodeLine{01216\ \ \ \ \ \ \ \ \ OwnerToken\ tToken;}
\DoxyCodeLine{01217\ }
\DoxyCodeLine{01218\ \ \ \ \ \ \ \ \ tBitStream.Read(tID);}
\DoxyCodeLine{01219\ \ \ \ \ \ \ \ \ tBitStream.Read(tToken);}
\DoxyCodeLine{01220\ }
\DoxyCodeLine{01221\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_magix_indexed_unit}{MagixIndexedUnit}}\ *tUnit\ =\ mUnitManager-\/>getUnitByIndex(tToken);}
\DoxyCodeLine{01222\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tUnit)\textcolor{keywordflow}{return};}
\DoxyCodeLine{01223\ }
\DoxyCodeLine{01224\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ tEmote[32];}
\DoxyCodeLine{01225\ \ \ \ \ \ \ \ \ stringCompressor-\/>DecodeString(tEmote,32,\&tBitStream);}
\DoxyCodeLine{01226\ }
\DoxyCodeLine{01227\ \ \ \ \ \ \ \ \ tUnit-\/>setEmote(String(tEmote),mDef);}
\DoxyCodeLine{01228\ \ \ \ \ \}}
\DoxyCodeLine{01229\ \ \ \ \ \textcolor{keywordtype}{void}\ sendEmote(\textcolor{keyword}{const}\ String\ \&emote)}
\DoxyCodeLine{01230\ \ \ \ \ \{}
\DoxyCodeLine{01231\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{01232\ }
\DoxyCodeLine{01233\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_EMOTE));}
\DoxyCodeLine{01234\ \ \ \ \ \ \ \ \ tBitStream.Write(OwnerToken(TOKEN\_NULL));}
\DoxyCodeLine{01235\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(emote.c\_str(),32,\&tBitStream);}
\DoxyCodeLine{01236\ }
\DoxyCodeLine{01237\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ MEDIUM\_PRIORITY,\ UNRELIABLE,\ 0,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{01238\ \ \ \ \ \}}
\DoxyCodeLine{01239\ \ \ \ \ \textcolor{keywordtype}{void}\ processAndSendNewPlayerUpdate(Packet\ *p)}
\DoxyCodeLine{01240\ \ \ \ \ \{}
\DoxyCodeLine{01241\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream(p-\/>data,\ p-\/>length,\ \textcolor{keyword}{false});}
\DoxyCodeLine{01242\ \ \ \ \ \ \ \ \ MessageID\ tID;}
\DoxyCodeLine{01243\ \ \ \ \ \ \ \ \ OwnerToken\ tToken;}
\DoxyCodeLine{01244\ }
\DoxyCodeLine{01245\ \ \ \ \ \ \ \ \ tBitStream.Read(tID);}
\DoxyCodeLine{01246\ \ \ \ \ \ \ \ \ tBitStream.Read(tToken);}
\DoxyCodeLine{01247\ }
\DoxyCodeLine{01248\ \ \ \ \ \ \ \ \ sendNewPlayerProcedure(tToken);}
\DoxyCodeLine{01249\ \ \ \ \ \ \ \ \ sendMyCritters(tToken);}
\DoxyCodeLine{01250\ \ \ \ \ \ \ \ \ sendLookQuaternion(tToken);}
\DoxyCodeLine{01251\ \ \ \ \ \ \ \ \ sendFaceDirection(tToken);}
\DoxyCodeLine{01252\ \ \ \ \ \ \ \ \ sendActionFlags(tToken);}
\DoxyCodeLine{01253\ \ \ \ \ \}}
\DoxyCodeLine{01254\ \ \ \ \ \textcolor{keywordtype}{void}\ sendNewPlayerProcedure(\textcolor{keyword}{const}\ OwnerToken\ \&target=OwnerToken(TOKEN\_NULL))}
\DoxyCodeLine{01255\ \ \ \ \ \{}
\DoxyCodeLine{01256\ \ \ \ \ \ \ \ \ sendNewPlayer(target);}
\DoxyCodeLine{01257\ \ \ \ \ \ \ \ \ sendPosition(target);}
\DoxyCodeLine{01258\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i=0;i<MAX\_EQUIP;i++)}
\DoxyCodeLine{01259\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>getEquip(i)!=\textcolor{stringliteral}{"{}"{}})sendItemEquip(mUnitManager-\/>getPlayer()-\/>getEquip(i),i,target,\textcolor{keyword}{true});}
\DoxyCodeLine{01260\ \ \ \ \ \ \ \ \ sendPlayerUpdate(target);}
\DoxyCodeLine{01261\ \ \ \ \ \}}
\DoxyCodeLine{01262\ \ \ \ \ \textcolor{keywordtype}{void}\ sendNewPlayerAloneProcedure()}
\DoxyCodeLine{01263\ \ \ \ \ \{}
\DoxyCodeLine{01264\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i=0;i<MAX\_EQUIP;i++)}
\DoxyCodeLine{01265\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>getEquip(i)!=\textcolor{stringliteral}{"{}"{}})sendItemEquip(mUnitManager-\/>getPlayer()-\/>getEquip(i),i,\textcolor{keyword}{true});}
\DoxyCodeLine{01266\ \ \ \ \ \}}
\DoxyCodeLine{01267\ \ \ \ \ \textcolor{keywordtype}{void}\ processPlayerDisconnected(Packet\ *p)}
\DoxyCodeLine{01268\ \ \ \ \ \{}
\DoxyCodeLine{01269\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream(p-\/>data,\ p-\/>length,\ \textcolor{keyword}{false});}
\DoxyCodeLine{01270\ \ \ \ \ \ \ \ \ MessageID\ tID;}
\DoxyCodeLine{01271\ \ \ \ \ \ \ \ \ OwnerToken\ tToken;}
\DoxyCodeLine{01272\ }
\DoxyCodeLine{01273\ \ \ \ \ \ \ \ \ tBitStream.Read(tID);}
\DoxyCodeLine{01274\ \ \ \ \ \ \ \ \ tBitStream.Read(tToken);}
\DoxyCodeLine{01275\ }
\DoxyCodeLine{01276\ \ \ \ \ \ \ \ \ disownCritters(tToken);}
\DoxyCodeLine{01277\ }
\DoxyCodeLine{01278\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_magix_indexed_unit}{MagixIndexedUnit}}\ *tUnit\ =\ mUnitManager-\/>getUnitByIndex(tToken);}
\DoxyCodeLine{01279\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tUnit)\textcolor{keywordflow}{return};}
\DoxyCodeLine{01280\ }
\DoxyCodeLine{01281\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tIsProper;}
\DoxyCodeLine{01282\ \ \ \ \ \ \ \ \ tBitStream.Read(tIsProper);}
\DoxyCodeLine{01283\ }
\DoxyCodeLine{01284\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ String\ tName\ =\ (tUnit-\/>getUser()==\textcolor{stringliteral}{"{}"{}}?tUnit-\/>getName():tUnit-\/>getUser());}
\DoxyCodeLine{01285\ \ \ \ \ \ \ \ \ mChatManager-\/>message(tName\ +\ (tIsProper?\textcolor{stringliteral}{"{}\ has\ disconnected."{}}:\textcolor{stringliteral}{"{}\ timed\ out."{}}),(mUnitManager-\/>isPartyMember(tUnit)?0:(mChatManager-\/>getChannel()==0?CHAT\_LOCAL:CHAT\_GENERAL)));}
\DoxyCodeLine{01286\ \ \ \ \ \ \ \ \ mUnitManager-\/>deleteUnit(tUnit);}
\DoxyCodeLine{01287\ \ \ \ \ \}}
\DoxyCodeLine{01288\ \ \ \ \ \textcolor{keywordtype}{void}\ processWorldInfo(Packet\ *p)}
\DoxyCodeLine{01289\ \ \ \ \ \{}
\DoxyCodeLine{01290\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream(p-\/>data,\ p-\/>length,\ \textcolor{keyword}{false});}
\DoxyCodeLine{01291\ \ \ \ \ \ \ \ \ MessageID\ tID;}
\DoxyCodeLine{01292\ \ \ \ \ \ \ \ \ OwnerToken\ tToken;}
\DoxyCodeLine{01293\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tHasOtherPlayers;}
\DoxyCodeLine{01294\ \ \ \ \ \ \ \ \ \textcolor{comment}{//float\ tDayTime\ =\ mSkyManager-\/>getDayTime();}}
\DoxyCodeLine{01295\ \ \ \ \ \ \ \ \ \textcolor{comment}{//float\ tWeatherTime\ =\ mSkyManager-\/>getWeatherTime();}}
\DoxyCodeLine{01296\ }
\DoxyCodeLine{01297\ \ \ \ \ \ \ \ \ tBitStream.Read(tID);}
\DoxyCodeLine{01298\ \ \ \ \ \ \ \ \ tBitStream.Read(tToken);}
\DoxyCodeLine{01299\ \ \ \ \ \ \ \ \ tBitStream.Read(tHasOtherPlayers);}
\DoxyCodeLine{01300\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*if(tHasOtherPlayers)}}
\DoxyCodeLine{01301\ \textcolor{comment}{\ \ \ \ \ \ \ \ \{}}
\DoxyCodeLine{01302\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tDayTime);}}
\DoxyCodeLine{01303\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tWeatherTime);}}
\DoxyCodeLine{01304\ \textcolor{comment}{}}
\DoxyCodeLine{01305\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ mSkyManager-\/>setDayTime(tDayTime);}}
\DoxyCodeLine{01306\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ mSkyManager-\/>setWeatherTime(tWeatherTime);}}
\DoxyCodeLine{01307\ \textcolor{comment}{\ \ \ \ \ \ \ \ \}*/}}
\DoxyCodeLine{01308\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Stop\ here\ if\ we've\ already\ sent\ update}}
\DoxyCodeLine{01309\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(sentPlayerUpdate)\textcolor{keywordflow}{return};}
\DoxyCodeLine{01310\ }
\DoxyCodeLine{01311\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tHasOtherPlayers)}
\DoxyCodeLine{01312\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01313\ \ \ \ \ \ \ \ \ \ \ \ \ mUnitManager-\/>reclampAllUnitsToTerrain();}
\DoxyCodeLine{01314\ \ \ \ \ \ \ \ \ \ \ \ \ sendNewPlayerProcedure();}
\DoxyCodeLine{01315\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01316\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01317\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01318\ \ \ \ \ \ \ \ \ \ \ \ \ sendNewPlayerAloneProcedure();}
\DoxyCodeLine{01319\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01320\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>hasPet())}
\DoxyCodeLine{01321\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01322\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_critter}{Critter}}\ tC\ =\ mDef-\/>getCritter(mUnitManager-\/>getPlayer()-\/>getPet());}
\DoxyCodeLine{01323\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Vector3\ tPosition\ =\ mUnitManager-\/>getPlayer()-\/>getPosition()\ +\ Vector3(Math::RangeRandom(-\/20,20),tC.flying?15:0,-\/25);}
\DoxyCodeLine{01324\ \ \ \ \ \ \ \ \ \ \ \ \ sendCritterCreate(tC.type,tPosition,\textcolor{keyword}{true});}
\DoxyCodeLine{01325\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01326\ \ \ \ \ \ \ \ \ sendImReady();}
\DoxyCodeLine{01327\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!acceptedFlag)mGameStateManager-\/>setGameState(GAMESTATE\_STARTGAME);}
\DoxyCodeLine{01328\ \ \ \ \ \ \ \ \ acceptedFlag\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01329\ \ \ \ \ \ \ \ \ sentPlayerUpdate\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01330\ \ \ \ \ \ \ \ \ updateCount\ =\ 1;}
\DoxyCodeLine{01331\ }
\DoxyCodeLine{01332\ \ \ \ \ \ \ \ \ countsIntoGame\ =\ 0;}
\DoxyCodeLine{01333\ \ \ \ \ \}}
\DoxyCodeLine{01334\ \ \ \ \ \textcolor{keywordtype}{void}\ processAndSendMapInfo(Packet\ *p)}
\DoxyCodeLine{01335\ \ \ \ \ \{}
\DoxyCodeLine{01336\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tReceiveBit(p-\/>data,\ p-\/>length,\ \textcolor{keyword}{false});}
\DoxyCodeLine{01337\ \ \ \ \ \ \ \ \ MessageID\ tID;}
\DoxyCodeLine{01338\ \ \ \ \ \ \ \ \ OwnerToken\ tToken;}
\DoxyCodeLine{01339\ }
\DoxyCodeLine{01340\ \ \ \ \ \ \ \ \ tReceiveBit.Read(tID);}
\DoxyCodeLine{01341\ \ \ \ \ \ \ \ \ tReceiveBit.Read(tToken);}
\DoxyCodeLine{01342\ }
\DoxyCodeLine{01343\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*RakNet::BitStream\ tBitStream;}}
\DoxyCodeLine{01344\ \textcolor{comment}{}}
\DoxyCodeLine{01345\ \textcolor{comment}{\ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_WORLDINFO));}}
\DoxyCodeLine{01346\ \textcolor{comment}{\ \ \ \ \ \ \ \ tBitStream.Write(tToken);}}
\DoxyCodeLine{01347\ \textcolor{comment}{\ \ \ \ \ \ \ \ tBitStream.Write(true);}}
\DoxyCodeLine{01348\ \textcolor{comment}{\ \ \ \ \ \ \ \ tBitStream.Write(float(mSkyManager-\/>getDayTime()));}}
\DoxyCodeLine{01349\ \textcolor{comment}{\ \ \ \ \ \ \ \ tBitStream.Write(float(mSkyManager-\/>getWeatherTime()));}}
\DoxyCodeLine{01350\ \textcolor{comment}{}}
\DoxyCodeLine{01351\ \textcolor{comment}{\ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ HIGH\_PRIORITY,\ RELIABLE,\ 1,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ true);*/}}
\DoxyCodeLine{01352\ }
\DoxyCodeLine{01353\ \ \ \ \ \ \ \ \ sendAllItems(tToken);}
\DoxyCodeLine{01354\ \ \ \ \ \}}
\DoxyCodeLine{01355\ \ \ \ \ \textcolor{keywordtype}{void}\ processAttack(Packet\ *p)}
\DoxyCodeLine{01356\ \ \ \ \ \{}
\DoxyCodeLine{01357\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream(p-\/>data,\ p-\/>length,\ \textcolor{keyword}{false});}
\DoxyCodeLine{01358\ \ \ \ \ \ \ \ \ MessageID\ tID;}
\DoxyCodeLine{01359\ \ \ \ \ \ \ \ \ OwnerToken\ tToken;}
\DoxyCodeLine{01360\ }
\DoxyCodeLine{01361\ \ \ \ \ \ \ \ \ tBitStream.Read(tID);}
\DoxyCodeLine{01362\ \ \ \ \ \ \ \ \ tBitStream.Read(tToken);}
\DoxyCodeLine{01363\ }
\DoxyCodeLine{01364\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_magix_indexed_unit}{MagixIndexedUnit}}\ *tUnit\ =\ mUnitManager-\/>getUnitByIndex(tToken);}
\DoxyCodeLine{01365\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tUnit)\textcolor{keywordflow}{return};}
\DoxyCodeLine{01366\ }
\DoxyCodeLine{01367\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ tAttack[32];}
\DoxyCodeLine{01368\ \ \ \ \ \ \ \ \ stringCompressor-\/>DecodeString(tAttack,32,\&tBitStream);}
\DoxyCodeLine{01369\ }
\DoxyCodeLine{01370\ \ \ \ \ \ \ \ \ tUnit-\/>forceAttack(tAttack);}
\DoxyCodeLine{01371\ \ \ \ \ \}}
\DoxyCodeLine{01372\ \ \ \ \ \textcolor{keywordtype}{void}\ sendAttack(\textcolor{keyword}{const}\ String\ \&attack)}
\DoxyCodeLine{01373\ \ \ \ \ \{}
\DoxyCodeLine{01374\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{01375\ }
\DoxyCodeLine{01376\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_ATTACK));}
\DoxyCodeLine{01377\ \ \ \ \ \ \ \ \ tBitStream.Write(OwnerToken(TOKEN\_NULL));}
\DoxyCodeLine{01378\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(attack.c\_str(),32,\&tBitStream);}
\DoxyCodeLine{01379\ }
\DoxyCodeLine{01380\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ HIGH\_PRIORITY,\ UNRELIABLE,\ 0,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{01381\ \ \ \ \ \}}
\DoxyCodeLine{01382\ \ \ \ \ \textcolor{keywordtype}{void}\ processMapChange(Packet\ *p)}
\DoxyCodeLine{01383\ \ \ \ \ \{}
\DoxyCodeLine{01384\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream(p-\/>data,\ p-\/>length,\ \textcolor{keyword}{false});}
\DoxyCodeLine{01385\ \ \ \ \ \ \ \ \ MessageID\ tID;}
\DoxyCodeLine{01386\ \ \ \ \ \ \ \ \ OwnerToken\ tToken;}
\DoxyCodeLine{01387\ }
\DoxyCodeLine{01388\ \ \ \ \ \ \ \ \ tBitStream.Read(tID);}
\DoxyCodeLine{01389\ \ \ \ \ \ \ \ \ tBitStream.Read(tToken);}
\DoxyCodeLine{01390\ }
\DoxyCodeLine{01391\ \ \ \ \ \ \ \ \ disownCritters(tToken);}
\DoxyCodeLine{01392\ }
\DoxyCodeLine{01393\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_magix_indexed_unit}{MagixIndexedUnit}}\ *tUnit\ =\ mUnitManager-\/>getUnitByIndex(tToken);}
\DoxyCodeLine{01394\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tUnit)\textcolor{keywordflow}{return};}
\DoxyCodeLine{01395\ }
\DoxyCodeLine{01396\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ String\ tName\ =\ (tUnit-\/>getUser()==\textcolor{stringliteral}{"{}"{}}?tUnit-\/>getName():tUnit-\/>getUser());}
\DoxyCodeLine{01397\ \ \ \ \ \ \ \ \ mChatManager-\/>message(tName\ +\ \textcolor{stringliteral}{"{}\ has\ left."{}},(mUnitManager-\/>isPartyMember(tUnit)?0:(mChatManager-\/>getChannel()==0?CHAT\_LOCAL:CHAT\_GENERAL)));}
\DoxyCodeLine{01398\ \ \ \ \ \ \ \ \ mUnitManager-\/>deleteUnit(tUnit);}
\DoxyCodeLine{01399\ \ \ \ \ \}}
\DoxyCodeLine{01400\ \ \ \ \ \textcolor{keywordtype}{void}\ sendMapChange(\textcolor{keyword}{const}\ String\ \&mapName,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ \&dimension)}
\DoxyCodeLine{01401\ \ \ \ \ \{}
\DoxyCodeLine{01402\ \ \ \ \ \ \ \ \ sentPlayerUpdate\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01403\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{01404\ }
\DoxyCodeLine{01405\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_PLAYERMAPCHANGE));}
\DoxyCodeLine{01406\ \ \ \ \ \ \ \ \ tBitStream.Write(OwnerToken(TOKEN\_NULL));}
\DoxyCodeLine{01407\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(mapName.c\_str(),32,\&tBitStream);}
\DoxyCodeLine{01408\ \ \ \ \ \ \ \ \ tBitStream.Write(dimension);}
\DoxyCodeLine{01409\ }
\DoxyCodeLine{01410\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ HIGH\_PRIORITY,\ RELIABLE,\ 0,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{01411\ \ \ \ \ \}}
\DoxyCodeLine{01412\ \ \ \ \ \textcolor{comment}{/*void\ processValidateName(Packet\ *p)}}
\DoxyCodeLine{01413\ \textcolor{comment}{\ \ \ \ \{}}
\DoxyCodeLine{01414\ \textcolor{comment}{\ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream(p-\/>data,\ p-\/>length,\ false);}}
\DoxyCodeLine{01415\ \textcolor{comment}{\ \ \ \ \ \ \ \ MessageID\ tID;}}
\DoxyCodeLine{01416\ \textcolor{comment}{\ \ \ \ \ \ \ \ OwnerToken\ tToken;}}
\DoxyCodeLine{01417\ \textcolor{comment}{\ \ \ \ \ \ \ \ char\ tNewName[32];}}
\DoxyCodeLine{01418\ \textcolor{comment}{}}
\DoxyCodeLine{01419\ \textcolor{comment}{\ \ \ \ \ \ \ \ tBitStream.Read(tID);}}
\DoxyCodeLine{01420\ \textcolor{comment}{\ \ \ \ \ \ \ \ tBitStream.Read(tToken);}}
\DoxyCodeLine{01421\ \textcolor{comment}{\ \ \ \ \ \ \ \ stringCompressor-\/>DecodeString(tNewName,32,\&tBitStream);}}
\DoxyCodeLine{01422\ \textcolor{comment}{}}
\DoxyCodeLine{01423\ \textcolor{comment}{\ \ \ \ \ \ \ \ mUnitManager-\/>createNameTag(mUnitManager-\/>getPlayer(),tNewName);}}
\DoxyCodeLine{01424\ \textcolor{comment}{\ \ \ \ \ \ \ \ mChatManager-\/>message("{}Name\ in\ use.\ Changed\ name\ to\ "{}\ +\ mUnitManager-\/>getPlayer()-\/>getName());}}
\DoxyCodeLine{01425\ \textcolor{comment}{\ \ \ \ \}*/}}
\DoxyCodeLine{01426\ \ \ \ \ \textcolor{keywordtype}{void}\ sendValidateName()}
\DoxyCodeLine{01427\ \ \ \ \ \{}
\DoxyCodeLine{01428\ \ \ \ \ \ \ \ \ \textcolor{comment}{//EASTER\ EGGS\ LOL}}
\DoxyCodeLine{01429\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i=0;i<MAX\_EQUIP;i++)}
\DoxyCodeLine{01430\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01431\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>getEquip(i)==\textcolor{stringliteral}{"{}Egg"{}})}
\DoxyCodeLine{01432\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01433\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mUnitManager-\/>unequipItem(mUnitManager-\/>getPlayer(),i);}
\DoxyCodeLine{01434\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mUnitManager-\/>equipItem(mUnitManager-\/>getPlayer(),\textcolor{stringliteral}{"{}collar3"{}},i);}
\DoxyCodeLine{01435\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mChatManager-\/>message(\textcolor{stringliteral}{"{}Your\ Red\ Easter\ Egg\ has\ hatched\ into\ a\ Spiked\ Collar!"{}});}
\DoxyCodeLine{01436\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sendItemEquip(\textcolor{stringliteral}{"{}collar3"{}},i);}
\DoxyCodeLine{01437\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01438\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>getEquip(i)==\textcolor{stringliteral}{"{}Egg2"{}})}
\DoxyCodeLine{01439\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01440\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mUnitManager-\/>unequipItem(mUnitManager-\/>getPlayer(),i);}
\DoxyCodeLine{01441\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mUnitManager-\/>equipItem(mUnitManager-\/>getPlayer(),\textcolor{stringliteral}{"{}bracelet1"{}},i);}
\DoxyCodeLine{01442\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mChatManager-\/>message(\textcolor{stringliteral}{"{}Your\ Blue\ Easter\ Egg\ has\ hatched\ into\ a\ Checkered\ Bracelet!"{}});}
\DoxyCodeLine{01443\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sendItemEquip(\textcolor{stringliteral}{"{}bracelet1"{}},i);}
\DoxyCodeLine{01444\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01445\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>getEquip(i)==\textcolor{stringliteral}{"{}Egg3"{}})}
\DoxyCodeLine{01446\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01447\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mUnitManager-\/>unequipItem(mUnitManager-\/>getPlayer(),i);}
\DoxyCodeLine{01448\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mUnitManager-\/>equipItem(mUnitManager-\/>getPlayer(),\textcolor{stringliteral}{"{}fangs"{}},i);}
\DoxyCodeLine{01449\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mChatManager-\/>message(\textcolor{stringliteral}{"{}Your\ Green\ Easter\ Egg\ has\ hatched\ into\ a\ pair\ of\ Fangs!"{}});}
\DoxyCodeLine{01450\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sendItemEquip(\textcolor{stringliteral}{"{}fangs"{}},i);}
\DoxyCodeLine{01451\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01452\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>getEquip(i)==\textcolor{stringliteral}{"{}Egg4"{}})}
\DoxyCodeLine{01453\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01454\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mUnitManager-\/>unequipItem(mUnitManager-\/>getPlayer(),i);}
\DoxyCodeLine{01455\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mUnitManager-\/>equipItem(mUnitManager-\/>getPlayer(),\textcolor{stringliteral}{"{}clawsL"{}},i);}
\DoxyCodeLine{01456\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{short}\ tNextSlot\ =\ mUnitManager-\/>getNextEmptyItemSlot(mUnitManager-\/>getPlayer());}
\DoxyCodeLine{01457\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tNextSlot>0)mUnitManager-\/>equipItem(mUnitManager-\/>getPlayer(),\textcolor{stringliteral}{"{}clawsR"{}},tNextSlot);}
\DoxyCodeLine{01458\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mChatManager-\/>message(\textcolor{stringliteral}{"{}Your\ Silver\ Easter\ Egg\ has\ hatched\ into\ two\ sets\ of\ claws!"{}});}
\DoxyCodeLine{01459\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sendItemEquip(\textcolor{stringliteral}{"{}clawsL"{}},i);}
\DoxyCodeLine{01460\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tNextSlot>0)sendItemEquip(\textcolor{stringliteral}{"{}clawsR"{}},i-\/1);}
\DoxyCodeLine{01461\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01462\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>getEquip(i)==\textcolor{stringliteral}{"{}Egg5"{}})}
\DoxyCodeLine{01463\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01464\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mUnitManager-\/>unequipItem(mUnitManager-\/>getPlayer(),i);}
\DoxyCodeLine{01465\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mUnitManager-\/>equipItem(mUnitManager-\/>getPlayer(),\textcolor{stringliteral}{"{}note"{}},i);}
\DoxyCodeLine{01466\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mChatManager-\/>message(\textcolor{stringliteral}{"{}Your\ Gold\ Easter\ Egg\ has\ hatched\ into...a\ piece\ of\ note?"{}});}
\DoxyCodeLine{01467\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sendItemEquip(\textcolor{stringliteral}{"{}note"{}},i);}
\DoxyCodeLine{01468\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01469\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01470\ }
\DoxyCodeLine{01471\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{01472\ }
\DoxyCodeLine{01473\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_VALIDATENAME));}
\DoxyCodeLine{01474\ \ \ \ \ \ \ \ \ tBitStream.Write(OwnerToken(mUnitManager-\/>getPlayer()-\/>getIndex()));}
\DoxyCodeLine{01475\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(mUnitManager-\/>getPlayer()-\/>getUser().c\_str(),16,\&tBitStream);}
\DoxyCodeLine{01476\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(mWorld-\/>getWorldName().c\_str(),32,\&tBitStream);}
\DoxyCodeLine{01477\ \ \ \ \ \ \ \ \ \textcolor{comment}{//tBitStream.Write((unsigned\ short)mCharScreenManager-\/>getCharID());}}
\DoxyCodeLine{01478\ \ \ \ \ \ \ \ \ tBitStream.Write(mGameStateManager-\/>getDimension());}
\DoxyCodeLine{01479\ }
\DoxyCodeLine{01480\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ HIGH\_PRIORITY,\ RELIABLE,\ 1,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{01481\ \ \ \ \ \}}
\DoxyCodeLine{01482\ \ \ \ \ \textcolor{keywordtype}{void}\ processPlayerData(Packet\ *p)}
\DoxyCodeLine{01483\ \ \ \ \ \{}
\DoxyCodeLine{01484\ \ \ \ \ \ \ \ \ playerListUpdated\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{01485\ }
\DoxyCodeLine{01486\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream(p-\/>data,\ p-\/>length,\ \textcolor{keyword}{false});}
\DoxyCodeLine{01487\ \ \ \ \ \ \ \ \ MessageID\ tID;}
\DoxyCodeLine{01488\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tArrive;}
\DoxyCodeLine{01489\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ tName[16];}
\DoxyCodeLine{01490\ }
\DoxyCodeLine{01491\ \ \ \ \ \ \ \ \ tBitStream.Read(tID);}
\DoxyCodeLine{01492\ \ \ \ \ \ \ \ \ tBitStream.Read(tArrive);}
\DoxyCodeLine{01493\ \ \ \ \ \ \ \ \ stringCompressor-\/>DecodeString(tName,16,\&tBitStream);}
\DoxyCodeLine{01494\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tArrive)}
\DoxyCodeLine{01495\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01496\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ tMapName[32];}
\DoxyCodeLine{01497\ \ \ \ \ \ \ \ \ \ \ \ \ stringCompressor-\/>DecodeString(tMapName,32,\&tBitStream);}
\DoxyCodeLine{01498\ }
\DoxyCodeLine{01499\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(vector<PlayerData>::type::iterator\ it=playerList.begin();\ it!=playerList.end();\ it++)}
\DoxyCodeLine{01500\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01501\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_player_data}{PlayerData}}\ *tData\ =\ \&*it;}
\DoxyCodeLine{01502\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tData-\/>name\ ==\ tName)}
\DoxyCodeLine{01503\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01504\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tData-\/>mapName\ =\ tMapName;}
\DoxyCodeLine{01505\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01506\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01507\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01508\ \ \ \ \ \ \ \ \ \ \ \ \ playerList.push\_back(\mbox{\hyperlink{struct_player_data}{PlayerData}}(tName,tMapName));}
\DoxyCodeLine{01509\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{01510\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01511\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01512\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01513\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(vector<PlayerData>::type::iterator\ it=playerList.begin();\ it!=playerList.end();\ it++)}
\DoxyCodeLine{01514\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01515\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_player_data}{PlayerData}}\ *tData\ =\ \&*it;}
\DoxyCodeLine{01516\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tData-\/>name\ ==\ tName)}
\DoxyCodeLine{01517\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01518\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ playerList.erase(it);}
\DoxyCodeLine{01519\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{01520\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01521\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01522\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(mUnitManager-\/>removePartyMember(tName))mChatManager-\/>message(\textcolor{stringliteral}{"{}Party\ Member\ "{}}+String(tName)+\textcolor{stringliteral}{"{}\ has\ disconnected."{}},CHAT\_PARTY);}
\DoxyCodeLine{01523\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01524\ \ \ \ \ \}}
\DoxyCodeLine{01525\ \ \ \ \ \textcolor{keywordtype}{bool}\ popPlayerListUpdated()}
\DoxyCodeLine{01526\ \ \ \ \ \{}
\DoxyCodeLine{01527\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ tFlag\ =\ playerListUpdated;}
\DoxyCodeLine{01528\ \ \ \ \ \ \ \ \ playerListUpdated\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01529\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ tFlag;}
\DoxyCodeLine{01530\ \ \ \ \ \}}
\DoxyCodeLine{01531\ \ \ \ \ \textcolor{keywordtype}{void}\ processBio(Packet\ *p)}
\DoxyCodeLine{01532\ \ \ \ \ \{}
\DoxyCodeLine{01533\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream(p-\/>data,\ p-\/>length,\ \textcolor{keyword}{false});}
\DoxyCodeLine{01534\ \ \ \ \ \ \ \ \ MessageID\ tID;}
\DoxyCodeLine{01535\ \ \ \ \ \ \ \ \ OwnerToken\ tToken;}
\DoxyCodeLine{01536\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tIsRequest;}
\DoxyCodeLine{01537\ }
\DoxyCodeLine{01538\ \ \ \ \ \ \ \ \ tBitStream.Read(tID);}
\DoxyCodeLine{01539\ \ \ \ \ \ \ \ \ tBitStream.Read(tToken);}
\DoxyCodeLine{01540\ \ \ \ \ \ \ \ \ tBitStream.Read(tIsRequest);}
\DoxyCodeLine{01541\ }
\DoxyCodeLine{01542\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tIsRequest)}
\DoxyCodeLine{01543\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01544\ \ \ \ \ \ \ \ \ \ \ \ \ RakNet::BitStream\ tSendStream;}
\DoxyCodeLine{01545\ }
\DoxyCodeLine{01546\ \ \ \ \ \ \ \ \ \ \ \ \ tSendStream.Write(MessageID(ID\_BIO));}
\DoxyCodeLine{01547\ \ \ \ \ \ \ \ \ \ \ \ \ tSendStream.Write(tToken);}
\DoxyCodeLine{01548\ \ \ \ \ \ \ \ \ \ \ \ \ tSendStream.Write(\textcolor{keyword}{false});}
\DoxyCodeLine{01549\ \ \ \ \ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(mDef-\/>loadBio().c\_str(),512,\&tSendStream);}
\DoxyCodeLine{01550\ }
\DoxyCodeLine{01551\ \ \ \ \ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tSendStream,\ LOW\_PRIORITY,\ UNRELIABLE,\ 0,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{01552\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01553\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{01554\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01555\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ tBio[512];}
\DoxyCodeLine{01556\ \ \ \ \ \ \ \ \ \ \ \ \ stringCompressor-\/>DecodeString(tBio,512,\&tBitStream);}
\DoxyCodeLine{01557\ }
\DoxyCodeLine{01558\ \ \ \ \ \ \ \ \ \ \ \ \ targetBioUpdated\ =\ tBio;}
\DoxyCodeLine{01559\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(targetBioUpdated==\textcolor{stringliteral}{"{}"{}})targetBioUpdated\ =\ \textcolor{stringliteral}{"{}None"{}};}
\DoxyCodeLine{01560\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01561\ \ \ \ \ \}}
\DoxyCodeLine{01562\ \ \ \ \ \textcolor{keywordtype}{void}\ sendBioRequest(\textcolor{keyword}{const}\ String\ \&name)}
\DoxyCodeLine{01563\ \ \ \ \ \{}
\DoxyCodeLine{01564\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{01565\ }
\DoxyCodeLine{01566\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_BIO));}
\DoxyCodeLine{01567\ \ \ \ \ \ \ \ \ tBitStream.Write(OwnerToken(TOKEN\_NULL));}
\DoxyCodeLine{01568\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{true});}
\DoxyCodeLine{01569\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(name.c\_str(),32,\&tBitStream);}
\DoxyCodeLine{01570\ }
\DoxyCodeLine{01571\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ LOW\_PRIORITY,\ UNRELIABLE,\ 0,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{01572\ \ \ \ \ \}}
\DoxyCodeLine{01573\ \ \ \ \ \textcolor{keyword}{const}\ String\ popTargetBioUpdated()}
\DoxyCodeLine{01574\ \ \ \ \ \{}
\DoxyCodeLine{01575\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ String\ tBio\ =\ targetBioUpdated;}
\DoxyCodeLine{01576\ \ \ \ \ \ \ \ \ targetBioUpdated\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{01577\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ tBio;}
\DoxyCodeLine{01578\ \ \ \ \ \}}
\DoxyCodeLine{01579\ \ \ \ \ \textcolor{keywordtype}{void}\ sendCreateAccount(\textcolor{keyword}{const}\ String\ \&arg1,\ \textcolor{keyword}{const}\ String\ \&arg2,\ \textcolor{keyword}{const}\ String\ \&arg3,\ \textcolor{keyword}{const}\ String\ \&arg4,\ \textcolor{keyword}{const}\ String\ \&arg5)}
\DoxyCodeLine{01580\ \ \ \ \ \{}
\DoxyCodeLine{01581\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{01582\ }
\DoxyCodeLine{01583\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_CREATEACCOUNT));}
\DoxyCodeLine{01584\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(arg1.c\_str(),16,\&tBitStream);}
\DoxyCodeLine{01585\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(arg2.c\_str(),16,\&tBitStream);}
\DoxyCodeLine{01586\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(arg3.c\_str(),64,\&tBitStream);}
\DoxyCodeLine{01587\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(arg4.c\_str(),128,\&tBitStream);}
\DoxyCodeLine{01588\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(arg5.c\_str(),128,\&tBitStream);}
\DoxyCodeLine{01589\ }
\DoxyCodeLine{01590\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ HIGH\_PRIORITY,\ RELIABLE,\ 0,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{01591\ \ \ \ \ \}}
\DoxyCodeLine{01592\ \ \ \ \ \textcolor{keywordtype}{void}\ processCreateAccount(Packet\ *p)}
\DoxyCodeLine{01593\ \ \ \ \ \{}
\DoxyCodeLine{01594\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!isMainServerConnection)\textcolor{keywordflow}{return};}
\DoxyCodeLine{01595\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream(p-\/>data,\ p-\/>length,\ \textcolor{keyword}{false});}
\DoxyCodeLine{01596\ \ \ \ \ \ \ \ \ MessageID\ tID;}
\DoxyCodeLine{01597\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tSuccess;}
\DoxyCodeLine{01598\ }
\DoxyCodeLine{01599\ \ \ \ \ \ \ \ \ tBitStream.Read(tID);}
\DoxyCodeLine{01600\ \ \ \ \ \ \ \ \ tBitStream.Read(tSuccess);}
\DoxyCodeLine{01601\ \ \ \ \ \ \ \ \ networkMessage\ =\ \mbox{\hyperlink{struct_network_message}{NetworkMessage}}(tSuccess?NETWORK\_CREATEACCOUNTSUCCESS:NETWORK\_CREATEACCOUNTFAIL);}
\DoxyCodeLine{01602\ \ \ \ \ \}}
\DoxyCodeLine{01603\ \ \ \ \ \textcolor{keywordtype}{void}\ sendEditAccount(\textcolor{keyword}{const}\ String\ \&arg1,\ \textcolor{keyword}{const}\ String\ \&arg2,\ \textcolor{keyword}{const}\ String\ \&arg3)}
\DoxyCodeLine{01604\ \ \ \ \ \{}
\DoxyCodeLine{01605\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{01606\ }
\DoxyCodeLine{01607\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_EDITACCOUNT));}
\DoxyCodeLine{01608\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(arg1.c\_str(),16,\&tBitStream);}
\DoxyCodeLine{01609\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(arg2.c\_str(),16,\&tBitStream);}
\DoxyCodeLine{01610\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(arg3.c\_str(),16,\&tBitStream);}
\DoxyCodeLine{01611\ }
\DoxyCodeLine{01612\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ HIGH\_PRIORITY,\ RELIABLE\_SEQUENCED,\ 0,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{01613\ \ \ \ \ \}}
\DoxyCodeLine{01614\ \ \ \ \ \textcolor{keywordtype}{void}\ processEditAccount(Packet\ *p)}
\DoxyCodeLine{01615\ \ \ \ \ \{}
\DoxyCodeLine{01616\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!isMainServerConnection)\textcolor{keywordflow}{return};}
\DoxyCodeLine{01617\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream(p-\/>data,\ p-\/>length,\ \textcolor{keyword}{false});}
\DoxyCodeLine{01618\ \ \ \ \ \ \ \ \ MessageID\ tID;}
\DoxyCodeLine{01619\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tSuccess;}
\DoxyCodeLine{01620\ }
\DoxyCodeLine{01621\ \ \ \ \ \ \ \ \ tBitStream.Read(tID);}
\DoxyCodeLine{01622\ \ \ \ \ \ \ \ \ tBitStream.Read(tSuccess);}
\DoxyCodeLine{01623\ \ \ \ \ \ \ \ \ networkMessage\ =\ \mbox{\hyperlink{struct_network_message}{NetworkMessage}}(tSuccess?NETWORK\_EDITACCOUNTSUCCESS:NETWORK\_EDITACCOUNTFAIL);}
\DoxyCodeLine{01624\ \ \ \ \ \}}
\DoxyCodeLine{01625\ \ \ \ \ \textcolor{keywordtype}{void}\ sendLogon(\textcolor{keyword}{const}\ String\ \&arg1,\ \textcolor{keyword}{const}\ String\ \&arg2)}
\DoxyCodeLine{01626\ \ \ \ \ \{}
\DoxyCodeLine{01627\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{01628\ }
\DoxyCodeLine{01629\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_LOGON));}
\DoxyCodeLine{01630\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(arg1.c\_str(),16,\&tBitStream);}
\DoxyCodeLine{01631\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(arg2.c\_str(),16,\&tBitStream);}
\DoxyCodeLine{01632\ }
\DoxyCodeLine{01633\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ HIGH\_PRIORITY,\ RELIABLE,\ 0,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{01634\ \ \ \ \ \}}
\DoxyCodeLine{01635\ \ \ \ \ \textcolor{keywordtype}{void}\ processLogon(Packet\ *p)}
\DoxyCodeLine{01636\ \ \ \ \ \{}
\DoxyCodeLine{01637\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!isMainServerConnection)\textcolor{keywordflow}{return};}
\DoxyCodeLine{01638\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream(p-\/>data,\ p-\/>length,\ \textcolor{keyword}{false});}
\DoxyCodeLine{01639\ \ \ \ \ \ \ \ \ MessageID\ tID;}
\DoxyCodeLine{01640\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tSuccess;}
\DoxyCodeLine{01641\ }
\DoxyCodeLine{01642\ \ \ \ \ \ \ \ \ tBitStream.Read(tID);}
\DoxyCodeLine{01643\ \ \ \ \ \ \ \ \ tBitStream.Read(tSuccess);}
\DoxyCodeLine{01644\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tSuccess)}
\DoxyCodeLine{01645\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01646\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{short}\ tNumChars\ =\ 0;}
\DoxyCodeLine{01647\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tNumChars);}
\DoxyCodeLine{01648\ \ \ \ \ \ \ \ \ \ \ \ \ mCharScreenManager-\/>setNumChars(tNumChars);}
\DoxyCodeLine{01649\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01650\ \ \ \ \ \ \ \ \ networkMessage\ =\ \mbox{\hyperlink{struct_network_message}{NetworkMessage}}(tSuccess?NETWORK\_LOGONSUCCESS:NETWORK\_LOGONFAIL);}
\DoxyCodeLine{01651\ \ \ \ \ \}}
\DoxyCodeLine{01652\ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_network_message}{NetworkMessage}}\ popNetworkMessage()}
\DoxyCodeLine{01653\ \ \ \ \ \{}
\DoxyCodeLine{01654\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_network_message}{NetworkMessage}}\ tMessage\ =\ networkMessage;}
\DoxyCodeLine{01655\ \ \ \ \ \ \ \ \ networkMessage\ =\ \mbox{\hyperlink{struct_network_message}{NetworkMessage}}();}
\DoxyCodeLine{01656\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ tMessage;}
\DoxyCodeLine{01657\ \ \ \ \ \}}
\DoxyCodeLine{01658\ \ \ \ \ \textcolor{keywordtype}{void}\ processLoadChar(Packet\ *p)}
\DoxyCodeLine{01659\ \ \ \ \ \{}
\DoxyCodeLine{01660\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!isMainServerConnection)\textcolor{keywordflow}{return};}
\DoxyCodeLine{01661\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream(p-\/>data,\ p-\/>length,\ \textcolor{keyword}{false});}
\DoxyCodeLine{01662\ \ \ \ \ \ \ \ \ MessageID\ tID;}
\DoxyCodeLine{01663\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{short}\ tIndex;}
\DoxyCodeLine{01664\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tSuccess;}
\DoxyCodeLine{01665\ }
\DoxyCodeLine{01666\ \ \ \ \ \ \ \ \ tBitStream.Read(tID);}
\DoxyCodeLine{01667\ \ \ \ \ \ \ \ \ tBitStream.Read(tIndex);}
\DoxyCodeLine{01668\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tIndex!=mCharScreenManager-\/>getCharID())\textcolor{keywordflow}{return};}
\DoxyCodeLine{01669\ }
\DoxyCodeLine{01670\ \ \ \ \ \ \ \ \ tBitStream.Read(tSuccess);}
\DoxyCodeLine{01671\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tSuccess)}
\DoxyCodeLine{01672\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01673\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ tBuffer[512]\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{01674\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tIsAdmin\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01675\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tIsMod\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01676\ \ \ \ \ \ \ \ \ \ \ \ \ stringCompressor-\/>DecodeString(tBuffer,512,\&tBitStream);}
\DoxyCodeLine{01677\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tIsAdmin);}
\DoxyCodeLine{01678\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tIsMod);}
\DoxyCodeLine{01679\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i=0;i<MAX\_EQUIP;i++)mUnitManager-\/>unequipItem(mUnitManager-\/>getPlayer(),i);}
\DoxyCodeLine{01680\ \ \ \ \ \ \ \ \ \ \ \ \ mCharScreenManager-\/>updateChar(String(tBuffer));}
\DoxyCodeLine{01681\ \ \ \ \ \ \ \ \ \ \ \ \ mDef-\/>isAdmin\ =\ tIsAdmin;}
\DoxyCodeLine{01682\ \ \ \ \ \ \ \ \ \ \ \ \ mDef-\/>isMod\ =\ tIsMod;}
\DoxyCodeLine{01683\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tIsAdmin)}
\DoxyCodeLine{01684\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01685\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ tAdminColour[16];}
\DoxyCodeLine{01686\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stringCompressor-\/>DecodeString(tAdminColour,16,\&tBitStream);}
\DoxyCodeLine{01687\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mDef-\/>adminAuraColour\ =\ StringConverter::parseColourValue(String(tAdminColour));}
\DoxyCodeLine{01688\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mUnitManager-\/>createAdminAura(mUnitManager-\/>getPlayer(),mDef-\/>adminAuraColour);}
\DoxyCodeLine{01689\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01690\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tIsMod)mDef-\/>isModOn\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01691\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{01692\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Load\ Items}}
\DoxyCodeLine{01693\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ j=0;j<MAX\_EQUIP;j++)}
\DoxyCodeLine{01694\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01695\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tHasItem\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01696\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tHasItem);}
\DoxyCodeLine{01697\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tHasItem)}
\DoxyCodeLine{01698\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01699\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ tItem[16];}
\DoxyCodeLine{01700\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stringCompressor-\/>DecodeString(tItem,16,\&tBitStream);}
\DoxyCodeLine{01701\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mUnitManager-\/>equipItem(mUnitManager-\/>getPlayer(),String(tItem),j);}
\DoxyCodeLine{01702\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01703\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01704\ }
\DoxyCodeLine{01705\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Load\ HP}}
\DoxyCodeLine{01706\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tHasHP\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01707\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tHasHP);}
\DoxyCodeLine{01708\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tHasHP)}
\DoxyCodeLine{01709\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01710\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ tHP[16];}
\DoxyCodeLine{01711\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stringCompressor-\/>DecodeString(tHP,16,\&tBitStream);}
\DoxyCodeLine{01712\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ vector<String>::type\ tPart\ =\ StringUtil::split(tHP,\textcolor{stringliteral}{"{};\(\backslash\)n"{}});}
\DoxyCodeLine{01713\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ tMaxHP\ =\ StringConverter::parseInt(tPart[1]);}
\DoxyCodeLine{01714\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tPart.size()>1)mUnitManager-\/>getPlayer()-\/>setHP(tMaxHP==0?500:tMaxHP,0);}
\DoxyCodeLine{01715\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tPart.size()>0)mUnitManager-\/>getPlayer()-\/>addHP(StringConverter::parseInt(tPart[0]));}
\DoxyCodeLine{01716\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01717\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ mUnitManager-\/>getPlayer()-\/>setHP(500);}
\DoxyCodeLine{01718\ }
\DoxyCodeLine{01719\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Load\ Skills}}
\DoxyCodeLine{01720\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tHasSkills\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01721\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tHasSkills);}
\DoxyCodeLine{01722\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tHasSkills)}
\DoxyCodeLine{01723\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01724\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ tSkills[512];}
\DoxyCodeLine{01725\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stringCompressor-\/>DecodeString(tSkills,512,\&tBitStream);}
\DoxyCodeLine{01726\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ vector<String>::type\ tLine\ =\ StringUtil::split(tSkills,\textcolor{stringliteral}{"{}|\(\backslash\)n"{}});}
\DoxyCodeLine{01727\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i=0;i<(int)tLine.size();i++)}
\DoxyCodeLine{01728\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01729\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ vector<String>::type\ tPart\ =\ StringUtil::split(tLine[i],\textcolor{stringliteral}{"{};"{}});}
\DoxyCodeLine{01730\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tPart.size()==2)}
\DoxyCodeLine{01731\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01732\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mUnitManager-\/>getPlayer()-\/>addSkill(tPart[0],StringConverter::parseInt(tPart[1]));}
\DoxyCodeLine{01733\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01734\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01735\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01736\ }
\DoxyCodeLine{01737\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Load\ Pet}}
\DoxyCodeLine{01738\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tHasPet\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01739\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tHasPet);}
\DoxyCodeLine{01740\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tHasPet)}
\DoxyCodeLine{01741\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01742\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ tPet[512];}
\DoxyCodeLine{01743\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stringCompressor-\/>DecodeString(tPet,32,\&tBitStream);}
\DoxyCodeLine{01744\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mUnitManager-\/>getPlayer()-\/>setPet(tPet,mDef);}
\DoxyCodeLine{01745\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01746\ }
\DoxyCodeLine{01747\ \ \ \ \ \ \ \ \ \ \ \ \ mUnitManager-\/>getPlayer()-\/>resetChanges();}
\DoxyCodeLine{01748\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01749\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ mCharScreenManager-\/>updateChar(\textcolor{stringliteral}{"{}"{}});}
\DoxyCodeLine{01750\ \ \ \ \ \ \ \ \ mCharScreenManager-\/>refreshPage();}
\DoxyCodeLine{01751\ \ \ \ \ \ \ \ \ networkMessage\ =\ (tSuccess?NETWORK\_LOADCHARSUCCESS:NETWORK\_LOADCHARFAIL);}
\DoxyCodeLine{01752\ \ \ \ \ \}}
\DoxyCodeLine{01753\ \ \ \ \ \textcolor{keywordtype}{void}\ sendLoadChar(\textcolor{keyword}{const}\ String\ \&username,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{short}\ \&charID)}
\DoxyCodeLine{01754\ \ \ \ \ \{}
\DoxyCodeLine{01755\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{01756\ }
\DoxyCodeLine{01757\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_LOADCHAR));}
\DoxyCodeLine{01758\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(username.c\_str(),16,\&tBitStream);}
\DoxyCodeLine{01759\ \ \ \ \ \ \ \ \ tBitStream.Write(charID);}
\DoxyCodeLine{01760\ }
\DoxyCodeLine{01761\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ HIGH\_PRIORITY,\ RELIABLE\_SEQUENCED,\ 0,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{01762\ \ \ \ \ \}}
\DoxyCodeLine{01763\ \ \ \ \ \textcolor{keywordtype}{void}\ processCreateChar(Packet\ *p)}
\DoxyCodeLine{01764\ \ \ \ \ \{}
\DoxyCodeLine{01765\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!isMainServerConnection)\textcolor{keywordflow}{return};}
\DoxyCodeLine{01766\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream(p-\/>data,\ p-\/>length,\ \textcolor{keyword}{false});}
\DoxyCodeLine{01767\ \ \ \ \ \ \ \ \ MessageID\ tID;}
\DoxyCodeLine{01768\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tSuccess;}
\DoxyCodeLine{01769\ }
\DoxyCodeLine{01770\ \ \ \ \ \ \ \ \ tBitStream.Read(tID);}
\DoxyCodeLine{01771\ \ \ \ \ \ \ \ \ tBitStream.Read(tSuccess);}
\DoxyCodeLine{01772\ \ \ \ \ \ \ \ \ networkMessage\ =\ (tSuccess?NETWORK\_CREATECHARSUCCESS:NETWORK\_CREATECHARFAIL);}
\DoxyCodeLine{01773\ \ \ \ \ \}}
\DoxyCodeLine{01774\ \ \ \ \ \textcolor{keywordtype}{void}\ sendCreateChar(\textcolor{keyword}{const}\ String\ \&username,\ \textcolor{keyword}{const}\ String\ \&name,\ \textcolor{keyword}{const}\ String\ \&data)}
\DoxyCodeLine{01775\ \ \ \ \ \{}
\DoxyCodeLine{01776\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{01777\ }
\DoxyCodeLine{01778\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_CREATECHAR));}
\DoxyCodeLine{01779\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(username.c\_str(),16,\&tBitStream);}
\DoxyCodeLine{01780\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(name.c\_str(),32,\&tBitStream);}
\DoxyCodeLine{01781\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(data.c\_str(),512,\&tBitStream);}
\DoxyCodeLine{01782\ }
\DoxyCodeLine{01783\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ HIGH\_PRIORITY,\ RELIABLE,\ 0,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{01784\ \ \ \ \ \}}
\DoxyCodeLine{01785\ \ \ \ \ \textcolor{keywordtype}{void}\ sendDeleteChar(\textcolor{keyword}{const}\ String\ \&username,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{short}\ \&charID)}
\DoxyCodeLine{01786\ \ \ \ \ \{}
\DoxyCodeLine{01787\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{01788\ }
\DoxyCodeLine{01789\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_DELETECHAR));}
\DoxyCodeLine{01790\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(username.c\_str(),16,\&tBitStream);}
\DoxyCodeLine{01791\ \ \ \ \ \ \ \ \ tBitStream.Write(charID);}
\DoxyCodeLine{01792\ }
\DoxyCodeLine{01793\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ HIGH\_PRIORITY,\ RELIABLE,\ 0,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{01794\ \ \ \ \ \}}
\DoxyCodeLine{01795\ \ \ \ \ \textcolor{keywordtype}{void}\ processEditChar(Packet\ *p)}
\DoxyCodeLine{01796\ \ \ \ \ \{}
\DoxyCodeLine{01797\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!isMainServerConnection)\textcolor{keywordflow}{return};}
\DoxyCodeLine{01798\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream(p-\/>data,\ p-\/>length,\ \textcolor{keyword}{false});}
\DoxyCodeLine{01799\ \ \ \ \ \ \ \ \ MessageID\ tID;}
\DoxyCodeLine{01800\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tSuccess;}
\DoxyCodeLine{01801\ }
\DoxyCodeLine{01802\ \ \ \ \ \ \ \ \ tBitStream.Read(tID);}
\DoxyCodeLine{01803\ \ \ \ \ \ \ \ \ tBitStream.Read(tSuccess);}
\DoxyCodeLine{01804\ \ \ \ \ \ \ \ \ networkMessage\ =\ (tSuccess?NETWORK\_EDITCHARSUCCESS:NETWORK\_EDITCHARFAIL);}
\DoxyCodeLine{01805\ \ \ \ \ \}}
\DoxyCodeLine{01806\ \ \ \ \ \textcolor{keywordtype}{void}\ sendEditChar(\textcolor{keyword}{const}\ String\ \&username,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{short}\ \&charID,\ \textcolor{keyword}{const}\ String\ \&data)}
\DoxyCodeLine{01807\ \ \ \ \ \{}
\DoxyCodeLine{01808\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{01809\ }
\DoxyCodeLine{01810\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_EDITCHAR));}
\DoxyCodeLine{01811\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(username.c\_str(),16,\&tBitStream);}
\DoxyCodeLine{01812\ \ \ \ \ \ \ \ \ tBitStream.Write(charID);}
\DoxyCodeLine{01813\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(data.c\_str(),512,\&tBitStream);}
\DoxyCodeLine{01814\ }
\DoxyCodeLine{01815\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ HIGH\_PRIORITY,\ RELIABLE,\ 0,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{01816\ \ \ \ \ \}}
\DoxyCodeLine{01817\ \ \ \ \ \textcolor{keywordtype}{bool}\ processKick(Packet\ *p)}
\DoxyCodeLine{01818\ \ \ \ \ \{}
\DoxyCodeLine{01819\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream(p-\/>data,\ p-\/>length,\ \textcolor{keyword}{false});}
\DoxyCodeLine{01820\ \ \ \ \ \ \ \ \ MessageID\ tID;}
\DoxyCodeLine{01821\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ tName[16];}
\DoxyCodeLine{01822\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tIsBanned\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01823\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ tNumDays\ =\ 0;}
\DoxyCodeLine{01824\ }
\DoxyCodeLine{01825\ \ \ \ \ \ \ \ \ tBitStream.Read(tID);}
\DoxyCodeLine{01826\ \ \ \ \ \ \ \ \ stringCompressor-\/>DecodeString(tName,16,\&tBitStream);}
\DoxyCodeLine{01827\ \ \ \ \ \ \ \ \ tBitStream.Read(tIsBanned);}
\DoxyCodeLine{01828\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tIsBanned)tBitStream.Read(tNumDays);}
\DoxyCodeLine{01829\ }
\DoxyCodeLine{01830\ \ \ \ \ \ \ \ \ String\ tPlayerName\ =\ mUnitManager-\/>getPlayer()-\/>getUser();}
\DoxyCodeLine{01831\ \ \ \ \ \ \ \ \ StringUtil::toLowerCase(tPlayerName);}
\DoxyCodeLine{01832\ \ \ \ \ \ \ \ \ String\ tCompareName\ =\ String(tName);}
\DoxyCodeLine{01833\ \ \ \ \ \ \ \ \ StringUtil::toLowerCase(tCompareName);}
\DoxyCodeLine{01834\ }
\DoxyCodeLine{01835\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tPlayerName==tCompareName)}
\DoxyCodeLine{01836\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01837\ \ \ \ \ \ \ \ \ \ \ \ \ disconnect();}
\DoxyCodeLine{01838\ \ \ \ \ \ \ \ \ \ \ \ \ mAlertBox-\/>showAlert(\textcolor{stringliteral}{"{}Disconnected\ from\ server\ (Kicked\ by\ Admin)"{}},0.5,0.5,10);}
\DoxyCodeLine{01839\ \ \ \ \ \ \ \ \ \ \ \ \ mChatManager-\/>message(\textcolor{stringliteral}{"{}Disconnected\ from\ server\ (Kicked\ by\ Admin)"{}});}
\DoxyCodeLine{01840\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tIsBanned)mDef-\/>saveBanFile(\textcolor{keyword}{true},tNumDays);}
\DoxyCodeLine{01841\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{01842\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01843\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{01844\ \ \ \ \ \}}
\DoxyCodeLine{01845\ \ \ \ \ \textcolor{keywordtype}{void}\ sendKick(\textcolor{keyword}{const}\ String\ \&name,\ \textcolor{keywordtype}{bool}\ isBan=\textcolor{keyword}{false},\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ numDays=0)}
\DoxyCodeLine{01846\ \ \ \ \ \{}
\DoxyCodeLine{01847\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{01848\ }
\DoxyCodeLine{01849\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_KICK));}
\DoxyCodeLine{01850\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(name.c\_str(),16,\&tBitStream);}
\DoxyCodeLine{01851\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(isBan)}
\DoxyCodeLine{01852\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01853\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Write(isBan);}
\DoxyCodeLine{01854\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Write(numDays);}
\DoxyCodeLine{01855\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01856\ }
\DoxyCodeLine{01857\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ MEDIUM\_PRIORITY,\ UNRELIABLE,\ 0,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{01858\ \ \ \ \ \}}
\DoxyCodeLine{01859\ \ \ \ \ \textcolor{keywordtype}{void}\ processItemDrop(Packet\ *p)}
\DoxyCodeLine{01860\ \ \ \ \ \{}
\DoxyCodeLine{01861\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream(p-\/>data,\ p-\/>length,\ \textcolor{keyword}{false});}
\DoxyCodeLine{01862\ \ \ \ \ \ \ \ \ MessageID\ tID;}
\DoxyCodeLine{01863\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ tItemID;}
\DoxyCodeLine{01864\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ tMesh[16];}
\DoxyCodeLine{01865\ \ \ \ \ \ \ \ \ Real\ tX;}
\DoxyCodeLine{01866\ \ \ \ \ \ \ \ \ Real\ tZ;}
\DoxyCodeLine{01867\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tImTheSender\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{01868\ }
\DoxyCodeLine{01869\ \ \ \ \ \ \ \ \ tBitStream.Read(tID);}
\DoxyCodeLine{01870\ \ \ \ \ \ \ \ \ tBitStream.Read(tItemID);}
\DoxyCodeLine{01871\ \ \ \ \ \ \ \ \ stringCompressor-\/>DecodeString(tMesh,16,\&tBitStream);}
\DoxyCodeLine{01872\ \ \ \ \ \ \ \ \ tBitStream.Read(tX);}
\DoxyCodeLine{01873\ \ \ \ \ \ \ \ \ tBitStream.Read(tZ);}
\DoxyCodeLine{01874\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*tBitStream.Read(tImTheSender);}}
\DoxyCodeLine{01875\ \textcolor{comment}{}}
\DoxyCodeLine{01876\ \textcolor{comment}{\ \ \ \ \ \ \ \ //i\ sent\ this,\ i'll\ tell\ server\ to\ unreserve\ this\ now}}
\DoxyCodeLine{01877\ \textcolor{comment}{\ \ \ \ \ \ \ \ if(tImTheSender)}}
\DoxyCodeLine{01878\ \textcolor{comment}{\ \ \ \ \ \ \ \ \{}}
\DoxyCodeLine{01879\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ sendAcknowledge(ACK\_ITEMDROPPED,tItemID);}}
\DoxyCodeLine{01880\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ //check\ that\ i'm\ still\ in\ the\ place\ where\ i\ sent\ this}}
\DoxyCodeLine{01881\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ char\ tMap[32];}}
\DoxyCodeLine{01882\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ unsigned\ char\ tDimension;}}
\DoxyCodeLine{01883\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ stringCompressor-\/>DecodeString(tMap,32,\&tBitStream);}}
\DoxyCodeLine{01884\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tDimension);}}
\DoxyCodeLine{01885\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ if(String(tMap)!=mWorld-\/>getWorldName()\ ||\ tDimension!=mGameStateManager-\/>getDimension())return;}}
\DoxyCodeLine{01886\ \textcolor{comment}{\ \ \ \ \ \ \ \ \}*/}}
\DoxyCodeLine{01887\ \ \ \ \ \ \ \ \ mUnitManager-\/>createItem(tItemID,String(tMesh),tX,tZ);}
\DoxyCodeLine{01888\ \ \ \ \ \}}
\DoxyCodeLine{01889\ \ \ \ \ \textcolor{keywordtype}{void}\ sendItemDrop(\textcolor{keyword}{const}\ String\ \&meshName,\ \textcolor{keyword}{const}\ Real\ \&x,\ \textcolor{keyword}{const}\ Real\ \&z)}
\DoxyCodeLine{01890\ \ \ \ \ \{}
\DoxyCodeLine{01891\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{01892\ }
\DoxyCodeLine{01893\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_ITEMDROP));}
\DoxyCodeLine{01894\ \ \ \ \ \ \ \ \ tBitStream.Write(OwnerToken(TOKEN\_NULL));}
\DoxyCodeLine{01895\ \ \ \ \ \ \ \ \ tBitStream.Write(mItemManager-\/>getNextEmptyID(mUnitManager-\/>getPlayer()-\/>getIndex()*100));}
\DoxyCodeLine{01896\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(meshName.c\_str(),16,\&tBitStream);}
\DoxyCodeLine{01897\ \ \ \ \ \ \ \ \ tBitStream.Write(x);}
\DoxyCodeLine{01898\ \ \ \ \ \ \ \ \ tBitStream.Write(z);}
\DoxyCodeLine{01899\ }
\DoxyCodeLine{01900\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ MEDIUM\_PRIORITY,\ RELIABLE,\ 2,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{01901\ \ \ \ \ \}}
\DoxyCodeLine{01902\ \ \ \ \ \textcolor{keywordtype}{void}\ sendAllItems(\textcolor{keyword}{const}\ OwnerToken\ \&token)}
\DoxyCodeLine{01903\ \ \ \ \ \{}
\DoxyCodeLine{01904\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ vector<MagixItem*>::type\ tList\ =\ mItemManager-\/>getItemList();}
\DoxyCodeLine{01905\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i=0;i<(int)tList.size();i++)}
\DoxyCodeLine{01906\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01907\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_magix_item}{MagixItem}}\ *tItem\ =\ tList[i];}
\DoxyCodeLine{01908\ \ \ \ \ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{01909\ }
\DoxyCodeLine{01910\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_ITEMDROP));}
\DoxyCodeLine{01911\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Write(token);}
\DoxyCodeLine{01912\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Write(tItem-\/>getID());}
\DoxyCodeLine{01913\ \ \ \ \ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(tItem-\/>getMesh().c\_str(),16,\&tBitStream);}
\DoxyCodeLine{01914\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Vector3\ tPos\ =\ tItem-\/>getPosition();}
\DoxyCodeLine{01915\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Write(tPos.x);}
\DoxyCodeLine{01916\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Write(tPos.z);}
\DoxyCodeLine{01917\ }
\DoxyCodeLine{01918\ \ \ \ \ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ LOW\_PRIORITY,\ RELIABLE,\ 2,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{01919\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01920\ \ \ \ \ \}}
\DoxyCodeLine{01921\ \ \ \ \ \textcolor{keywordtype}{void}\ processItemPickup(Packet\ *p)}
\DoxyCodeLine{01922\ \ \ \ \ \{}
\DoxyCodeLine{01923\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream(p-\/>data,\ p-\/>length,\ \textcolor{keyword}{false});}
\DoxyCodeLine{01924\ \ \ \ \ \ \ \ \ MessageID\ tID;}
\DoxyCodeLine{01925\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ tItemID;}
\DoxyCodeLine{01926\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tSuccess;}
\DoxyCodeLine{01927\ }
\DoxyCodeLine{01928\ \ \ \ \ \ \ \ \ tBitStream.Read(tID);}
\DoxyCodeLine{01929\ \ \ \ \ \ \ \ \ tBitStream.Read(tItemID);}
\DoxyCodeLine{01930\ \ \ \ \ \ \ \ \ tBitStream.Read(tSuccess);}
\DoxyCodeLine{01931\ }
\DoxyCodeLine{01932\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_magix_item}{MagixItem}}\ *tItem\ =\ mItemManager-\/>getByID(tItemID);}
\DoxyCodeLine{01933\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tItem)\textcolor{keywordflow}{return};}
\DoxyCodeLine{01934\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tSuccess)}
\DoxyCodeLine{01935\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01936\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//sendAcknowledge(ACK\_ITEMPICKED,tItemID);}}
\DoxyCodeLine{01937\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ String\ tMeshName\ =\ tItem-\/>getMesh();}
\DoxyCodeLine{01938\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{short}\ tSlot\ =\ mUnitManager-\/>getNextEmptyItemSlot(mUnitManager-\/>getPlayer());}
\DoxyCodeLine{01939\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tSlot!=-\/1)}
\DoxyCodeLine{01940\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{01941\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mChatManager-\/>message(\textcolor{stringliteral}{"{}Equipped\ "{}}+mDef-\/>getItemName(tMeshName)+\textcolor{stringliteral}{"{}."{}});}
\DoxyCodeLine{01942\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mUnitManager-\/>equipItem(mUnitManager-\/>getPlayer(),tMeshName,tSlot);}
\DoxyCodeLine{01943\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sendItemEquip(tMeshName,tSlot);}
\DoxyCodeLine{01944\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01945\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{01946\ \ \ \ \ \ \ \ \ mUnitManager-\/>deleteItem(tItem);}
\DoxyCodeLine{01947\ \ \ \ \ \}}
\DoxyCodeLine{01948\ \ \ \ \ \textcolor{keywordtype}{void}\ sendItemPickup(\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ \&iID)}
\DoxyCodeLine{01949\ \ \ \ \ \{}
\DoxyCodeLine{01950\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{01951\ }
\DoxyCodeLine{01952\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_ITEMPICKUP));}
\DoxyCodeLine{01953\ \ \ \ \ \ \ \ \ tBitStream.Write(iID);}
\DoxyCodeLine{01954\ }
\DoxyCodeLine{01955\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ MEDIUM\_PRIORITY,\ RELIABLE,\ 2,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{01956\ \ \ \ \ \}}
\DoxyCodeLine{01957\ \ \ \ \ \textcolor{keywordtype}{void}\ processItemEquip(Packet\ *p)}
\DoxyCodeLine{01958\ \ \ \ \ \{}
\DoxyCodeLine{01959\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream(p-\/>data,\ p-\/>length,\ \textcolor{keyword}{false});}
\DoxyCodeLine{01960\ \ \ \ \ \ \ \ \ MessageID\ tID;}
\DoxyCodeLine{01961\ \ \ \ \ \ \ \ \ OwnerToken\ tToken;}
\DoxyCodeLine{01962\ }
\DoxyCodeLine{01963\ \ \ \ \ \ \ \ \ tBitStream.Read(tID);}
\DoxyCodeLine{01964\ \ \ \ \ \ \ \ \ tBitStream.Read(tToken);}
\DoxyCodeLine{01965\ }
\DoxyCodeLine{01966\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_magix_indexed_unit}{MagixIndexedUnit}}\ *tUnit\ =\ mUnitManager-\/>getUnitByIndex(tToken);}
\DoxyCodeLine{01967\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tUnit)\textcolor{keywordflow}{return};}
\DoxyCodeLine{01968\ }
\DoxyCodeLine{01969\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ tMesh[16];}
\DoxyCodeLine{01970\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ tSlotID;}
\DoxyCodeLine{01971\ \ \ \ \ \ \ \ \ stringCompressor-\/>DecodeString(tMesh,16,\&tBitStream);}
\DoxyCodeLine{01972\ \ \ \ \ \ \ \ \ tBitStream.Read(tSlotID);}
\DoxyCodeLine{01973\ }
\DoxyCodeLine{01974\ \ \ \ \ \ \ \ \ mUnitManager-\/>equipItem(tUnit,String(tMesh),tSlotID);}
\DoxyCodeLine{01975\ \ \ \ \ \}}
\DoxyCodeLine{01976\ \ \ \ \ \textcolor{keywordtype}{void}\ sendItemEquip(\textcolor{keyword}{const}\ String\ \&meshName,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ \&slotID,\ \textcolor{keyword}{const}\ OwnerToken\ \&target=OwnerToken(TOKEN\_NULL),\ \textcolor{keywordtype}{bool}\ dontTellMainServer=\textcolor{keyword}{false})}
\DoxyCodeLine{01977\ \ \ \ \ \{}
\DoxyCodeLine{01978\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{01979\ }
\DoxyCodeLine{01980\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_ITEMEQUIP));}
\DoxyCodeLine{01981\ \ \ \ \ \ \ \ \ tBitStream.Write(target);}
\DoxyCodeLine{01982\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(meshName.c\_str(),16,\&tBitStream);}
\DoxyCodeLine{01983\ \ \ \ \ \ \ \ \ tBitStream.Write(slotID);}
\DoxyCodeLine{01984\ \ \ \ \ \ \ \ \ tBitStream.Write(dontTellMainServer);}
\DoxyCodeLine{01985\ }
\DoxyCodeLine{01986\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ LOW\_PRIORITY,\ RELIABLE,\ 0,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{01987\ \ \ \ \ \}}
\DoxyCodeLine{01988\ \ \ \ \ \textcolor{keywordtype}{void}\ processItemUnequip(Packet\ *p)}
\DoxyCodeLine{01989\ \ \ \ \ \{}
\DoxyCodeLine{01990\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream(p-\/>data,\ p-\/>length,\ \textcolor{keyword}{false});}
\DoxyCodeLine{01991\ \ \ \ \ \ \ \ \ MessageID\ tID;}
\DoxyCodeLine{01992\ \ \ \ \ \ \ \ \ OwnerToken\ tToken;}
\DoxyCodeLine{01993\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ tSlotID;}
\DoxyCodeLine{01994\ }
\DoxyCodeLine{01995\ \ \ \ \ \ \ \ \ tBitStream.Read(tID);}
\DoxyCodeLine{01996\ \ \ \ \ \ \ \ \ tBitStream.Read(tToken);}
\DoxyCodeLine{01997\ \ \ \ \ \ \ \ \ tBitStream.Read(tSlotID);}
\DoxyCodeLine{01998\ }
\DoxyCodeLine{01999\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_magix_indexed_unit}{MagixIndexedUnit}}\ *tUnit\ =\ mUnitManager-\/>getUnitByIndex(tToken);}
\DoxyCodeLine{02000\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tUnit)\textcolor{keywordflow}{return};}
\DoxyCodeLine{02001\ }
\DoxyCodeLine{02002\ \ \ \ \ \ \ \ \ mUnitManager-\/>unequipItem(tUnit,tSlotID);}
\DoxyCodeLine{02003\ \ \ \ \ \}}
\DoxyCodeLine{02004\ \ \ \ \ \textcolor{keywordtype}{void}\ sendItemUnequip(\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ \&slotID)}
\DoxyCodeLine{02005\ \ \ \ \ \{}
\DoxyCodeLine{02006\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{02007\ }
\DoxyCodeLine{02008\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_ITEMUNEQUIP));}
\DoxyCodeLine{02009\ \ \ \ \ \ \ \ \ tBitStream.Write(OwnerToken(TOKEN\_NULL));}
\DoxyCodeLine{02010\ \ \ \ \ \ \ \ \ tBitStream.Write(slotID);}
\DoxyCodeLine{02011\ }
\DoxyCodeLine{02012\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ LOW\_PRIORITY,\ RELIABLE,\ 2,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{02013\ \ \ \ \ \}}
\DoxyCodeLine{02014\ \ \ \ \ \textcolor{keywordtype}{void}\ sendImReady()}
\DoxyCodeLine{02015\ \ \ \ \ \{}
\DoxyCodeLine{02016\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{02017\ }
\DoxyCodeLine{02018\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_IMREADY));}
\DoxyCodeLine{02019\ }
\DoxyCodeLine{02020\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ LOW\_PRIORITY,\ RELIABLE,\ 1,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{02021\ \ \ \ \ \}}
\DoxyCodeLine{02022\ \ \ \ \ \textcolor{keywordtype}{void}\ processGodSpeak(Packet\ *p)}
\DoxyCodeLine{02023\ \ \ \ \ \{}
\DoxyCodeLine{02024\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream(p-\/>data,\ p-\/>length,\ \textcolor{keyword}{false});}
\DoxyCodeLine{02025\ \ \ \ \ \ \ \ \ MessageID\ tID;}
\DoxyCodeLine{02026\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ tCaption[512];}
\DoxyCodeLine{02027\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{02028\ \ \ \ \ \ \ \ \ tBitStream.Read(tID);}
\DoxyCodeLine{02029\ \ \ \ \ \ \ \ \ stringCompressor-\/>DecodeString(tCaption,512,\&tBitStream);}
\DoxyCodeLine{02030\ }
\DoxyCodeLine{02031\ \ \ \ \ \ \ \ \ mChatManager-\/>message(tCaption);}
\DoxyCodeLine{02032\ \ \ \ \ \}}
\DoxyCodeLine{02033\ \ \ \ \ \textcolor{keywordtype}{void}\ sendGodSpeak(\textcolor{keyword}{const}\ String\ \&caption)}
\DoxyCodeLine{02034\ \ \ \ \ \{}
\DoxyCodeLine{02035\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ String\ tCaption\ =\ \textcolor{stringliteral}{"{}<<("{}}\ USER\_ADMIN\_TEXT\ \textcolor{stringliteral}{"{})"{}}+mUnitManager-\/>getPlayer()-\/>getUser()+\textcolor{stringliteral}{"{}>>"{}}+caption;}
\DoxyCodeLine{02036\ \ \ \ \ \ \ \ \ mChatManager-\/>message(tCaption);}
\DoxyCodeLine{02037\ }
\DoxyCodeLine{02038\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{02039\ }
\DoxyCodeLine{02040\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_GODSPEAK));}
\DoxyCodeLine{02041\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(tCaption.c\_str(),512,\&tBitStream);}
\DoxyCodeLine{02042\ }
\DoxyCodeLine{02043\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ MEDIUM\_PRIORITY,\ RELIABLE,\ 0,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{02044\ \ \ \ \ \}}
\DoxyCodeLine{02045\ \ \ \ \ \textcolor{keywordtype}{bool}\ processForceLogout(Packet\ *p)}
\DoxyCodeLine{02046\ \ \ \ \ \{}
\DoxyCodeLine{02047\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream(p-\/>data,\ p-\/>length,\ \textcolor{keyword}{false});}
\DoxyCodeLine{02048\ \ \ \ \ \ \ \ \ MessageID\ tID;}
\DoxyCodeLine{02049\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ tName[16];}
\DoxyCodeLine{02050\ }
\DoxyCodeLine{02051\ \ \ \ \ \ \ \ \ tBitStream.Read(tID);}
\DoxyCodeLine{02052\ \ \ \ \ \ \ \ \ stringCompressor-\/>DecodeString(tName,16,\&tBitStream);}
\DoxyCodeLine{02053\ }
\DoxyCodeLine{02054\ \ \ \ \ \ \ \ \ String\ tPlayerName\ =\ mUnitManager-\/>getPlayer()-\/>getUser();}
\DoxyCodeLine{02055\ \ \ \ \ \ \ \ \ StringUtil::toLowerCase(tPlayerName);}
\DoxyCodeLine{02056\ \ \ \ \ \ \ \ \ String\ tCompareName\ =\ String(tName);}
\DoxyCodeLine{02057\ \ \ \ \ \ \ \ \ StringUtil::toLowerCase(tCompareName);}
\DoxyCodeLine{02058\ }
\DoxyCodeLine{02059\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tPlayerName==tCompareName)}
\DoxyCodeLine{02060\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02061\ \ \ \ \ \ \ \ \ \ \ \ \ disconnect();}
\DoxyCodeLine{02062\ \ \ \ \ \ \ \ \ \ \ \ \ mAlertBox-\/>showAlert(\textcolor{stringliteral}{"{}Disconnected\ by\ another\ user"{}},0.5,0.5,10);}
\DoxyCodeLine{02063\ \ \ \ \ \ \ \ \ \ \ \ \ mChatManager-\/>message(\textcolor{stringliteral}{"{}Disconnected\ from\ server\ (Another\ user\ logged\ on)"{}});}
\DoxyCodeLine{02064\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{02065\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02066\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{02067\ \ \ \ \ \}}
\DoxyCodeLine{02068\ \ \ \ \ \textcolor{keywordtype}{void}\ processEvent(Packet\ *p)}
\DoxyCodeLine{02069\ \ \ \ \ \{}
\DoxyCodeLine{02070\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream(p-\/>data,\ p-\/>length,\ \textcolor{keyword}{false});}
\DoxyCodeLine{02071\ \ \ \ \ \ \ \ \ MessageID\ tID;}
\DoxyCodeLine{02072\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ type;}
\DoxyCodeLine{02073\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{02074\ \ \ \ \ \ \ \ \ tBitStream.Read(tID);}
\DoxyCodeLine{02075\ \ \ \ \ \ \ \ \ tBitStream.Read(type);}
\DoxyCodeLine{02076\ }
\DoxyCodeLine{02077\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(type==EVENT\_EARTHQUAKE)mSkyManager-\/>setWeatherEffect(\textcolor{stringliteral}{"{}Earthquake"{}});}
\DoxyCodeLine{02078\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(type==EVENT\_MASSBLOCK)}
\DoxyCodeLine{02079\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02080\ \ \ \ \ \ \ \ \ \ \ \ \ OwnerToken\ tToken;}
\DoxyCodeLine{02081\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tToken);}
\DoxyCodeLine{02082\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_magix_indexed_unit}{MagixIndexedUnit}}\ *tUnit\ =\ mUnitManager-\/>getUnitByIndex(tToken);}
\DoxyCodeLine{02083\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tUnit)\textcolor{keywordflow}{return};}
\DoxyCodeLine{02084\ \ \ \ \ \ \ \ \ \ \ \ \ networkMessage\ =\ \mbox{\hyperlink{struct_network_message}{NetworkMessage}}(NETWORK\_BLOCKNAME,tUnit-\/>getUser());}
\DoxyCodeLine{02085\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02086\ \ \ \ \ \}}
\DoxyCodeLine{02087\ \ \ \ \ \textcolor{keywordtype}{void}\ sendEvent(\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ \&type)}
\DoxyCodeLine{02088\ \ \ \ \ \{}
\DoxyCodeLine{02089\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{02090\ }
\DoxyCodeLine{02091\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_EVENT));}
\DoxyCodeLine{02092\ \ \ \ \ \ \ \ \ tBitStream.Write(type);}
\DoxyCodeLine{02093\ }
\DoxyCodeLine{02094\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ MEDIUM\_PRIORITY,\ RELIABLE,\ 1,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{02095\ \ \ \ \ \}}
\DoxyCodeLine{02096\ \ \ \ \ \textcolor{keywordtype}{void}\ sendMassBlock(\textcolor{keyword}{const}\ OwnerToken\ \&target)}
\DoxyCodeLine{02097\ \ \ \ \ \{}
\DoxyCodeLine{02098\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{02099\ }
\DoxyCodeLine{02100\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_EVENT));}
\DoxyCodeLine{02101\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}(EVENT\_MASSBLOCK));}
\DoxyCodeLine{02102\ \ \ \ \ \ \ \ \ tBitStream.Write(target);}
\DoxyCodeLine{02103\ }
\DoxyCodeLine{02104\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ MEDIUM\_PRIORITY,\ RELIABLE,\ 1,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{02105\ \ \ \ \ \}}
\DoxyCodeLine{02106\ \ \ \ \ \textcolor{keywordtype}{void}\ processInfo(Packet\ *p)}
\DoxyCodeLine{02107\ \ \ \ \ \{}
\DoxyCodeLine{02108\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream(p-\/>data,\ p-\/>length,\ \textcolor{keyword}{false});}
\DoxyCodeLine{02109\ \ \ \ \ \ \ \ \ MessageID\ tID;}
\DoxyCodeLine{02110\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ type;}
\DoxyCodeLine{02111\ \ \ \ \ \ \ \ \ OwnerToken\ tToken;}
\DoxyCodeLine{02112\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{02113\ \ \ \ \ \ \ \ \ tBitStream.Read(tID);}
\DoxyCodeLine{02114\ \ \ \ \ \ \ \ \ tBitStream.Read(type);}
\DoxyCodeLine{02115\ \ \ \ \ \ \ \ \ tBitStream.Read(tToken);}
\DoxyCodeLine{02116\ }
\DoxyCodeLine{02117\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Fella\ says\ "{}Can\ i\ join\ party"{}}}
\DoxyCodeLine{02118\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(type==INFO\_PARTYREQUEST)}
\DoxyCodeLine{02119\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02120\ \ \ \ \ \ \ \ \ \ \ \ \ mUnitManager-\/>setPartyInviter(tToken);}
\DoxyCodeLine{02121\ \ \ \ \ \ \ \ \ \ \ \ \ networkMessage\ =\ NETWORK\_PARTYREQUEST;}
\DoxyCodeLine{02122\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02123\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02124\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Fella\ says\ "{}Wanna\ join\ party"{}}}
\DoxyCodeLine{02125\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(type==INFO\_PARTYINVITE)}
\DoxyCodeLine{02126\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02127\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Already\ have\ one,\ thanks}}
\DoxyCodeLine{02128\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(mUnitManager-\/>hasParty())}
\DoxyCodeLine{02129\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02130\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sendInfo(INFO\_PARTYALREADY,tToken);}
\DoxyCodeLine{02131\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02132\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02133\ \ \ \ \ \ \ \ \ \ \ \ \ mUnitManager-\/>setPartyInviter(tToken);}
\DoxyCodeLine{02134\ \ \ \ \ \ \ \ \ \ \ \ \ networkMessage\ =\ NETWORK\_PARTYREQUEST;}
\DoxyCodeLine{02135\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02136\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02137\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Fella\ says\ "{}Sure\ i'll\ join\ party"{}}}
\DoxyCodeLine{02138\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(type==INFO\_PARTYINVITEACCEPTED)}
\DoxyCodeLine{02139\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02140\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Already\ full,\ too\ bad}}
\DoxyCodeLine{02141\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(mUnitManager-\/>isPartyFull())\textcolor{keywordflow}{return};}
\DoxyCodeLine{02142\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Remember\ that\ this\ fella\ asked\ to\ join\ party}}
\DoxyCodeLine{02143\ \ \ \ \ \ \ \ \ \ \ \ \ mUnitManager-\/>setPartyInviter(tToken);}
\DoxyCodeLine{02144\ \ \ \ \ \ \ \ \ \ \ \ \ sendPartyAccepted(tToken);}
\DoxyCodeLine{02145\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02146\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02147\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(type==INFO\_PARTYACCEPTED)}
\DoxyCodeLine{02148\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02149\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Avoid\ double\ partying}}
\DoxyCodeLine{02150\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(mUnitManager-\/>hasParty())\textcolor{keywordflow}{return};}
\DoxyCodeLine{02151\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Get\ party\ list}}
\DoxyCodeLine{02152\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i=0;i<MAX\_PARTYMEMBERS;i++)}
\DoxyCodeLine{02153\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02154\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tHasMore\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02155\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ OwnerToken\ tMemberToken;}
\DoxyCodeLine{02156\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ tMemberName[16];}
\DoxyCodeLine{02157\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tHasMore);}
\DoxyCodeLine{02158\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tHasMore)\textcolor{keywordflow}{break};}
\DoxyCodeLine{02159\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tMemberToken);}
\DoxyCodeLine{02160\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stringCompressor-\/>DecodeString(tMemberName,16,\&tBitStream);}
\DoxyCodeLine{02161\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mUnitManager-\/>addPartyMember(tMemberToken,tMemberName);}
\DoxyCodeLine{02162\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mChatManager-\/>message(String(tMemberName)+\textcolor{stringliteral}{"{}\ has\ joined\ the\ party."{}},CHAT\_PARTY);}
\DoxyCodeLine{02163\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Tell\ this\ fella\ i\ joined\ the\ party}}
\DoxyCodeLine{02164\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sendPartyJoined(tMemberToken);}
\DoxyCodeLine{02165\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//This\ fella\ invited\ me}}
\DoxyCodeLine{02166\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tMemberToken==mUnitManager-\/>getPartyInviter())mUnitManager-\/>setPartyInviter(0);}
\DoxyCodeLine{02167\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02168\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02169\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02170\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(type==INFO\_PARTYJOINED)}
\DoxyCodeLine{02171\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02172\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Check\ if\ member\ already\ exists\ in\ party}}
\DoxyCodeLine{02173\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::pair<OwnerToken,String>\ tCheck\ =\ mUnitManager-\/>getPartyMember(tToken);}
\DoxyCodeLine{02174\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tCheck.first==tToken)\textcolor{keywordflow}{return};}
\DoxyCodeLine{02175\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Allow\ new\ party\ member\ to\ join}}
\DoxyCodeLine{02176\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ tMemberName[16];}
\DoxyCodeLine{02177\ \ \ \ \ \ \ \ \ \ \ \ \ stringCompressor-\/>DecodeString(tMemberName,16,\&tBitStream);}
\DoxyCodeLine{02178\ }
\DoxyCodeLine{02179\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tPartyOverload\ =\ mUnitManager-\/>isPartyFull();}
\DoxyCodeLine{02180\ \ \ \ \ \ \ \ \ \ \ \ \ mUnitManager-\/>addPartyMember(tToken,tMemberName);}
\DoxyCodeLine{02181\ \ \ \ \ \ \ \ \ \ \ \ \ mChatManager-\/>message(String(tMemberName)+\textcolor{stringliteral}{"{}\ has\ joined\ the\ party."{}},CHAT\_PARTY);}
\DoxyCodeLine{02182\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//This\ fella\ requested\ from\ me}}
\DoxyCodeLine{02183\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tToken==mUnitManager-\/>getPartyInviter())}
\DoxyCodeLine{02184\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02185\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mUnitManager-\/>setPartyInviter(0);}
\DoxyCodeLine{02186\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Party\ overloaded,\ kick\ new\ fella}}
\DoxyCodeLine{02187\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tPartyOverload)sendInfo(INFO\_PARTYKICK,tToken);}
\DoxyCodeLine{02188\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02189\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02190\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02191\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(type==INFO\_PARTYKICK)}
\DoxyCodeLine{02192\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02193\ \ \ \ \ \ \ \ \ \ \ \ \ sendPartyLeave();}
\DoxyCodeLine{02194\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02195\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02196\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(type==INFO\_PARTYLEAVE)}
\DoxyCodeLine{02197\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02198\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::pair<OwnerToken,String>\ tMember\ =\ mUnitManager-\/>getPartyMember(tToken);}
\DoxyCodeLine{02199\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tMember.first!=tToken)\textcolor{keywordflow}{return};}
\DoxyCodeLine{02200\ \ \ \ \ \ \ \ \ \ \ \ \ mUnitManager-\/>removePartyMember(tMember.second);}
\DoxyCodeLine{02201\ \ \ \ \ \ \ \ \ \ \ \ \ mChatManager-\/>message(tMember.second+\textcolor{stringliteral}{"{}\ has\ left\ the\ party."{}},CHAT\_PARTY);}
\DoxyCodeLine{02202\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02203\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02204\ }
\DoxyCodeLine{02205\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_magix_indexed_unit}{MagixIndexedUnit}}\ *tUnit\ =\ mUnitManager-\/>getUnitByIndex(tToken);}
\DoxyCodeLine{02206\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tUnit)\textcolor{keywordflow}{return};}
\DoxyCodeLine{02207\ }
\DoxyCodeLine{02208\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*if(type==INFO\_MODON)mUnitManager-\/>createParticleOnUnit(tUnit,"{}RisingShards"{},-\/1,true);}}
\DoxyCodeLine{02209\ \textcolor{comment}{\ \ \ \ \ \ \ \ else\ if(type==INFO\_MODOFF)mUnitManager-\/>destroyParticleOnUnit(tUnit,"{}RisingShards"{});}}
\DoxyCodeLine{02210\ \textcolor{comment}{\ \ \ \ \ \ \ \ else*/}\ \textcolor{keywordflow}{if}(type==INFO\_YOURBLOCKED)}
\DoxyCodeLine{02211\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02212\ \ \ \ \ \ \ \ \ \ \ \ \ tUnit-\/>isBlocked\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02213\ \ \ \ \ \ \ \ \ \ \ \ \ tUnit-\/>isHidden\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02214\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02215\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(type==INFO\_YOURUNBLOCKED)}
\DoxyCodeLine{02216\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02217\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(mDef-\/>isInBlockedList(tUnit-\/>getUser()))}
\DoxyCodeLine{02218\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02219\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sendInfo(INFO\_YOURBLOCKED,tToken);}
\DoxyCodeLine{02220\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02221\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02222\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02223\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tUnit-\/>isBlocked\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02224\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tUnit-\/>isHidden\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02225\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02226\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02227\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(type==INFO\_PARTYALREADY)}
\DoxyCodeLine{02228\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02229\ \ \ \ \ \ \ \ \ \ \ \ \ mChatManager-\/>message(tUnit-\/>getUser()+\textcolor{stringliteral}{"{}\ is\ already\ in\ a\ party."{}},CHAT\_PARTY);}
\DoxyCodeLine{02230\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02231\ \ \ \ \ \}}
\DoxyCodeLine{02232\ \ \ \ \ \textcolor{keywordtype}{void}\ sendInfo(\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ \&type,\ \textcolor{keyword}{const}\ OwnerToken\ \&target=OwnerToken(TOKEN\_NULL))}
\DoxyCodeLine{02233\ \ \ \ \ \{}
\DoxyCodeLine{02234\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{02235\ }
\DoxyCodeLine{02236\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_INFO));}
\DoxyCodeLine{02237\ \ \ \ \ \ \ \ \ tBitStream.Write(type);}
\DoxyCodeLine{02238\ \ \ \ \ \ \ \ \ tBitStream.Write(target);}
\DoxyCodeLine{02239\ }
\DoxyCodeLine{02240\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ MEDIUM\_PRIORITY,\ RELIABLE,\ 1,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{02241\ \ \ \ \ \}}
\DoxyCodeLine{02242\ \ \ \ \ \textcolor{keywordtype}{void}\ sendPartyAccepted(\textcolor{keyword}{const}\ OwnerToken\ \&target)}
\DoxyCodeLine{02243\ \ \ \ \ \{}
\DoxyCodeLine{02244\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{02245\ }
\DoxyCodeLine{02246\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_INFO));}
\DoxyCodeLine{02247\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}(INFO\_PARTYACCEPTED));}
\DoxyCodeLine{02248\ \ \ \ \ \ \ \ \ tBitStream.Write(target);}
\DoxyCodeLine{02249\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ vector<std::pair<OwnerToken,String>>::type\ tParty\ =\ mUnitManager-\/>getPartyMembers();}
\DoxyCodeLine{02250\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i=0;i<(int)tParty.size();i++)}
\DoxyCodeLine{02251\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02252\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{true});}
\DoxyCodeLine{02253\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Write(OwnerToken(tParty[i].first));}
\DoxyCodeLine{02254\ \ \ \ \ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(tParty[i].second.c\_str(),16,\&tBitStream);}
\DoxyCodeLine{02255\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02256\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{true});}
\DoxyCodeLine{02257\ \ \ \ \ \ \ \ \ tBitStream.Write(OwnerToken(mUnitManager-\/>getPlayer()-\/>getIndex()));}
\DoxyCodeLine{02258\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(mUnitManager-\/>getPlayer()-\/>getUser().c\_str(),16,\&tBitStream);}
\DoxyCodeLine{02259\ }
\DoxyCodeLine{02260\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ LOW\_PRIORITY,\ RELIABLE,\ 1,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{02261\ \ \ \ \ \}}
\DoxyCodeLine{02262\ \ \ \ \ \textcolor{keywordtype}{void}\ sendPartyJoined(\textcolor{keyword}{const}\ OwnerToken\ \&target,\ \textcolor{keywordtype}{bool}\ requestPartyList=\textcolor{keyword}{false})}
\DoxyCodeLine{02263\ \ \ \ \ \{}
\DoxyCodeLine{02264\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{02265\ }
\DoxyCodeLine{02266\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_INFO));}
\DoxyCodeLine{02267\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}(INFO\_PARTYJOINED));}
\DoxyCodeLine{02268\ \ \ \ \ \ \ \ \ tBitStream.Write(target);}
\DoxyCodeLine{02269\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(mUnitManager-\/>getPlayer()-\/>getUser().c\_str(),16,\&tBitStream);}
\DoxyCodeLine{02270\ \ \ \ \ \ \ \ \ tBitStream.Write(requestPartyList);}
\DoxyCodeLine{02271\ }
\DoxyCodeLine{02272\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ LOW\_PRIORITY,\ RELIABLE,\ 1,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{02273\ \ \ \ \ \}}
\DoxyCodeLine{02274\ \ \ \ \ \textcolor{keywordtype}{void}\ sendPartyLeave()}
\DoxyCodeLine{02275\ \ \ \ \ \{}
\DoxyCodeLine{02276\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ vector<std::pair<OwnerToken,String>>::type\ tParty\ =\ mUnitManager-\/>getPartyMembers();}
\DoxyCodeLine{02277\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i=0;i<(int)tParty.size();i++)sendInfo(INFO\_PARTYLEAVE,tParty[i].first);}
\DoxyCodeLine{02278\ \ \ \ \ \ \ \ \ mUnitManager-\/>clearPartyMembers();}
\DoxyCodeLine{02279\ \ \ \ \ \ \ \ \ mChatManager-\/>message(\textcolor{stringliteral}{"{}You\ have\ left\ the\ party."{}});}
\DoxyCodeLine{02280\ \ \ \ \ \}}
\DoxyCodeLine{02281\ \ \ \ \ \textcolor{comment}{/*void\ processDenied(Packet\ *p)}}
\DoxyCodeLine{02282\ \textcolor{comment}{\ \ \ \ \{}}
\DoxyCodeLine{02283\ \textcolor{comment}{\ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream(p-\/>data,\ p-\/>length,\ false);}}
\DoxyCodeLine{02284\ \textcolor{comment}{\ \ \ \ \ \ \ \ MessageID\ tID;}}
\DoxyCodeLine{02285\ \textcolor{comment}{\ \ \ \ \ \ \ \ unsigned\ char\ type;}}
\DoxyCodeLine{02286\ \textcolor{comment}{\ \ \ \ \ \ \ \ }}
\DoxyCodeLine{02287\ \textcolor{comment}{\ \ \ \ \ \ \ \ tBitStream.Read(tID);}}
\DoxyCodeLine{02288\ \textcolor{comment}{\ \ \ \ \ \ \ \ tBitStream.Read(type);}}
\DoxyCodeLine{02289\ \textcolor{comment}{\ \ \ \ \ \ \ \ }}
\DoxyCodeLine{02290\ \textcolor{comment}{\ \ \ \ \ \ \ \ //Resend\ itemdropped}}
\DoxyCodeLine{02291\ \textcolor{comment}{\ \ \ \ \ \ \ \ if(type==ACK\_ITEMDROPPED)}}
\DoxyCodeLine{02292\ \textcolor{comment}{\ \ \ \ \ \ \ \ \{}}
\DoxyCodeLine{02293\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ char\ tMesh[16];}}
\DoxyCodeLine{02294\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ Real\ tX;}}
\DoxyCodeLine{02295\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ Real\ tZ;}}
\DoxyCodeLine{02296\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ stringCompressor-\/>DecodeString(tMesh,16,\&tBitStream);}}
\DoxyCodeLine{02297\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tX);}}
\DoxyCodeLine{02298\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tZ);}}
\DoxyCodeLine{02299\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ sendItemDrop(tMesh,tX,tZ);}}
\DoxyCodeLine{02300\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ return;}}
\DoxyCodeLine{02301\ \textcolor{comment}{\ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{02302\ \textcolor{comment}{\ \ \ \ \ \ \ \ //Resend\ create\ critter}}
\DoxyCodeLine{02303\ \textcolor{comment}{\ \ \ \ \ \ \ \ if(type==ID\_CRITTEROWNAGE)}}
\DoxyCodeLine{02304\ \textcolor{comment}{\ \ \ \ \ \ \ \ \{}}
\DoxyCodeLine{02305\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ bool\ tIsCreate;}}
\DoxyCodeLine{02306\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tIsCreate);}}
\DoxyCodeLine{02307\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ if(tIsCreate)}}
\DoxyCodeLine{02308\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \{}}
\DoxyCodeLine{02309\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ OwnerToken\ tToken;}}
\DoxyCodeLine{02310\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ bool\ tIsWorldCritter;}}
\DoxyCodeLine{02311\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ unsigned\ char\ tTypeID;}}
\DoxyCodeLine{02312\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ char\ tType[32];}}
\DoxyCodeLine{02313\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Vector3\ tPosition;}}
\DoxyCodeLine{02314\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tToken);}}
\DoxyCodeLine{02315\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tIsWorldCritter);}}
\DoxyCodeLine{02316\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ if(tIsWorldCritter)tBitStream.Read(tTypeID);}}
\DoxyCodeLine{02317\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ else\ stringCompressor-\/>DecodeString(tType,32,\&tBitStream);}}
\DoxyCodeLine{02318\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tPosition);}}
\DoxyCodeLine{02319\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ if(tIsWorldCritter)sendCritterCreate(tTypeID,tPosition,true);}}
\DoxyCodeLine{02320\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ else\ sendCritterCreate(tType,tPosition,true);}}
\DoxyCodeLine{02321\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{02322\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ return;}}
\DoxyCodeLine{02323\ \textcolor{comment}{\ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{02324\ \textcolor{comment}{\ \ \ \ \}*/}}
\DoxyCodeLine{02325\ \ \ \ \ \textcolor{keywordtype}{void}\ sendAcknowledge(\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ \&type,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ \&iID)}
\DoxyCodeLine{02326\ \ \ \ \ \{}
\DoxyCodeLine{02327\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{02328\ }
\DoxyCodeLine{02329\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_ACKNOWLEDGE));}
\DoxyCodeLine{02330\ \ \ \ \ \ \ \ \ tBitStream.Write(type);}
\DoxyCodeLine{02331\ \ \ \ \ \ \ \ \ tBitStream.Write(iID);}
\DoxyCodeLine{02332\ }
\DoxyCodeLine{02333\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ LOW\_PRIORITY,\ RELIABLE,\ 0,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{02334\ \ \ \ \ \}}
\DoxyCodeLine{02335\ \ \ \ \ \textcolor{comment}{/*void\ sendSkillInitialize()}}
\DoxyCodeLine{02336\ \textcolor{comment}{\ \ \ \ \{}}
\DoxyCodeLine{02337\ \textcolor{comment}{\ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}}
\DoxyCodeLine{02338\ \textcolor{comment}{}}
\DoxyCodeLine{02339\ \textcolor{comment}{\ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_UPDATESKILLS));}}
\DoxyCodeLine{02340\ \textcolor{comment}{\ \ \ \ \ \ \ \ tBitStream.Write(true);}}
\DoxyCodeLine{02341\ \textcolor{comment}{\ \ \ \ \ \ \ \ const\ vector<Skill>::type\ tSkill\ =\ mUnitManager-\/>getPlayer()-\/>getSkills();}}
\DoxyCodeLine{02342\ \textcolor{comment}{\ \ \ \ \ \ \ \ for(int\ i=0;i<(int)tSkill.size();i++)}}
\DoxyCodeLine{02343\ \textcolor{comment}{\ \ \ \ \ \ \ \ \{}}
\DoxyCodeLine{02344\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Write(true);}}
\DoxyCodeLine{02345\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(tSkill[i].name.c\_str(),32,\&tBitStream);}}
\DoxyCodeLine{02346\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Write((unsigned\ char)tSkill[i].stock);}}
\DoxyCodeLine{02347\ \textcolor{comment}{\ \ \ \ \ \ \ \ \}}}
\DoxyCodeLine{02348\ \textcolor{comment}{}}
\DoxyCodeLine{02349\ \textcolor{comment}{\ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ MEDIUM\_PRIORITY,\ RELIABLE,\ 0,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ true);}}
\DoxyCodeLine{02350\ \textcolor{comment}{\ \ \ \ \}*/}}
\DoxyCodeLine{02351\ \ \ \ \ \textcolor{keywordtype}{void}\ sendSkillUpdate(\textcolor{keyword}{const}\ String\ \&type,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ \&stock)}
\DoxyCodeLine{02352\ \ \ \ \ \{}
\DoxyCodeLine{02353\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{02354\ }
\DoxyCodeLine{02355\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_UPDATESKILLS));}
\DoxyCodeLine{02356\ \ \ \ \ \ \ \ \ \textcolor{comment}{//tBitStream.Write(false);}}
\DoxyCodeLine{02357\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(type.c\_str(),32,\&tBitStream);}
\DoxyCodeLine{02358\ \ \ \ \ \ \ \ \ tBitStream.Write(stock);}
\DoxyCodeLine{02359\ }
\DoxyCodeLine{02360\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ LOW\_PRIORITY,\ RELIABLE,\ 0,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{02361\ \ \ \ \ \}}
\DoxyCodeLine{02362\ \ \ \ \ \textcolor{keywordtype}{void}\ sendHPUpdate(\textcolor{keywordtype}{bool}\ sendMaxHP=\textcolor{keyword}{false})}
\DoxyCodeLine{02363\ \ \ \ \ \{}
\DoxyCodeLine{02364\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{02365\ }
\DoxyCodeLine{02366\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_UPDATEHP));}
\DoxyCodeLine{02367\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}(mUnitManager-\/>getPlayer()-\/>getIsWounded()?0:mUnitManager-\/>getPlayer()-\/>getHP()));}
\DoxyCodeLine{02368\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(sendMaxHP)}
\DoxyCodeLine{02369\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02370\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{true});}
\DoxyCodeLine{02371\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Write((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short})mUnitManager-\/>getPlayer()-\/>getMaxHP());}
\DoxyCodeLine{02372\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02373\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ LOW\_PRIORITY,\ RELIABLE,\ 0,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{02374\ \ \ \ \ \}}
\DoxyCodeLine{02375\ \ \ \ \ \textcolor{keywordtype}{void}\ sendPetUpdate()}
\DoxyCodeLine{02376\ \ \ \ \ \{}
\DoxyCodeLine{02377\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{02378\ }
\DoxyCodeLine{02379\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_UPDATEPET));}
\DoxyCodeLine{02380\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(mUnitManager-\/>getPlayer()-\/>getPet().c\_str(),32,\&tBitStream);}
\DoxyCodeLine{02381\ }
\DoxyCodeLine{02382\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ LOW\_PRIORITY,\ RELIABLE,\ 0,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{02383\ \ \ \ \ \}}
\DoxyCodeLine{02384\ \ \ \ \ \textcolor{keywordtype}{void}\ sendCritterCreate(\textcolor{keyword}{const}\ String\ \&type,\ \textcolor{keyword}{const}\ Vector3\ \&position,\ \textcolor{keywordtype}{bool}\ isPet=\textcolor{keyword}{false})}
\DoxyCodeLine{02385\ \ \ \ \ \{}
\DoxyCodeLine{02386\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ tID\ =\ mCritterManager-\/>getNextEmptyID((mUnitManager-\/>getPlayer()-\/>getIndex()-\/1)*200);}
\DoxyCodeLine{02387\ \ \ \ \ \ \ \ \ mCritterManager-\/>pushSentID(tID);}
\DoxyCodeLine{02388\ }
\DoxyCodeLine{02389\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{02390\ }
\DoxyCodeLine{02391\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_CRITTEROWNAGE));}
\DoxyCodeLine{02392\ \ \ \ \ \ \ \ \ tBitStream.Write(tID);}
\DoxyCodeLine{02393\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{true});}
\DoxyCodeLine{02394\ \ \ \ \ \ \ \ \ tBitStream.Write((OwnerToken)mUnitManager-\/>getPlayer()-\/>getIndex());}
\DoxyCodeLine{02395\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{false});}
\DoxyCodeLine{02396\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(type.c\_str(),32,\&tBitStream);}
\DoxyCodeLine{02397\ \ \ \ \ \ \ \ \ tBitStream.Write(position);}
\DoxyCodeLine{02398\ \ \ \ \ \ \ \ \ \textcolor{comment}{//stringCompressor-\/>EncodeString(mWorld-\/>getWorldName().c\_str(),32,\&tBitStream);}}
\DoxyCodeLine{02399\ \ \ \ \ \ \ \ \ \textcolor{comment}{//tBitStream.Write(mGameStateManager-\/>getDimension());}}
\DoxyCodeLine{02400\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(isPet)tBitStream.Write(isPet);}
\DoxyCodeLine{02401\ }
\DoxyCodeLine{02402\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ HIGH\_PRIORITY,\ RELIABLE,\ 4,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{02403\ \ \ \ \ \}}
\DoxyCodeLine{02404\ \ \ \ \ \textcolor{keywordtype}{void}\ sendCritterCreate(\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ \&typeID,\ \textcolor{keyword}{const}\ Vector3\ \&position)}
\DoxyCodeLine{02405\ \ \ \ \ \{}
\DoxyCodeLine{02406\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ tID\ =\ mCritterManager-\/>getNextEmptyID((mUnitManager-\/>getPlayer()-\/>getIndex()-\/1)*200);}
\DoxyCodeLine{02407\ \ \ \ \ \ \ \ \ mCritterManager-\/>pushSentID(tID);}
\DoxyCodeLine{02408\ }
\DoxyCodeLine{02409\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{02410\ }
\DoxyCodeLine{02411\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_CRITTEROWNAGE));}
\DoxyCodeLine{02412\ \ \ \ \ \ \ \ \ tBitStream.Write(tID);}
\DoxyCodeLine{02413\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{true});}
\DoxyCodeLine{02414\ \ \ \ \ \ \ \ \ tBitStream.Write((OwnerToken)mUnitManager-\/>getPlayer()-\/>getIndex());}
\DoxyCodeLine{02415\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{true});}
\DoxyCodeLine{02416\ \ \ \ \ \ \ \ \ tBitStream.Write(typeID);}
\DoxyCodeLine{02417\ \ \ \ \ \ \ \ \ tBitStream.Write(position);}
\DoxyCodeLine{02418\ \ \ \ \ \ \ \ \ \textcolor{comment}{//stringCompressor-\/>EncodeString(mWorld-\/>getWorldName().c\_str(),32,\&tBitStream);}}
\DoxyCodeLine{02419\ \ \ \ \ \ \ \ \ \textcolor{comment}{//tBitStream.Write(mGameStateManager-\/>getDimension());}}
\DoxyCodeLine{02420\ }
\DoxyCodeLine{02421\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ HIGH\_PRIORITY,\ RELIABLE,\ 4,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{02422\ \ \ \ \ \}}
\DoxyCodeLine{02423\ \ \ \ \ \textcolor{keywordtype}{void}\ disownCritters(\textcolor{keyword}{const}\ OwnerToken\ \&target)}
\DoxyCodeLine{02424\ \ \ \ \ \{}
\DoxyCodeLine{02425\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ vector<MagixCritter*>::type\ tList\ =\ mCritterManager-\/>getCritterList();}
\DoxyCodeLine{02426\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Vector3\ tPlayerPos\ =\ mUnitManager-\/>getPlayer()-\/>getPosition();}
\DoxyCodeLine{02427\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i=0;i<(int)tList.size();i++)}
\DoxyCodeLine{02428\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02429\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_magix_critter}{MagixCritter}}\ *tC\ =\ tList[i];}
\DoxyCodeLine{02430\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tC-\/>getOwnerIndex()==target\ \&\&\ !tC-\/>getIsDead())}
\DoxyCodeLine{02431\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02432\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tC-\/>getIsPet())mUnitManager-\/>deleteCritter(tC-\/>getID());}
\DoxyCodeLine{02433\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02434\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02435\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Check\ if\ player\ can\ be\ suiter}}
\DoxyCodeLine{02436\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Real\ tDistance\ =\ tC-\/>getPosition().squaredDistance(tPlayerPos);}
\DoxyCodeLine{02437\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tOwn\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02438\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Fight\ for\ ownership}}
\DoxyCodeLine{02439\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tDistance<4000000)}
\DoxyCodeLine{02440\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02441\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tC-\/>setOwnerIndex(-\/1);}
\DoxyCodeLine{02442\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sendCritterTakeover(tC-\/>getID(),OwnerToken(TOKEN\_NULL),\textcolor{keyword}{true});}
\DoxyCodeLine{02443\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02444\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ mUnitManager-\/>deleteCritter(tC-\/>getID());}
\DoxyCodeLine{02445\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02446\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02447\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02448\ \ \ \ \ \}}
\DoxyCodeLine{02449\ \ \ \ \ \textcolor{keywordtype}{void}\ sendCritterTakeover(\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ \&iID,\ \textcolor{keyword}{const}\ OwnerToken\ \&token=OwnerToken(TOKEN\_NULL),\ \textcolor{keywordtype}{bool}\ fastestFirst=\textcolor{keyword}{false})}
\DoxyCodeLine{02450\ \ \ \ \ \{}
\DoxyCodeLine{02451\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{02452\ }
\DoxyCodeLine{02453\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_CRITTEROWNAGE));}
\DoxyCodeLine{02454\ \ \ \ \ \ \ \ \ tBitStream.Write(iID);}
\DoxyCodeLine{02455\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{false});}
\DoxyCodeLine{02456\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{true});}
\DoxyCodeLine{02457\ \ \ \ \ \ \ \ \ tBitStream.Write(\ (token==TOKEN\_NULL?(OwnerToken)mUnitManager-\/>getPlayer()-\/>getIndex():token)\ );}
\DoxyCodeLine{02458\ \ \ \ \ \ \ \ \ tBitStream.Write(fastestFirst);}
\DoxyCodeLine{02459\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(token!=TOKEN\_NULL)tBitStream.Write((OwnerToken)mUnitManager-\/>getPlayer()-\/>getIndex());}
\DoxyCodeLine{02460\ }
\DoxyCodeLine{02461\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ MEDIUM\_PRIORITY,\ RELIABLE,\ 4,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{02462\ \ \ \ \ \}}
\DoxyCodeLine{02463\ \ \ \ \ \textcolor{keywordtype}{void}\ processCritterOwnage(Packet\ *p)}
\DoxyCodeLine{02464\ \ \ \ \ \{}
\DoxyCodeLine{02465\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream(p-\/>data,\ p-\/>length,\ \textcolor{keyword}{false});}
\DoxyCodeLine{02466\ \ \ \ \ \ \ \ \ MessageID\ tID;}
\DoxyCodeLine{02467\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ tCritterID;}
\DoxyCodeLine{02468\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tIsCreate\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02469\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tIsTakeover\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02470\ }
\DoxyCodeLine{02471\ \ \ \ \ \ \ \ \ tBitStream.Read(tID);}
\DoxyCodeLine{02472\ \ \ \ \ \ \ \ \ tBitStream.Read(tCritterID);}
\DoxyCodeLine{02473\ }
\DoxyCodeLine{02474\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Create}}
\DoxyCodeLine{02475\ \ \ \ \ \ \ \ \ tBitStream.Read(tIsCreate);}
\DoxyCodeLine{02476\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tIsCreate)}
\DoxyCodeLine{02477\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02478\ \ \ \ \ \ \ \ \ \ \ \ \ OwnerToken\ tToken;}
\DoxyCodeLine{02479\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tIsWorldCritter\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02480\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ tTypeID;}
\DoxyCodeLine{02481\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ tType[32];}
\DoxyCodeLine{02482\ \ \ \ \ \ \ \ \ \ \ \ \ Vector3\ tPosition;}
\DoxyCodeLine{02483\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//char\ tMap[32];}}
\DoxyCodeLine{02484\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//unsigned\ char\ tDimension;}}
\DoxyCodeLine{02485\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tIsPet\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02486\ }
\DoxyCodeLine{02487\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tToken);}
\DoxyCodeLine{02488\ }
\DoxyCodeLine{02489\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tToken!=mUnitManager-\/>getPlayer()-\/>getIndex())}
\DoxyCodeLine{02490\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02491\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_magix_indexed_unit}{MagixIndexedUnit}}\ *tUnit\ =\ mUnitManager-\/>getUnitByIndex(tToken);}
\DoxyCodeLine{02492\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//No\ such\ owner}}
\DoxyCodeLine{02493\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tUnit)\textcolor{keywordflow}{return};}
\DoxyCodeLine{02494\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02495\ }
\DoxyCodeLine{02496\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tIsWorldCritter);}
\DoxyCodeLine{02497\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tIsWorldCritter)tBitStream.Read(tTypeID);}
\DoxyCodeLine{02498\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ stringCompressor-\/>DecodeString(tType,32,\&tBitStream);}
\DoxyCodeLine{02499\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tPosition);}
\DoxyCodeLine{02500\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//stringCompressor-\/>DecodeString(tMap,32,\&tBitStream);}}
\DoxyCodeLine{02501\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//tBitStream.Read(tDimension);}}
\DoxyCodeLine{02502\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tIsPet);}
\DoxyCodeLine{02503\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{02504\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//i\ sent\ this,\ i'll\ tell\ server\ to\ unreserve\ this\ now}}
\DoxyCodeLine{02505\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//if(tToken==mUnitManager-\/>getPlayer()-\/>getIndex())sendAcknowledge(ACK\_CRITTERCREATED,tCritterID);}}
\DoxyCodeLine{02506\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tToken==mUnitManager-\/>getPlayer()-\/>getIndex())mCritterManager-\/>popSentID(tCritterID);}
\DoxyCodeLine{02507\ }
\DoxyCodeLine{02508\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//if(String(tMap)!=mWorld-\/>getWorldName()\ ||\ tDimension!=mGameStateManager-\/>getDimension())return;}}
\DoxyCodeLine{02509\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_magix_critter}{MagixCritter}}\ *tC\ =\ 0;}
\DoxyCodeLine{02510\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tIsWorldCritter)tC\ =\ mUnitManager-\/>createCritter(tCritterID,tTypeID,tPosition,(tToken==mUnitManager-\/>getPlayer()-\/>getIndex()?0:tToken));}
\DoxyCodeLine{02511\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ tC\ =\ mUnitManager-\/>createCritter(tCritterID,tType,tPosition,(tToken==mUnitManager-\/>getPlayer()-\/>getIndex()?0:tToken));}
\DoxyCodeLine{02512\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tIsPet)mCritterManager-\/>setIsPet(tC);}
\DoxyCodeLine{02513\ }
\DoxyCodeLine{02514\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//This\ is\ my\ pet}}
\DoxyCodeLine{02515\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tC\ \&\&\ tIsPet\ \&\&\ tC-\/>imTheOwner())}
\DoxyCodeLine{02516\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02517\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_pet_flags}{PetFlags}}\ *tFlags\ =\ mUnitManager-\/>getPlayer()-\/>getPetFlags();}
\DoxyCodeLine{02518\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tFlags-\/>shrink)sendCritterShrink(tC-\/>getID(),\textcolor{keyword}{true});}
\DoxyCodeLine{02519\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tFlags-\/>evolve)sendCritterShrink(tC-\/>getID(),\textcolor{keyword}{true},\textcolor{keyword}{true});}
\DoxyCodeLine{02520\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02521\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02522\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02523\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Takeover}}
\DoxyCodeLine{02524\ \ \ \ \ \ \ \ \ tBitStream.Read(tIsTakeover);}
\DoxyCodeLine{02525\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tIsTakeover)}
\DoxyCodeLine{02526\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02527\ \ \ \ \ \ \ \ \ \ \ \ \ OwnerToken\ tToken;}
\DoxyCodeLine{02528\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tFastestFirst\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02529\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tToken);}
\DoxyCodeLine{02530\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tFastestFirst);}
\DoxyCodeLine{02531\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{02532\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tToken!=mUnitManager-\/>getPlayer()-\/>getIndex())}
\DoxyCodeLine{02533\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02534\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_magix_indexed_unit}{MagixIndexedUnit}}\ *tUnit\ =\ mUnitManager-\/>getUnitByIndex(tToken);}
\DoxyCodeLine{02535\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//No\ such\ owner}}
\DoxyCodeLine{02536\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tUnit)\textcolor{keywordflow}{return};}
\DoxyCodeLine{02537\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02538\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{02539\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//i\ sent\ this,\ i'll\ tell\ server\ to\ unreserve\ this\ now}}
\DoxyCodeLine{02540\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//if(tToken==mUnitManager-\/>getPlayer()-\/>getIndex())sendAcknowledge(ACK\_CRITTERCREATED,tCritterID);}}
\DoxyCodeLine{02541\ }
\DoxyCodeLine{02542\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_magix_critter}{MagixCritter}}\ *tC\ =\ mCritterManager-\/>getByID(tCritterID);}
\DoxyCodeLine{02543\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tC)}
\DoxyCodeLine{02544\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02545\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ OwnerToken\ tSender\ =\ tToken;}
\DoxyCodeLine{02546\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tSender);}
\DoxyCodeLine{02547\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//That\ critter\ doesn't\ exist\ for\ me,\ please\ update\ me\ on\ it}}
\DoxyCodeLine{02548\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sendCritterUpdateRequest(tSender,tCritterID);}
\DoxyCodeLine{02549\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02550\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02551\ }
\DoxyCodeLine{02552\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Critter\ must\ be\ unowned\ for\ fastest\ first}}
\DoxyCodeLine{02553\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tFastestFirst\ \&\&\ tC-\/>getOwnerIndex()>=0)\textcolor{keywordflow}{return};}
\DoxyCodeLine{02554\ }
\DoxyCodeLine{02555\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//No\ taking\ over\ of\ pets}}
\DoxyCodeLine{02556\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tC-\/>getIsPet())\textcolor{keywordflow}{return};}
\DoxyCodeLine{02557\ }
\DoxyCodeLine{02558\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tToken==mUnitManager-\/>getPlayer()-\/>getIndex())}
\DoxyCodeLine{02559\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02560\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tC-\/>setOwnerIndex(0);}
\DoxyCodeLine{02561\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mCritterManager-\/>removeFromMyCritters(tC);}
\DoxyCodeLine{02562\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mCritterManager-\/>pushMyCritters(tC);}
\DoxyCodeLine{02563\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02564\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02565\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02566\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tC-\/>setOwnerIndex(tToken);}
\DoxyCodeLine{02567\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mCritterManager-\/>removeFromMyCritters(tC);}
\DoxyCodeLine{02568\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02569\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02570\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02571\ \ \ \ \ \}}
\DoxyCodeLine{02572\ \ \ \ \ \textcolor{keywordtype}{void}\ sendCritterHit(\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ \&iID,\ \textcolor{keyword}{const}\ Real\ \&damage,\ \textcolor{keyword}{const}\ Vector3\ \&force)}
\DoxyCodeLine{02573\ \ \ \ \ \{}
\DoxyCodeLine{02574\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{02575\ }
\DoxyCodeLine{02576\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_CRITTERINFOONEWAY));}
\DoxyCodeLine{02577\ \ \ \ \ \ \ \ \ tBitStream.Write(iID);}
\DoxyCodeLine{02578\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{true});}
\DoxyCodeLine{02579\ \ \ \ \ \ \ \ \ tBitStream.Write(OwnerToken(mUnitManager-\/>getPlayer()-\/>getIndex()));}
\DoxyCodeLine{02580\ \ \ \ \ \ \ \ \ tBitStream.Write(damage);}
\DoxyCodeLine{02581\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ tNoForce\ =\ (force==Vector3::ZERO);}
\DoxyCodeLine{02582\ \ \ \ \ \ \ \ \ tBitStream.Write(tNoForce);}
\DoxyCodeLine{02583\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tNoForce)tBitStream.Write(force);}
\DoxyCodeLine{02584\ }
\DoxyCodeLine{02585\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ LOW\_PRIORITY,\ RELIABLE,\ 4,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{02586\ \ \ \ \ \}}
\DoxyCodeLine{02587\ \ \ \ \ \textcolor{keywordtype}{void}\ sendCritterDecision(\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ \&iID,\ \textcolor{keyword}{const}\ Vector3\ \&target)}
\DoxyCodeLine{02588\ \ \ \ \ \{}
\DoxyCodeLine{02589\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{02590\ }
\DoxyCodeLine{02591\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_CRITTERINFOONEWAY));}
\DoxyCodeLine{02592\ \ \ \ \ \ \ \ \ tBitStream.Write(iID);}
\DoxyCodeLine{02593\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{false});}
\DoxyCodeLine{02594\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{true});}
\DoxyCodeLine{02595\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{false});}
\DoxyCodeLine{02596\ \ \ \ \ \ \ \ \ tBitStream.Write(target);}
\DoxyCodeLine{02597\ }
\DoxyCodeLine{02598\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ LOW\_PRIORITY,\ RELIABLE,\ 4,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{02599\ \ \ \ \ \}}
\DoxyCodeLine{02600\ \ \ \ \ \textcolor{keywordtype}{void}\ sendCritterAttackDecision(\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ \&iID,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ \&targetID,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ \&attackID,\ \textcolor{keywordtype}{bool}\ targetIsCritter=\textcolor{keyword}{false})}
\DoxyCodeLine{02601\ \ \ \ \ \{}
\DoxyCodeLine{02602\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{02603\ }
\DoxyCodeLine{02604\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_CRITTERINFOONEWAY));}
\DoxyCodeLine{02605\ \ \ \ \ \ \ \ \ tBitStream.Write(iID);}
\DoxyCodeLine{02606\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{false});}
\DoxyCodeLine{02607\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{true});}
\DoxyCodeLine{02608\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{true});}
\DoxyCodeLine{02609\ \ \ \ \ \ \ \ \ tBitStream.Write(targetIsCritter);}
\DoxyCodeLine{02610\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(targetIsCritter)tBitStream.Write(targetID);}
\DoxyCodeLine{02611\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ tBitStream.Write((OwnerToken)targetID);}
\DoxyCodeLine{02612\ \ \ \ \ \ \ \ \ tBitStream.Write(attackID);}
\DoxyCodeLine{02613\ }
\DoxyCodeLine{02614\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ LOW\_PRIORITY,\ RELIABLE,\ 4,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{02615\ \ \ \ \ \}}
\DoxyCodeLine{02616\ \ \ \ \ \textcolor{keywordtype}{void}\ sendCritterKilled(\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ \&iID,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{short}\ \&killer)}
\DoxyCodeLine{02617\ \ \ \ \ \{}
\DoxyCodeLine{02618\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{02619\ }
\DoxyCodeLine{02620\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_CRITTERINFO));}
\DoxyCodeLine{02621\ \ \ \ \ \ \ \ \ tBitStream.Write(iID);}
\DoxyCodeLine{02622\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{false});}
\DoxyCodeLine{02623\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{false});}
\DoxyCodeLine{02624\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{true});}
\DoxyCodeLine{02625\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ OwnerToken\ tToken\ =\ killer==-\/1?TOKEN\_NULL:\ (killer==0?mUnitManager-\/>getPlayer()-\/>getIndex():killer);}
\DoxyCodeLine{02626\ \ \ \ \ \ \ \ \ tBitStream.Write(tToken);}
\DoxyCodeLine{02627\ }
\DoxyCodeLine{02628\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ LOW\_PRIORITY,\ RELIABLE,\ 4,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{02629\ \ \ \ \ \}}
\DoxyCodeLine{02630\ \ \ \ \ \textcolor{keywordtype}{void}\ sendCritterTamed(\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ \&iID)}
\DoxyCodeLine{02631\ \ \ \ \ \{}
\DoxyCodeLine{02632\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{02633\ }
\DoxyCodeLine{02634\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_CRITTERINFO));}
\DoxyCodeLine{02635\ \ \ \ \ \ \ \ \ tBitStream.Write(iID);}
\DoxyCodeLine{02636\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{false});}
\DoxyCodeLine{02637\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{false});}
\DoxyCodeLine{02638\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{false});}
\DoxyCodeLine{02639\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{true});}
\DoxyCodeLine{02640\ \ \ \ \ \ \ \ \ tBitStream.Write((OwnerToken)mUnitManager-\/>getPlayer()-\/>getIndex());}
\DoxyCodeLine{02641\ }
\DoxyCodeLine{02642\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ LOW\_PRIORITY,\ RELIABLE,\ 4,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{02643\ \ \ \ \ \}}
\DoxyCodeLine{02644\ \ \ \ \ \textcolor{keywordtype}{void}\ sendCritterShrink(\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ \&iID,\ \textcolor{keywordtype}{bool}\ flag,\ \textcolor{keywordtype}{bool}\ isEvolve=\textcolor{keyword}{false})}
\DoxyCodeLine{02645\ \ \ \ \ \{}
\DoxyCodeLine{02646\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{02647\ }
\DoxyCodeLine{02648\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_CRITTERINFO));}
\DoxyCodeLine{02649\ \ \ \ \ \ \ \ \ tBitStream.Write(iID);}
\DoxyCodeLine{02650\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{false});}
\DoxyCodeLine{02651\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{false});}
\DoxyCodeLine{02652\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{false});}
\DoxyCodeLine{02653\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{false});}
\DoxyCodeLine{02654\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{true});}
\DoxyCodeLine{02655\ \ \ \ \ \ \ \ \ tBitStream.Write(flag);}
\DoxyCodeLine{02656\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(flag\ \&\&\ isEvolve)tBitStream.Write(\textcolor{keyword}{true});}
\DoxyCodeLine{02657\ }
\DoxyCodeLine{02658\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ LOW\_PRIORITY,\ RELIABLE,\ 4,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{02659\ \ \ \ \ \}}
\DoxyCodeLine{02660\ \ \ \ \ \textcolor{comment}{/*void\ sendCritterDisown(const\ unsigned\ short\ \&iID)}}
\DoxyCodeLine{02661\ \textcolor{comment}{\ \ \ \ \{}}
\DoxyCodeLine{02662\ \textcolor{comment}{\ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}}
\DoxyCodeLine{02663\ \textcolor{comment}{}}
\DoxyCodeLine{02664\ \textcolor{comment}{\ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_CRITTERINFO));}}
\DoxyCodeLine{02665\ \textcolor{comment}{\ \ \ \ \ \ \ \ tBitStream.Write(iID);}}
\DoxyCodeLine{02666\ \textcolor{comment}{\ \ \ \ \ \ \ \ tBitStream.Write(OwnerToken(mUnitManager-\/>getPlayer()-\/>getIndex()));}}
\DoxyCodeLine{02667\ \textcolor{comment}{\ \ \ \ \ \ \ \ tBitStream.Write(false);}}
\DoxyCodeLine{02668\ \textcolor{comment}{\ \ \ \ \ \ \ \ tBitStream.Write(false);}}
\DoxyCodeLine{02669\ \textcolor{comment}{\ \ \ \ \ \ \ \ tBitStream.Write(false);}}
\DoxyCodeLine{02670\ \textcolor{comment}{\ \ \ \ \ \ \ \ tBitStream.Write(true);}}
\DoxyCodeLine{02671\ \textcolor{comment}{}}
\DoxyCodeLine{02672\ \textcolor{comment}{\ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ MEDIUM\_PRIORITY,\ RELIABLE,\ 4,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ true);}}
\DoxyCodeLine{02673\ \textcolor{comment}{\ \ \ \ \}*/}}
\DoxyCodeLine{02674\ \ \ \ \ \textcolor{keywordtype}{void}\ processCritterInfo(Packet\ *p)}
\DoxyCodeLine{02675\ \ \ \ \ \{}
\DoxyCodeLine{02676\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream(p-\/>data,\ p-\/>length,\ \textcolor{keyword}{false});}
\DoxyCodeLine{02677\ \ \ \ \ \ \ \ \ MessageID\ tID;}
\DoxyCodeLine{02678\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ tCritterID;}
\DoxyCodeLine{02679\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tIsHit\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02680\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tIsDecision\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02681\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tIsKilled\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02682\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tIsTamed\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02683\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tIsShrunk\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02684\ }
\DoxyCodeLine{02685\ \ \ \ \ \ \ \ \ tBitStream.Read(tID);}
\DoxyCodeLine{02686\ \ \ \ \ \ \ \ \ tBitStream.Read(tCritterID);}
\DoxyCodeLine{02687\ }
\DoxyCodeLine{02688\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Hit}}
\DoxyCodeLine{02689\ \ \ \ \ \ \ \ \ tBitStream.Read(tIsHit);}
\DoxyCodeLine{02690\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tIsHit)}
\DoxyCodeLine{02691\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02692\ \ \ \ \ \ \ \ \ \ \ \ \ OwnerToken\ tToken;}
\DoxyCodeLine{02693\ \ \ \ \ \ \ \ \ \ \ \ \ Real\ tDamage;}
\DoxyCodeLine{02694\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tNoForce\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02695\ \ \ \ \ \ \ \ \ \ \ \ \ Vector3\ tForce\ =\ Vector3::ZERO;}
\DoxyCodeLine{02696\ }
\DoxyCodeLine{02697\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tToken);}
\DoxyCodeLine{02698\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tDamage);}
\DoxyCodeLine{02699\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tNoForce);}
\DoxyCodeLine{02700\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tNoForce)tBitStream.Read(tForce);}
\DoxyCodeLine{02701\ }
\DoxyCodeLine{02702\ \ \ \ \ \ \ \ \ \ \ \ \ mCritterManager-\/>hitCritter(tCritterID,tDamage,tForce,tToken);}
\DoxyCodeLine{02703\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02704\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02705\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Decision}}
\DoxyCodeLine{02706\ \ \ \ \ \ \ \ \ tBitStream.Read(tIsDecision);}
\DoxyCodeLine{02707\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tIsDecision)}
\DoxyCodeLine{02708\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02709\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_magix_critter}{MagixCritter}}\ *tCritter\ =\ mCritterManager-\/>getByID(tCritterID);}
\DoxyCodeLine{02710\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tCritter)\textcolor{keywordflow}{return};}
\DoxyCodeLine{02711\ }
\DoxyCodeLine{02712\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tIsAttack\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02713\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tIsAttack);}
\DoxyCodeLine{02714\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//It's\ an\ attack!}}
\DoxyCodeLine{02715\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tIsAttack)}
\DoxyCodeLine{02716\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02717\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tTargetIsCritter;}
\DoxyCodeLine{02718\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tTargetIsCritter);}
\DoxyCodeLine{02719\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_magix_living}{MagixLiving}}\ *tTarget\ =\ 0;}
\DoxyCodeLine{02720\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tTargetIsCritter)}
\DoxyCodeLine{02721\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02722\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ tTargetID;}
\DoxyCodeLine{02723\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tTargetID);}
\DoxyCodeLine{02724\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tTarget\ =\ mCritterManager-\/>getByID(tTargetID);}
\DoxyCodeLine{02725\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02726\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02727\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02728\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ OwnerToken\ tTargetID;}
\DoxyCodeLine{02729\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tTargetID);}
\DoxyCodeLine{02730\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tTargetID==mUnitManager-\/>getPlayer()-\/>getIndex())tTarget\ =\ mUnitManager-\/>getPlayer();}
\DoxyCodeLine{02731\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ tTarget\ =\ mUnitManager-\/>getUnitByIndex(tTargetID);}
\DoxyCodeLine{02732\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02733\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tTarget)\textcolor{keywordflow}{return};}
\DoxyCodeLine{02734\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ tAttackID;}
\DoxyCodeLine{02735\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tAttackID);}
\DoxyCodeLine{02736\ }
\DoxyCodeLine{02737\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tCritter-\/>setTarget(tTarget,tAttackID);}
\DoxyCodeLine{02738\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02739\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//Just\ roaming}}
\DoxyCodeLine{02740\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02741\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02742\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ Vector3\ tTarget;}
\DoxyCodeLine{02743\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tTarget);}
\DoxyCodeLine{02744\ }
\DoxyCodeLine{02745\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tCritter-\/>setTarget(tTarget);}
\DoxyCodeLine{02746\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02747\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02748\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02749\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Killed}}
\DoxyCodeLine{02750\ \ \ \ \ \ \ \ \ tBitStream.Read(tIsKilled);}
\DoxyCodeLine{02751\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tIsKilled)}
\DoxyCodeLine{02752\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02753\ \ \ \ \ \ \ \ \ \ \ \ \ OwnerToken\ tToken;}
\DoxyCodeLine{02754\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tToken);}
\DoxyCodeLine{02755\ }
\DoxyCodeLine{02756\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_magix_critter}{MagixCritter}}\ *tCritter\ =\ mCritterManager-\/>getByID(tCritterID);}
\DoxyCodeLine{02757\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tCritter)\textcolor{keywordflow}{return};}
\DoxyCodeLine{02758\ \ \ \ \ \ \ \ \ \ \ \ \ mUnitManager-\/>killAndRewardCritter(tCritter,(tToken==mUnitManager-\/>getPlayer()-\/>getIndex()));}
\DoxyCodeLine{02759\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02760\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02761\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Tamed}}
\DoxyCodeLine{02762\ \ \ \ \ \ \ \ \ tBitStream.Read(tIsTamed);}
\DoxyCodeLine{02763\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tIsTamed)}
\DoxyCodeLine{02764\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02765\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_magix_critter}{MagixCritter}}\ *tCritter\ =\ mCritterManager-\/>getByID(tCritterID);}
\DoxyCodeLine{02766\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tCritter)\textcolor{keywordflow}{return};}
\DoxyCodeLine{02767\ \ \ \ \ \ \ \ \ \ \ \ \ OwnerToken\ tToken;}
\DoxyCodeLine{02768\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tToken);}
\DoxyCodeLine{02769\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ tImTheOwner\ =\ tToken==mUnitManager-\/>getPlayer()-\/>getIndex();}
\DoxyCodeLine{02770\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{02771\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tCritter-\/>getIsPet())\textcolor{keywordflow}{return};}
\DoxyCodeLine{02772\ \ \ \ \ \ \ \ \ \ \ \ \ mCritterManager-\/>setIsPet(tCritter);}
\DoxyCodeLine{02773\ \ \ \ \ \ \ \ \ \ \ \ \ tCritter-\/>setOwnerIndex(tImTheOwner?0:tToken);}
\DoxyCodeLine{02774\ \ \ \ \ \ \ \ \ \ \ \ \ tCritter-\/>setLastHitIndex(-\/1);}
\DoxyCodeLine{02775\ \ \ \ \ \ \ \ \ \ \ \ \ tCritter-\/>setDecisionTimer(0);}
\DoxyCodeLine{02776\ \ \ \ \ \ \ \ \ \ \ \ \ mCritterManager-\/>removeFromMyCritters(tCritter);}
\DoxyCodeLine{02777\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tImTheOwner)}
\DoxyCodeLine{02778\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02779\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mCritterManager-\/>pushMyCritters(tCritter);}
\DoxyCodeLine{02780\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ String\ tType\ =\ tCritter-\/>getCritterType();}
\DoxyCodeLine{02781\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ tVowel\ =\ (tType.length()>0\ \&\&\ (tType[0]==\textcolor{charliteral}{'A'}||tType[0]==\textcolor{charliteral}{'E'}||tType[0]==\textcolor{charliteral}{'I'}||tType[0]==\textcolor{charliteral}{'O'}||tType[0]==\textcolor{charliteral}{'U'}));}
\DoxyCodeLine{02782\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mChatManager-\/>message(\textcolor{stringliteral}{"{}You\ have\ tamed\ "{}}+(tVowel?String(\textcolor{stringliteral}{"{}an\ "{}}):String(\textcolor{stringliteral}{"{}a\ "{}}))+tType+\textcolor{stringliteral}{"{}."{}});}
\DoxyCodeLine{02783\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(mUnitManager-\/>getPlayer()-\/>getPet()!=\textcolor{stringliteral}{"{}"{}})mChatManager-\/>message(\textcolor{stringliteral}{"{}You\ have\ tamed\ more\ than\ one\ pet,\ only\ the\ newest\ one\ will\ follow\ you."{}});}
\DoxyCodeLine{02784\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mUnitManager-\/>getPlayer()-\/>setPet(tType,mDef);}
\DoxyCodeLine{02785\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sendPetUpdate();}
\DoxyCodeLine{02786\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02787\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02788\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02789\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Shrink}}
\DoxyCodeLine{02790\ \ \ \ \ \ \ \ \ tBitStream.Read(tIsShrunk);}
\DoxyCodeLine{02791\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tIsShrunk)}
\DoxyCodeLine{02792\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02793\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tIsTrue;}
\DoxyCodeLine{02794\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tIsTrue);}
\DoxyCodeLine{02795\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tIsEvolve\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02796\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tIsEvolve);}
\DoxyCodeLine{02797\ }
\DoxyCodeLine{02798\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_magix_critter}{MagixCritter}}\ *tCritter\ =\ mCritterManager-\/>getByID(tCritterID);}
\DoxyCodeLine{02799\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tCritter)\textcolor{keywordflow}{return};}
\DoxyCodeLine{02800\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tIsTrue)}
\DoxyCodeLine{02801\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02802\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tIsEvolve)tCritter-\/>getObjectNode()-\/>setScale(15,15,15);}
\DoxyCodeLine{02803\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02804\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02805\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Real\ tScale\ =\ tCritter-\/>getLength()>50?0.1:\ (1\ -\/\ tCritter-\/>getLength()*0.018);}
\DoxyCodeLine{02806\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tCritter-\/>getObjectNode()-\/>setScale(tScale,tScale,tScale);}
\DoxyCodeLine{02807\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02808\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02809\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02810\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02811\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{struct_critter}{Critter}}\ tC\ =\ mDef-\/>getCritter(tCritter-\/>getCritterType());}
\DoxyCodeLine{02812\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Real\ tScale\ =\ (tCritter-\/>getIsPet()\&\&tC.scale>1.5)?1.5:tC.scale;}
\DoxyCodeLine{02813\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tCritter-\/>getObjectNode()-\/>setScale(tScale,tScale,tScale);}
\DoxyCodeLine{02814\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02815\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02816\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02817\ \ \ \ \ \ \ \ \ \textcolor{comment}{/*//Disown}}
\DoxyCodeLine{02818\ \textcolor{comment}{\ \ \ \ \ \ \ \ tBitStream.Read(tIsDisown);}}
\DoxyCodeLine{02819\ \textcolor{comment}{\ \ \ \ \ \ \ \ if(tIsDisown)}}
\DoxyCodeLine{02820\ \textcolor{comment}{\ \ \ \ \ \ \ \ \{}}
\DoxyCodeLine{02821\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ MagixCritter\ *tCritter\ =\ mCritterManager-\/>getByID(tCritterID);}}
\DoxyCodeLine{02822\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ if(!tCritter)return;}}
\DoxyCodeLine{02823\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ tCritter-\/>setOwnerIndex(-\/1);}}
\DoxyCodeLine{02824\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ if(tToken==mUnitManager-\/>getPlayer()-\/>getIndex())mCritterManager-\/>removeFromMyCritters(tCritter);}}
\DoxyCodeLine{02825\ \textcolor{comment}{\ \ \ \ \ \ \ \ \ \ \ \ return;}}
\DoxyCodeLine{02826\ \textcolor{comment}{\ \ \ \ \ \ \ \ \}*/}}
\DoxyCodeLine{02827\ \ \ \ \ \}}
\DoxyCodeLine{02828\ \ \ \ \ \textcolor{keywordtype}{void}\ sendMyCritters(\textcolor{keyword}{const}\ OwnerToken\ \&target)}
\DoxyCodeLine{02829\ \ \ \ \ \{}
\DoxyCodeLine{02830\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ vector<MagixCritter*>::type\ tList\ =\ mCritterManager-\/>getMyCritters();}
\DoxyCodeLine{02831\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_magix_critter}{MagixCritter}}\ *tPet\ =\ 0;}
\DoxyCodeLine{02832\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i=0;i<(int)tList.size();i++)}
\DoxyCodeLine{02833\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02834\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_magix_critter}{MagixCritter}}\ *tC\ =\ tList[i];}
\DoxyCodeLine{02835\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tC-\/>getIsDead())}
\DoxyCodeLine{02836\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02837\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tC-\/>getIsWorldCritter())sendCritterUpdate(target,tC-\/>getID(),tC-\/>getWorldCritterID(),tC-\/>getPosition(),tC-\/>getHPRatio());}
\DoxyCodeLine{02838\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02839\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02840\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sendCritterUpdate(target,tC-\/>getID(),tC-\/>getCritterType(),tC-\/>getPosition(),tC-\/>getHPRatio(),tC-\/>getIsPet());}
\DoxyCodeLine{02841\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tC-\/>getIsPet())tPet\ =\ tC;}
\DoxyCodeLine{02842\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02843\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02844\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02845\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tPet)}
\DoxyCodeLine{02846\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02847\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{struct_pet_flags}{PetFlags}}\ *tFlags\ =\ mUnitManager-\/>getPlayer()-\/>getPetFlags();}
\DoxyCodeLine{02848\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tFlags-\/>shrink)sendCritterShrinkTargeted(target,tPet-\/>getID());}
\DoxyCodeLine{02849\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tFlags-\/>evolve)sendCritterShrinkTargeted(target,tPet-\/>getID(),\textcolor{keyword}{true});}
\DoxyCodeLine{02850\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02851\ \ \ \ \ \}}
\DoxyCodeLine{02852\ \ \ \ \ \textcolor{keywordtype}{void}\ sendCritterUpdate(\textcolor{keyword}{const}\ OwnerToken\ \&target,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ \&iID,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ \&typeID,\ \textcolor{keyword}{const}\ Vector3\ \&position,\ \textcolor{keyword}{const}\ Real\ \&hpRatio,\ \textcolor{keyword}{const}\ OwnerToken\ \&token=OwnerToken(TOKEN\_NULL))}
\DoxyCodeLine{02853\ \ \ \ \ \{}
\DoxyCodeLine{02854\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{02855\ }
\DoxyCodeLine{02856\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_CRITTERTARGETEDINFO));}
\DoxyCodeLine{02857\ \ \ \ \ \ \ \ \ tBitStream.Write(iID);}
\DoxyCodeLine{02858\ \ \ \ \ \ \ \ \ tBitStream.Write(target);}
\DoxyCodeLine{02859\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{true});}
\DoxyCodeLine{02860\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{true});}
\DoxyCodeLine{02861\ \ \ \ \ \ \ \ \ tBitStream.Write(typeID);}
\DoxyCodeLine{02862\ \ \ \ \ \ \ \ \ tBitStream.Write(position);}
\DoxyCodeLine{02863\ \ \ \ \ \ \ \ \ tBitStream.Write(hpRatio);}
\DoxyCodeLine{02864\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(token!=TOKEN\_NULL)tBitStream.Write(token);}
\DoxyCodeLine{02865\ }
\DoxyCodeLine{02866\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ HIGH\_PRIORITY,\ RELIABLE,\ 4,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{02867\ \ \ \ \ \}}
\DoxyCodeLine{02868\ \ \ \ \ \textcolor{keywordtype}{void}\ sendCritterUpdate(\textcolor{keyword}{const}\ OwnerToken\ \&target,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ \&iID,\ \textcolor{keyword}{const}\ String\ \&type,\ \textcolor{keyword}{const}\ Vector3\ \&position,\ \textcolor{keyword}{const}\ Real\ \&hpRatio,\ \textcolor{keywordtype}{bool}\ isPet=\textcolor{keyword}{false},\ \textcolor{keyword}{const}\ OwnerToken\ \&token=OwnerToken(TOKEN\_NULL))}
\DoxyCodeLine{02869\ \ \ \ \ \{}
\DoxyCodeLine{02870\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{02871\ }
\DoxyCodeLine{02872\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_CRITTERTARGETEDINFO));}
\DoxyCodeLine{02873\ \ \ \ \ \ \ \ \ tBitStream.Write(iID);}
\DoxyCodeLine{02874\ \ \ \ \ \ \ \ \ tBitStream.Write(target);}
\DoxyCodeLine{02875\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{true});}
\DoxyCodeLine{02876\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{false});}
\DoxyCodeLine{02877\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(type.c\_str(),32,\&tBitStream);}
\DoxyCodeLine{02878\ \ \ \ \ \ \ \ \ tBitStream.Write(position);}
\DoxyCodeLine{02879\ \ \ \ \ \ \ \ \ tBitStream.Write(hpRatio);}
\DoxyCodeLine{02880\ \ \ \ \ \ \ \ \ tBitStream.Write(isPet);}
\DoxyCodeLine{02881\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(token!=TOKEN\_NULL)tBitStream.Write(token);}
\DoxyCodeLine{02882\ }
\DoxyCodeLine{02883\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ HIGH\_PRIORITY,\ RELIABLE,\ 4,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{02884\ \ \ \ \ \}}
\DoxyCodeLine{02885\ \ \ \ \ \textcolor{keywordtype}{void}\ sendCritterUpdateRequest(\textcolor{keyword}{const}\ OwnerToken\ \&target,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ \&iID)}
\DoxyCodeLine{02886\ \ \ \ \ \{}
\DoxyCodeLine{02887\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{02888\ }
\DoxyCodeLine{02889\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_CRITTERTARGETEDINFO));}
\DoxyCodeLine{02890\ \ \ \ \ \ \ \ \ tBitStream.Write(iID);}
\DoxyCodeLine{02891\ \ \ \ \ \ \ \ \ tBitStream.Write(target);}
\DoxyCodeLine{02892\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{false});}
\DoxyCodeLine{02893\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{true});}
\DoxyCodeLine{02894\ }
\DoxyCodeLine{02895\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ HIGH\_PRIORITY,\ RELIABLE,\ 4,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{02896\ \ \ \ \ \}}
\DoxyCodeLine{02897\ \ \ \ \ \textcolor{keywordtype}{void}\ sendCritterShrinkTargeted(\textcolor{keyword}{const}\ OwnerToken\ \&target,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ \&iID,\ \textcolor{keywordtype}{bool}\ isEvolve=\textcolor{keyword}{false})}
\DoxyCodeLine{02898\ \ \ \ \ \{}
\DoxyCodeLine{02899\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{02900\ }
\DoxyCodeLine{02901\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_CRITTERTARGETEDINFO));}
\DoxyCodeLine{02902\ \ \ \ \ \ \ \ \ tBitStream.Write(iID);}
\DoxyCodeLine{02903\ \ \ \ \ \ \ \ \ tBitStream.Write(target);}
\DoxyCodeLine{02904\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{false});}
\DoxyCodeLine{02905\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{false});}
\DoxyCodeLine{02906\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{true});}
\DoxyCodeLine{02907\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(isEvolve)tBitStream.Write(\textcolor{keyword}{true});}
\DoxyCodeLine{02908\ }
\DoxyCodeLine{02909\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ LOW\_PRIORITY,\ RELIABLE,\ 4,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{02910\ \ \ \ \ \}}
\DoxyCodeLine{02911\ \ \ \ \ \textcolor{keywordtype}{void}\ processCritterTargetedInfo(Packet\ *p)}
\DoxyCodeLine{02912\ \ \ \ \ \{}
\DoxyCodeLine{02913\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream(p-\/>data,\ p-\/>length,\ \textcolor{keyword}{false});}
\DoxyCodeLine{02914\ \ \ \ \ \ \ \ \ MessageID\ tID;}
\DoxyCodeLine{02915\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ tCritterID;}
\DoxyCodeLine{02916\ \ \ \ \ \ \ \ \ OwnerToken\ tToken;}
\DoxyCodeLine{02917\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tIsUpdate\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02918\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tIsUpdateRequest\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02919\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tIsShrunk\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02920\ }
\DoxyCodeLine{02921\ \ \ \ \ \ \ \ \ tBitStream.Read(tID);}
\DoxyCodeLine{02922\ \ \ \ \ \ \ \ \ tBitStream.Read(tCritterID);}
\DoxyCodeLine{02923\ \ \ \ \ \ \ \ \ tBitStream.Read(tToken);}
\DoxyCodeLine{02924\ }
\DoxyCodeLine{02925\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Update}}
\DoxyCodeLine{02926\ \ \ \ \ \ \ \ \ tBitStream.Read(tIsUpdate);}
\DoxyCodeLine{02927\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tIsUpdate)}
\DoxyCodeLine{02928\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02929\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tIsWorldCritter\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{02930\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ tTypeID;}
\DoxyCodeLine{02931\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ tType[32];}
\DoxyCodeLine{02932\ \ \ \ \ \ \ \ \ \ \ \ \ Vector3\ tPosition;}
\DoxyCodeLine{02933\ \ \ \ \ \ \ \ \ \ \ \ \ Real\ tHPRatio;}
\DoxyCodeLine{02934\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tIsPet\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02935\ \ \ \ \ \ \ \ \ \ \ \ \ OwnerToken\ tOwner\ =\ 0;}
\DoxyCodeLine{02936\ }
\DoxyCodeLine{02937\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tIsWorldCritter);}
\DoxyCodeLine{02938\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tIsWorldCritter)tBitStream.Read(tTypeID);}
\DoxyCodeLine{02939\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ stringCompressor-\/>DecodeString(tType,32,\&tBitStream);}
\DoxyCodeLine{02940\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tPosition);}
\DoxyCodeLine{02941\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tHPRatio);}
\DoxyCodeLine{02942\ }
\DoxyCodeLine{02943\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_magix_critter}{MagixCritter}}\ *tCritter\ =\ 0;}
\DoxyCodeLine{02944\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tIsWorldCritter)tCritter\ =\ mUnitManager-\/>createCritter(tCritterID,tTypeID,tPosition,tToken);}
\DoxyCodeLine{02945\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02946\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02947\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tCritter\ =\ mUnitManager-\/>createCritter(tCritterID,tType,tPosition,tToken);}
\DoxyCodeLine{02948\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tIsPet);}
\DoxyCodeLine{02949\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02950\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tOwner);}
\DoxyCodeLine{02951\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tCritter)}
\DoxyCodeLine{02952\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02953\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tCritter-\/>setHPRatio(tHPRatio);}
\DoxyCodeLine{02954\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tIsPet)mCritterManager-\/>setIsPet(tCritter);}
\DoxyCodeLine{02955\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tOwner!=0)}
\DoxyCodeLine{02956\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02957\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tOwner==mUnitManager-\/>getPlayer()-\/>getIndex())}
\DoxyCodeLine{02958\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02959\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tCritter-\/>setOwnerIndex(0);}
\DoxyCodeLine{02960\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mCritterManager-\/>pushMyCritters(tCritter);}
\DoxyCodeLine{02961\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02962\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ tCritter-\/>setOwnerIndex(tOwner);}
\DoxyCodeLine{02963\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02964\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02965\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02966\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02967\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Update\ request}}
\DoxyCodeLine{02968\ \ \ \ \ \ \ \ \ tBitStream.Read(tIsUpdateRequest);}
\DoxyCodeLine{02969\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tIsUpdateRequest)}
\DoxyCodeLine{02970\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02971\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_magix_critter}{MagixCritter}}\ *tCritter\ =\ mCritterManager-\/>getByID(tCritterID);}
\DoxyCodeLine{02972\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tCritter)\textcolor{keywordflow}{return};}
\DoxyCodeLine{02973\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{short}\ tOwner\ =\ tCritter-\/>getOwnerIndex();}
\DoxyCodeLine{02974\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tCritter-\/>getIsWorldCritter())}
\DoxyCodeLine{02975\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sendCritterUpdate(tToken,tCritterID,tCritter-\/>getWorldCritterID(),tCritter-\/>getPosition(),tCritter-\/>getHPRatio(),tOwner>0?tOwner:OwnerToken(TOKEN\_NULL));}
\DoxyCodeLine{02976\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{02977\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ sendCritterUpdate(tToken,tCritterID,tCritter-\/>getCritterType(),tCritter-\/>getPosition(),tCritter-\/>getHPRatio(),tCritter-\/>getIsPet(),tOwner>0?tOwner:OwnerToken(TOKEN\_NULL));}
\DoxyCodeLine{02978\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02979\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02980\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Shrink}}
\DoxyCodeLine{02981\ \ \ \ \ \ \ \ \ tBitStream.Read(tIsShrunk);}
\DoxyCodeLine{02982\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tIsShrunk)}
\DoxyCodeLine{02983\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{02984\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tIsEvolve\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{02985\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tIsEvolve);}
\DoxyCodeLine{02986\ }
\DoxyCodeLine{02987\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_magix_critter}{MagixCritter}}\ *tCritter\ =\ mCritterManager-\/>getByID(tCritterID);}
\DoxyCodeLine{02988\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tCritter)\textcolor{keywordflow}{return};}
\DoxyCodeLine{02989\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tIsEvolve)tCritter-\/>getObjectNode()-\/>setScale(15,15,15);}
\DoxyCodeLine{02990\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ tCritter-\/>getObjectNode()-\/>setScale(0.1,0.1,0.1);}
\DoxyCodeLine{02991\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{02992\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{02993\ \ \ \ \ \}}
\DoxyCodeLine{02994\ \ \ \ \ \textcolor{keywordtype}{void}\ sendPlayerUpdate(\textcolor{keyword}{const}\ OwnerToken\ \&target=OwnerToken(TOKEN\_NULL))}
\DoxyCodeLine{02995\ \ \ \ \ \{}
\DoxyCodeLine{02996\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{02997\ }
\DoxyCodeLine{02998\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(target==OwnerToken(TOKEN\_NULL))}
\DoxyCodeLine{02999\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03000\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_PLAYERINFO));}
\DoxyCodeLine{03001\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Write((OwnerToken)mUnitManager-\/>getPlayer()-\/>getIndex());}
\DoxyCodeLine{03002\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03003\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{03004\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03005\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_PLAYERTARGETEDINFO));}
\DoxyCodeLine{03006\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Write(target);}
\DoxyCodeLine{03007\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03008\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{true});}
\DoxyCodeLine{03009\ \ \ \ \ \ \ \ \ tBitStream.Write((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short})mUnitManager-\/>getPlayer()-\/>getMaxHP());}
\DoxyCodeLine{03010\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ tWounded\ =\ mUnitManager-\/>getPlayer()-\/>getIsWounded();}
\DoxyCodeLine{03011\ \ \ \ \ \ \ \ \ tBitStream.Write(tWounded);}
\DoxyCodeLine{03012\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tWounded)tBitStream.Write((\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short})mUnitManager-\/>getPlayer()-\/>getHP());}
\DoxyCodeLine{03013\ }
\DoxyCodeLine{03014\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ LOW\_PRIORITY,\ RELIABLE,\ 0,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{03015\ \ \ \ \ \}}
\DoxyCodeLine{03016\ \ \ \ \ \textcolor{keywordtype}{void}\ sendPlayerHit(\textcolor{keyword}{const}\ OwnerToken\ \&unitID,\ \textcolor{keyword}{const}\ Real\ \&damage,\ \textcolor{keyword}{const}\ Vector3\ \&force)}
\DoxyCodeLine{03017\ \ \ \ \ \{}
\DoxyCodeLine{03018\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{03019\ }
\DoxyCodeLine{03020\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_PLAYERINFO));}
\DoxyCodeLine{03021\ \ \ \ \ \ \ \ \ tBitStream.Write((OwnerToken)mUnitManager-\/>getPlayer()-\/>getIndex());}
\DoxyCodeLine{03022\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{false});}
\DoxyCodeLine{03023\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{true});}
\DoxyCodeLine{03024\ \ \ \ \ \ \ \ \ tBitStream.Write(unitID);}
\DoxyCodeLine{03025\ \ \ \ \ \ \ \ \ tBitStream.Write(damage);}
\DoxyCodeLine{03026\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ \textcolor{keywordtype}{bool}\ tNoForce\ =\ force==Vector3::ZERO;}
\DoxyCodeLine{03027\ \ \ \ \ \ \ \ \ tBitStream.Write(tNoForce);}
\DoxyCodeLine{03028\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tNoForce)tBitStream.Write(force);}
\DoxyCodeLine{03029\ }
\DoxyCodeLine{03030\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ LOW\_PRIORITY,\ RELIABLE,\ 0,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{03031\ \ \ \ \ \}}
\DoxyCodeLine{03032\ \ \ \ \ \textcolor{keywordtype}{void}\ sendPlayerWounded()}
\DoxyCodeLine{03033\ \ \ \ \ \{}
\DoxyCodeLine{03034\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{03035\ }
\DoxyCodeLine{03036\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_PLAYERINFO));}
\DoxyCodeLine{03037\ \ \ \ \ \ \ \ \ tBitStream.Write((OwnerToken)mUnitManager-\/>getPlayer()-\/>getIndex());}
\DoxyCodeLine{03038\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{false});}
\DoxyCodeLine{03039\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{false});}
\DoxyCodeLine{03040\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{true});}
\DoxyCodeLine{03041\ }
\DoxyCodeLine{03042\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ LOW\_PRIORITY,\ RELIABLE,\ 0,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{03043\ \ \ \ \ \}}
\DoxyCodeLine{03044\ \ \ \ \ \textcolor{keywordtype}{void}\ sendPlayerUnwounded()}
\DoxyCodeLine{03045\ \ \ \ \ \{}
\DoxyCodeLine{03046\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{03047\ }
\DoxyCodeLine{03048\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_PLAYERINFO));}
\DoxyCodeLine{03049\ \ \ \ \ \ \ \ \ tBitStream.Write((OwnerToken)mUnitManager-\/>getPlayer()-\/>getIndex());}
\DoxyCodeLine{03050\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{false});}
\DoxyCodeLine{03051\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{false});}
\DoxyCodeLine{03052\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{false});}
\DoxyCodeLine{03053\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{true});}
\DoxyCodeLine{03054\ }
\DoxyCodeLine{03055\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ LOW\_PRIORITY,\ RELIABLE,\ 0,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{03056\ \ \ \ \ \}}
\DoxyCodeLine{03057\ \ \ \ \ \textcolor{keywordtype}{void}\ processPlayerInfo(Packet\ *p)}
\DoxyCodeLine{03058\ \ \ \ \ \{}
\DoxyCodeLine{03059\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream(p-\/>data,\ p-\/>length,\ \textcolor{keyword}{false});}
\DoxyCodeLine{03060\ \ \ \ \ \ \ \ \ MessageID\ tID;}
\DoxyCodeLine{03061\ \ \ \ \ \ \ \ \ OwnerToken\ tToken;}
\DoxyCodeLine{03062\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tIsUpdate\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03063\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tIsHit\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03064\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tIsWounded\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03065\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tIsUnwounded\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03066\ }
\DoxyCodeLine{03067\ \ \ \ \ \ \ \ \ tBitStream.Read(tID);}
\DoxyCodeLine{03068\ \ \ \ \ \ \ \ \ tBitStream.Read(tToken);}
\DoxyCodeLine{03069\ }
\DoxyCodeLine{03070\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Update}}
\DoxyCodeLine{03071\ \ \ \ \ \ \ \ \ tBitStream.Read(tIsUpdate);}
\DoxyCodeLine{03072\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tIsUpdate)}
\DoxyCodeLine{03073\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03074\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_magix_indexed_unit}{MagixIndexedUnit}}\ *unit\ =\ mUnitManager-\/>getUnitByIndex(tToken);}
\DoxyCodeLine{03075\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!unit)\textcolor{keywordflow}{return};}
\DoxyCodeLine{03076\ }
\DoxyCodeLine{03077\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ tMaxHP;}
\DoxyCodeLine{03078\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tIsWounded\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03079\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ tHP;}
\DoxyCodeLine{03080\ }
\DoxyCodeLine{03081\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tMaxHP);}
\DoxyCodeLine{03082\ \ \ \ \ \ \ \ \ \ \ \ \ unit-\/>setHP(tMaxHP,0);}
\DoxyCodeLine{03083\ }
\DoxyCodeLine{03084\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tIsWounded);}
\DoxyCodeLine{03085\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tIsWounded)}
\DoxyCodeLine{03086\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03087\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tHP);}
\DoxyCodeLine{03088\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ unit-\/>addHP(tHP);}
\DoxyCodeLine{03089\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03090\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{03091\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03092\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ unit-\/>isWounded\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{03093\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03094\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{03095\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03096\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Hit}}
\DoxyCodeLine{03097\ \ \ \ \ \ \ \ \ tBitStream.Read(tIsHit);}
\DoxyCodeLine{03098\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tIsHit)}
\DoxyCodeLine{03099\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03100\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tToken==mUnitManager-\/>getPlayer()-\/>getIndex())\textcolor{keywordflow}{return};}
\DoxyCodeLine{03101\ \ \ \ \ \ \ \ \ \ \ \ \ OwnerToken\ tUnitID;}
\DoxyCodeLine{03102\ \ \ \ \ \ \ \ \ \ \ \ \ Real\ tDamage;}
\DoxyCodeLine{03103\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tNoForce\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{03104\ \ \ \ \ \ \ \ \ \ \ \ \ Vector3\ tForce\ =\ Vector3::ZERO;}
\DoxyCodeLine{03105\ }
\DoxyCodeLine{03106\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tUnitID);}
\DoxyCodeLine{03107\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tDamage);}
\DoxyCodeLine{03108\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tNoForce);}
\DoxyCodeLine{03109\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tNoForce)tBitStream.Read(tForce);}
\DoxyCodeLine{03110\ }
\DoxyCodeLine{03111\ \ \ \ \ \ \ \ \ \ \ \ \ mUnitManager-\/>hitUnit(tUnitID,tDamage,tForce);}
\DoxyCodeLine{03112\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{03113\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03114\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Wounded}}
\DoxyCodeLine{03115\ \ \ \ \ \ \ \ \ tBitStream.Read(tIsWounded);}
\DoxyCodeLine{03116\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tIsWounded)}
\DoxyCodeLine{03117\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03118\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_magix_indexed_unit}{MagixIndexedUnit}}\ *unit\ =\ mUnitManager-\/>getUnitByIndex(tToken);}
\DoxyCodeLine{03119\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!unit)\textcolor{keywordflow}{return};}
\DoxyCodeLine{03120\ \ \ \ \ \ \ \ \ \ \ \ \ unit-\/>isWounded\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{03121\ \ \ \ \ \ \ \ \ \ \ \ \ unit-\/>setHP(0);}
\DoxyCodeLine{03122\ \ \ \ \ \ \ \ \ \ \ \ \ unit-\/>cancelAction(5.5,\textcolor{stringliteral}{"{}Faint"{}});}
\DoxyCodeLine{03123\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(mUnitManager-\/>isPartyMember(unit))mChatManager-\/>message(unit-\/>getName()+\textcolor{stringliteral}{"{}\ is\ wounded!"{}},CHAT\_PARTY);}
\DoxyCodeLine{03124\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03125\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Unwounded}}
\DoxyCodeLine{03126\ \ \ \ \ \ \ \ \ tBitStream.Read(tIsUnwounded);}
\DoxyCodeLine{03127\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tIsUnwounded)}
\DoxyCodeLine{03128\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03129\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_magix_indexed_unit}{MagixIndexedUnit}}\ *unit\ =\ mUnitManager-\/>getUnitByIndex(tToken);}
\DoxyCodeLine{03130\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!unit)\textcolor{keywordflow}{return};}
\DoxyCodeLine{03131\ \ \ \ \ \ \ \ \ \ \ \ \ unit-\/>isWounded\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03132\ \ \ \ \ \ \ \ \ \ \ \ \ unit-\/>setHPRatio(0.05);}
\DoxyCodeLine{03133\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(mUnitManager-\/>isPartyMember(unit))mChatManager-\/>message(unit-\/>getName()+\textcolor{stringliteral}{"{}\ recovered\ from\ the\ wound."{}},CHAT\_PARTY);}
\DoxyCodeLine{03134\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03135\ \ \ \ \ \}}
\DoxyCodeLine{03136\ \ \ \ \ \textcolor{keywordtype}{void}\ sendItemStash(\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ \&slot)}
\DoxyCodeLine{03137\ \ \ \ \ \{}
\DoxyCodeLine{03138\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{03139\ }
\DoxyCodeLine{03140\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_ITEMSTASH));}
\DoxyCodeLine{03141\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{true});}
\DoxyCodeLine{03142\ \ \ \ \ \ \ \ \ tBitStream.Write(slot);}
\DoxyCodeLine{03143\ }
\DoxyCodeLine{03144\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ HIGH\_PRIORITY,\ RELIABLE,\ 6,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{03145\ \ \ \ \ \}}
\DoxyCodeLine{03146\ \ \ \ \ \textcolor{keywordtype}{void}\ sendItemUnstash(\textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ \&line,\ \textcolor{keyword}{const}\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ \&slot)}
\DoxyCodeLine{03147\ \ \ \ \ \{}
\DoxyCodeLine{03148\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{03149\ }
\DoxyCodeLine{03150\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_ITEMSTASH));}
\DoxyCodeLine{03151\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{false});}
\DoxyCodeLine{03152\ \ \ \ \ \ \ \ \ tBitStream.Write(line);}
\DoxyCodeLine{03153\ \ \ \ \ \ \ \ \ tBitStream.Write(slot);}
\DoxyCodeLine{03154\ }
\DoxyCodeLine{03155\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ HIGH\_PRIORITY,\ RELIABLE,\ 6,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{03156\ \ \ \ \ \}}
\DoxyCodeLine{03157\ \ \ \ \ \textcolor{keywordtype}{void}\ processItemStash(Packet\ *p)}
\DoxyCodeLine{03158\ \ \ \ \ \{}
\DoxyCodeLine{03159\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream(p-\/>data,\ p-\/>length,\ \textcolor{keyword}{false});}
\DoxyCodeLine{03160\ \ \ \ \ \ \ \ \ MessageID\ tID;}
\DoxyCodeLine{03161\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tIsStash\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03162\ }
\DoxyCodeLine{03163\ \ \ \ \ \ \ \ \ tBitStream.Read(tID);}
\DoxyCodeLine{03164\ \ \ \ \ \ \ \ \ tBitStream.Read(tIsStash);}
\DoxyCodeLine{03165\ }
\DoxyCodeLine{03166\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tIsStash)}
\DoxyCodeLine{03167\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03168\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tIsInit\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03169\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tIsInit);}
\DoxyCodeLine{03170\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tIsInit)}
\DoxyCodeLine{03171\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03172\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mItemManager-\/>clearStash();}
\DoxyCodeLine{03173\ }
\DoxyCodeLine{03174\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tHasMore\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03175\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tHasMore);}
\DoxyCodeLine{03176\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}(tHasMore)}
\DoxyCodeLine{03177\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03178\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tHasMore\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03179\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ tMesh[16];}
\DoxyCodeLine{03180\ }
\DoxyCodeLine{03181\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ stringCompressor-\/>DecodeString(tMesh,16,\&tBitStream);}
\DoxyCodeLine{03182\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mItemManager-\/>pushStash(tMesh);}
\DoxyCodeLine{03183\ }
\DoxyCodeLine{03184\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tHasMore);}
\DoxyCodeLine{03185\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03186\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03187\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{03188\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03189\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ tSlot;}
\DoxyCodeLine{03190\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tSlot);}
\DoxyCodeLine{03191\ }
\DoxyCodeLine{03192\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ String\ tEquip\ =\ mUnitManager-\/>unequipItem(mUnitManager-\/>getPlayer(),tSlot);}
\DoxyCodeLine{03193\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mItemManager-\/>pushStash(tEquip);}
\DoxyCodeLine{03194\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mChatManager-\/>message(\textcolor{stringliteral}{"{}Moved\ "{}}+mDef-\/>getItemName(tEquip)+\textcolor{stringliteral}{"{}\ into\ stash."{}});}
\DoxyCodeLine{03195\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03196\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03197\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Unstash}}
\DoxyCodeLine{03198\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{03199\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03200\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ tLine;}
\DoxyCodeLine{03201\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{short}\ tSlot;}
\DoxyCodeLine{03202\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tLine);}
\DoxyCodeLine{03203\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tSlot);}
\DoxyCodeLine{03204\ }
\DoxyCodeLine{03205\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ String\ tEquip\ =\ mItemManager-\/>popStash(tLine);}
\DoxyCodeLine{03206\ }
\DoxyCodeLine{03207\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tEquip!=\textcolor{stringliteral}{"{}"{}}\ \&\&\ mUnitManager-\/>getPlayer()-\/>getEquip(tSlot)==\textcolor{stringliteral}{"{}"{}})}
\DoxyCodeLine{03208\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03209\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mChatManager-\/>message(\textcolor{stringliteral}{"{}Equipped\ "{}}+mDef-\/>getItemName(tEquip)+\textcolor{stringliteral}{"{}."{}});}
\DoxyCodeLine{03210\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ mUnitManager-\/>equipItem(mUnitManager-\/>getPlayer(),tEquip,tSlot);}
\DoxyCodeLine{03211\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03212\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03213\ \ \ \ \ \}}
\DoxyCodeLine{03214\ \ \ \ \ \textcolor{keywordtype}{void}\ processFindPlayer(Packet\ *p)}
\DoxyCodeLine{03215\ \ \ \ \ \{}
\DoxyCodeLine{03216\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream(p-\/>data,\ p-\/>length,\ \textcolor{keyword}{false});}
\DoxyCodeLine{03217\ \ \ \ \ \ \ \ \ MessageID\ tID;}
\DoxyCodeLine{03218\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ tName[16];}
\DoxyCodeLine{03219\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tOnline\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03220\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{03221\ \ \ \ \ \ \ \ \ tBitStream.Read(tID);}
\DoxyCodeLine{03222\ \ \ \ \ \ \ \ \ stringCompressor-\/>DecodeString(tName,16,\&tBitStream);}
\DoxyCodeLine{03223\ \ \ \ \ \ \ \ \ tBitStream.Read(tOnline);}
\DoxyCodeLine{03224\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tOnline)}
\DoxyCodeLine{03225\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03226\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{03227\ \ \ \ \ \ \ \ \ \ \ \ \ OwnerToken\ tToken;}
\DoxyCodeLine{03228\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{char}\ tMap[32];}
\DoxyCodeLine{03229\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ tDimension;}
\DoxyCodeLine{03230\ }
\DoxyCodeLine{03231\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tToken);}
\DoxyCodeLine{03232\ \ \ \ \ \ \ \ \ \ \ \ \ stringCompressor-\/>DecodeString(tMap,32,\&tBitStream);}
\DoxyCodeLine{03233\ \ \ \ \ \ \ \ \ \ \ \ \ tBitStream.Read(tDimension);}
\DoxyCodeLine{03234\ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{03235\ \ \ \ \ \ \ \ \ \ \ \ \ mChatManager-\/>message(String(tName)+\textcolor{stringliteral}{"{}["{}}+StringConverter::toString(tToken)+\textcolor{stringliteral}{"{}]\ is\ in\ "{}}+String(tMap)+\textcolor{stringliteral}{"{}\ dimension\ "{}}+StringConverter::toString(tDimension)+\textcolor{stringliteral}{"{}."{}});}
\DoxyCodeLine{03236\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03237\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ mChatManager-\/>message(String(tName)+\textcolor{stringliteral}{"{}\ is\ not\ online."{}});}
\DoxyCodeLine{03238\ \ \ \ \ \}}
\DoxyCodeLine{03239\ \ \ \ \ \textcolor{keywordtype}{void}\ sendFindPlayer(\textcolor{keyword}{const}\ String\ \&name)}
\DoxyCodeLine{03240\ \ \ \ \ \{}
\DoxyCodeLine{03241\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{03242\ }
\DoxyCodeLine{03243\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_FINDPLAYER));}
\DoxyCodeLine{03244\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{false});}
\DoxyCodeLine{03245\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(name.c\_str(),16,\&tBitStream);}
\DoxyCodeLine{03246\ }
\DoxyCodeLine{03247\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ LOW\_PRIORITY,\ UNRELIABLE,\ 0,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{03248\ \ \ \ \ \}}
\DoxyCodeLine{03249\ \ \ \ \ \textcolor{keywordtype}{void}\ sendFindToken(\textcolor{keyword}{const}\ OwnerToken\ \&token)}
\DoxyCodeLine{03250\ \ \ \ \ \{}
\DoxyCodeLine{03251\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{03252\ }
\DoxyCodeLine{03253\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_FINDPLAYER));}
\DoxyCodeLine{03254\ \ \ \ \ \ \ \ \ tBitStream.Write(\textcolor{keyword}{true});}
\DoxyCodeLine{03255\ \ \ \ \ \ \ \ \ tBitStream.Write(token);}
\DoxyCodeLine{03256\ }
\DoxyCodeLine{03257\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ LOW\_PRIORITY,\ UNRELIABLE,\ 0,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{03258\ \ \ \ \ \}}
\DoxyCodeLine{03259\ \ \ \ \ \textcolor{keywordtype}{void}\ processServerList(Packet\ *p)}
\DoxyCodeLine{03260\ \ \ \ \ \{}
\DoxyCodeLine{03261\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tReceiveBit(p-\/>data,\ p-\/>length,\ \textcolor{keyword}{false});}
\DoxyCodeLine{03262\ \ \ \ \ \ \ \ \ MessageID\ tMessage;}
\DoxyCodeLine{03263\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{03264\ \ \ \ \ \ \ \ \ tReceiveBit.Read(tMessage);}
\DoxyCodeLine{03265\ }
\DoxyCodeLine{03266\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tHasMore\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03267\ \ \ \ \ \ \ \ \ tReceiveBit.Read(tHasMore);}
\DoxyCodeLine{03268\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{while}(tHasMore)}
\DoxyCodeLine{03269\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03270\ \ \ \ \ \ \ \ \ \ \ \ \ tHasMore\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03271\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ tID;}
\DoxyCodeLine{03272\ \ \ \ \ \ \ \ \ \ \ \ \ SystemAddress\ tAdd;}
\DoxyCodeLine{03273\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tFull\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{03274\ }
\DoxyCodeLine{03275\ \ \ \ \ \ \ \ \ \ \ \ \ tReceiveBit.Read(tID);}
\DoxyCodeLine{03276\ \ \ \ \ \ \ \ \ \ \ \ \ tReceiveBit.Read(tAdd);}
\DoxyCodeLine{03277\ \ \ \ \ \ \ \ \ \ \ \ \ tReceiveBit.Read(tFull);}
\DoxyCodeLine{03278\ }
\DoxyCodeLine{03279\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(!tFull)serverAdd.push\_back(std::pair<unsigned\ char,SystemAddress>(tID,tAdd));}
\DoxyCodeLine{03280\ \ \ \ \ \ \ \ \ \ \ \ \ tReceiveBit.Read(tHasMore);}
\DoxyCodeLine{03281\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03282\ \ \ \ \ \}}
\DoxyCodeLine{03283\ \ \ \ \ \textcolor{keywordtype}{void}\ processServerConnected(Packet\ *p)}
\DoxyCodeLine{03284\ \ \ \ \ \{}
\DoxyCodeLine{03285\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tReceiveBit(p-\/>data,\ p-\/>length,\ \textcolor{keyword}{false});}
\DoxyCodeLine{03286\ \ \ \ \ \ \ \ \ MessageID\ tMessage;}
\DoxyCodeLine{03287\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ tIsConnect;}
\DoxyCodeLine{03288\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ tID;}
\DoxyCodeLine{03289\ \ \ \ \ \ \ \ \ SystemAddress\ tAdd;}
\DoxyCodeLine{03290\ \ \ \ \ \ \ \ \ tReceiveBit.Read(tMessage);}
\DoxyCodeLine{03291\ \ \ \ \ \ \ \ \ tReceiveBit.Read(tIsConnect);}
\DoxyCodeLine{03292\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tIsConnect)tReceiveBit.Read(tID);}
\DoxyCodeLine{03293\ \ \ \ \ \ \ \ \ tReceiveBit.Read(tAdd);}
\DoxyCodeLine{03294\ }
\DoxyCodeLine{03295\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tIsConnect)}
\DoxyCodeLine{03296\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03297\ \ \ \ \ \ \ \ \ \ \ \ \ serverAdd.push\_back(std::pair<unsigned\ char,SystemAddress>(tID,tAdd));}
\DoxyCodeLine{03298\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03299\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{03300\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03301\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(vector<std::pair<unsigned\ char,SystemAddress>>::type::iterator\ it=serverAdd.begin();it!=serverAdd.end();it++)}
\DoxyCodeLine{03302\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03303\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ std::pair<unsigned\ char,SystemAddress>\ tServer\ =\ *it;}
\DoxyCodeLine{03304\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(tServer.second==tAdd)}
\DoxyCodeLine{03305\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{03306\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ serverAdd.erase(it);}
\DoxyCodeLine{03307\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{03308\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03309\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03310\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{03311\ \ \ \ \ \}}
\DoxyCodeLine{03312\ \ \ \ \ \textcolor{keywordtype}{void}\ processMaintenance(Packet\ *p)}
\DoxyCodeLine{03313\ \ \ \ \ \{}
\DoxyCodeLine{03314\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tReceiveBit(p-\/>data,\ p-\/>length,\ \textcolor{keyword}{false});}
\DoxyCodeLine{03315\ \ \ \ \ \ \ \ \ MessageID\ tMessage;}
\DoxyCodeLine{03316\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{char}\ tCount;}
\DoxyCodeLine{03317\ \ \ \ \ \ \ \ \ tReceiveBit.Read(tMessage);}
\DoxyCodeLine{03318\ \ \ \ \ \ \ \ \ tReceiveBit.Read(tCount);}
\DoxyCodeLine{03319\ \ \ \ \ \ \ \ \ mChatManager-\/>message(\textcolor{stringliteral}{"{}Servers\ are\ restarting\ in\ "{}}+StringConverter::toString((\textcolor{keywordtype}{int})tCount)+\textcolor{stringliteral}{"{}\ seconds.\ Please\ log\ out\ to\ avoid\ data\ loss.\ Thank\ you\ C:"{}});}
\DoxyCodeLine{03320\ \ \ \ \ \}}
\DoxyCodeLine{03321\ \ \ \ \ \textcolor{keywordtype}{void}\ sendViolation(\textcolor{keyword}{const}\ String\ \&info)}
\DoxyCodeLine{03322\ \ \ \ \ \{}
\DoxyCodeLine{03323\ \ \ \ \ \ \ \ \ RakNet::BitStream\ tBitStream;}
\DoxyCodeLine{03324\ }
\DoxyCodeLine{03325\ \ \ \ \ \ \ \ \ tBitStream.Write(MessageID(ID\_VIOLATION));}
\DoxyCodeLine{03326\ \ \ \ \ \ \ \ \ stringCompressor-\/>EncodeString(info.c\_str(),32,\&tBitStream);}
\DoxyCodeLine{03327\ }
\DoxyCodeLine{03328\ \ \ \ \ \ \ \ \ mPeer-\/>Send(\&tBitStream,\ HIGH\_PRIORITY,\ RELIABLE,\ 0,\ UNASSIGNED\_SYSTEM\_ADDRESS,\ \textcolor{keyword}{true});}
\DoxyCodeLine{03329\ \ \ \ \ \}}
\DoxyCodeLine{03330\ }
\DoxyCodeLine{03331\ \};}
\DoxyCodeLine{03332\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
